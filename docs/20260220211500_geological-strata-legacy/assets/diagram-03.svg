<svg viewBox="0 0 900 500" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0">
  <rect width="900" height="500" fill="#0f0e17" rx="12"/>
  <text x="450" y="35" text-anchor="middle" fill="#fffffe" font-size="18" font-family="sans-serif" font-weight="bold">Strangler Fig Pattern：地質学的リファクタリング</text>

  <!-- Left: Before (Monolith) -->
  <text x="225" y="65" text-anchor="middle" fill="#ff6b6b" font-size="14" font-family="sans-serif" font-weight="bold">Before: レガシーモノリス</text>

  <!-- Monolith block -->
  <rect x="70" y="85" width="310" height="330" fill="#78350f" rx="8" style="filter: drop-shadow(3px 3px 6px rgba(0,0,0,0.4))"/>

  <!-- Internal layers of monolith -->
  <rect x="85" y="95" width="280" height="50" fill="#92400e" rx="4"/>
  <text x="225" y="118" text-anchor="middle" fill="#fde68a" font-size="11" font-family="sans-serif">UI Layer (2005 JSP/PHP)</text>
  <text x="225" y="135" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">密結合、テストなし</text>

  <rect x="85" y="155" width="280" height="50" fill="#92400e" rx="4"/>
  <text x="225" y="178" text-anchor="middle" fill="#fde68a" font-size="11" font-family="sans-serif">Business Logic (2008 Java EE)</text>
  <text x="225" y="195" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">God Class、循環依存</text>

  <rect x="85" y="215" width="280" height="50" fill="#92400e" rx="4"/>
  <text x="225" y="238" text-anchor="middle" fill="#fde68a" font-size="11" font-family="sans-serif">Data Access (2003 Raw JDBC)</text>
  <text x="225" y="255" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">SQL直書き、N+1問題</text>

  <rect x="85" y="275" width="280" height="50" fill="#92400e" rx="4"/>
  <text x="225" y="298" text-anchor="middle" fill="#fde68a" font-size="11" font-family="sans-serif">Shared DB (2001 Oracle)</text>
  <text x="225" y="315" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">500テーブル、ストアドプロシージャ</text>

  <rect x="85" y="335" width="280" height="70" fill="#451a03" rx="4"/>
  <text x="225" y="358" text-anchor="middle" fill="#d97706" font-size="11" font-family="sans-serif">Foundation (1999 Perl CGI)</text>
  <text x="225" y="375" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">認証・セッション管理の基盤</text>
  <text x="225" y="392" text-anchor="middle" fill="#ff6b6b" font-size="9" font-family="sans-serif" font-weight="bold">** 触ると崩壊 **</text>

  <!-- Divider -->
  <line x1="450" y1="60" x2="450" y2="430" stroke="#a7a9be" stroke-width="1" stroke-dasharray="8,4" opacity="0.4"/>

  <!-- Right: After (Strangler Fig) -->
  <text x="675" y="65" text-anchor="middle" fill="#52b788" font-size="14" font-family="sans-serif" font-weight="bold">After: Strangler Fig 段階移行</text>

  <!-- New services wrapping old -->
  <rect x="500" y="85" width="370" height="330" fill="#1a1a2e" rx="8" stroke="#52b788" stroke-width="2" stroke-dasharray="6,3"/>

  <!-- New modern layer -->
  <rect x="515" y="95" width="340" height="55" fill="#2563eb" rx="6" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="685" y="118" text-anchor="middle" fill="#fffffe" font-size="11" font-family="sans-serif" font-weight="bold">New: React SPA + API Gateway</text>
  <text x="685" y="138" text-anchor="middle" fill="#93c5fd" font-size="9" font-family="sans-serif">Anti-Corruption Layer でレガシーを隔離</text>

  <!-- Anti-corruption layer -->
  <rect x="515" y="158" width="340" height="25" fill="#e6b422" rx="4" opacity="0.8"/>
  <text x="685" y="176" text-anchor="middle" fill="#0f0e17" font-size="10" font-family="sans-serif" font-weight="bold">Anti-Corruption Layer (Adapter / Facade)</text>

  <!-- Partially migrated -->
  <rect x="515" y="191" width="165" height="50" fill="#7c3aed" rx="4" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="597" y="214" text-anchor="middle" fill="#fffffe" font-size="10" font-family="sans-serif">New Service A</text>
  <text x="597" y="230" text-anchor="middle" fill="#c4b5fd" font-size="9" font-family="sans-serif">移行済み</text>

  <rect x="690" y="191" width="165" height="50" fill="#7c3aed" rx="4" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="772" y="214" text-anchor="middle" fill="#fffffe" font-size="10" font-family="sans-serif">New Service B</text>
  <text x="772" y="230" text-anchor="middle" fill="#c4b5fd" font-size="9" font-family="sans-serif">移行済み</text>

  <!-- Still legacy portions (shrinking) -->
  <rect x="515" y="251" width="340" height="80" fill="#92400e" rx="4" opacity="0.6"/>
  <text x="685" y="280" text-anchor="middle" fill="#fde68a" font-size="11" font-family="sans-serif">Legacy Core (縮小中)</text>
  <text x="685" y="300" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">段階的に新サービスに置き換え</text>
  <text x="685" y="318" text-anchor="middle" fill="#ff6b6b" font-size="9" font-family="sans-serif">絞殺される側 (Strangled)</text>

  <!-- New DB -->
  <rect x="515" y="341" width="165" height="55" fill="#2d6a4f" rx="4" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="597" y="364" text-anchor="middle" fill="#fffffe" font-size="10" font-family="sans-serif">New DB</text>
  <text x="597" y="382" text-anchor="middle" fill="#52b788" font-size="9" font-family="sans-serif">PostgreSQL</text>

  <!-- Legacy DB (shrinking) -->
  <rect x="690" y="341" width="165" height="55" fill="#78350f" rx="4" opacity="0.5"/>
  <text x="772" y="364" text-anchor="middle" fill="#fde68a" font-size="10" font-family="sans-serif">Legacy DB</text>
  <text x="772" y="382" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">Oracle (廃止予定)</text>

  <!-- Bottom: Process steps -->
  <rect x="50" y="430" width="800" height="55" fill="#1a1a2e" rx="6"/>
  <text x="135" y="455" text-anchor="middle" fill="#2563eb" font-size="11" font-family="sans-serif" font-weight="bold">Step 1</text>
  <text x="135" y="472" text-anchor="middle" fill="#a7a9be" font-size="10" font-family="sans-serif">境界定義</text>
  <line x1="200" y1="458" x2="230" y2="458" stroke="#a7a9be" stroke-width="1.5"/>
  <polygon points="228,454 236,458 228,462" fill="#a7a9be"/>
  <text x="315" y="455" text-anchor="middle" fill="#e6b422" font-size="11" font-family="sans-serif" font-weight="bold">Step 2</text>
  <text x="315" y="472" text-anchor="middle" fill="#a7a9be" font-size="10" font-family="sans-serif">ACL導入</text>
  <line x1="380" y1="458" x2="410" y2="458" stroke="#a7a9be" stroke-width="1.5"/>
  <polygon points="408,454 416,458 408,462" fill="#a7a9be"/>
  <text x="495" y="455" text-anchor="middle" fill="#7c3aed" font-size="11" font-family="sans-serif" font-weight="bold">Step 3</text>
  <text x="495" y="472" text-anchor="middle" fill="#a7a9be" font-size="10" font-family="sans-serif">段階移行</text>
  <line x1="560" y1="458" x2="590" y2="458" stroke="#a7a9be" stroke-width="1.5"/>
  <polygon points="588,454 596,458 588,462" fill="#a7a9be"/>
  <text x="675" y="455" text-anchor="middle" fill="#52b788" font-size="11" font-family="sans-serif" font-weight="bold">Step 4</text>
  <text x="675" y="472" text-anchor="middle" fill="#a7a9be" font-size="10" font-family="sans-serif">レガシー廃止</text>
  <line x1="740" y1="458" x2="770" y2="458" stroke="#a7a9be" stroke-width="1.5"/>
  <polygon points="768,454 776,458 768,462" fill="#a7a9be"/>
  <text x="830" y="458" text-anchor="middle" fill="#fffffe" font-size="12" font-family="sans-serif" font-weight="bold">Done</text>
</svg>
