<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg" font-family="sans-serif" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0">
  <text x="400" y="24" text-anchor="middle" font-size="15" font-weight="bold" fill="#f8f8f8">Average Precision (AP)</text>
  <!-- Formula -->
  <rect x="20" y="36" width="760" height="46" rx="10" fill="rgba(251,146,60,0.1)" stroke="#fb923c" stroke-width="2"/>
  <text x="400" y="56" text-anchor="middle" font-size="12" font-weight="bold" fill="#fb923c">AP = (1/|R|) × Σₖ P@k × rel(k)</text>
  <text x="400" y="76" text-anchor="middle" font-size="11" fill="#f8f8f8">R = 関連アイテム総数 | rel(k) = k位が関連なら1, 非関連なら0 | P@k = k位までの精度</text>
  <!-- Ranking example -->
  <text x="36" y="106" font-size="11" font-weight="bold" fill="#fbbf24">ランキング結果（関連アイテム: R1, R3, R5 の3件）</text>
  <!-- Rank list with precision at relevant items -->
  <text x="50" y="130" font-size="10" fill="#94a3b8">順位</text>
  <text x="150" y="130" font-size="10" fill="#94a3b8">アイテム</text>
  <text x="280" y="130" font-size="10" fill="#94a3b8">関連?</text>
  <text x="400" y="130" font-size="10" fill="#60a5fa">P@k</text>
  <text x="520" y="130" font-size="10" fill="#34d399">P@k × rel(k)</text>
  <text x="680" y="130" font-size="10" fill="#f8f8f8">累積</text>
  <!-- Row 1 -->
  <rect x="20" y="136" width="760" height="26" rx="0" fill="rgba(52,211,153,0.12)"/>
  <rect x="20" y="136" width="4" height="26" rx="1" fill="#34d399"/>
  <text x="50" y="153" text-anchor="middle" font-size="11" fill="#f8f8f8">1</text>
  <text x="150" y="153" text-anchor="middle" font-size="11" fill="#34d399">R1 ✓</text>
  <text x="280" y="153" text-anchor="middle" font-size="11" fill="#34d399">関連</text>
  <text x="400" y="153" text-anchor="middle" font-size="11" fill="#60a5fa">1/1 = 1.000</text>
  <text x="520" y="153" text-anchor="middle" font-size="12" font-weight="bold" fill="#34d399">1.000</text>
  <text x="680" y="153" text-anchor="middle" font-size="11" fill="#34d399">+1.000</text>
  <!-- Row 2 -->
  <rect x="20" y="162" width="760" height="26" rx="0" fill="rgba(255,255,255,0.03)"/>
  <text x="50" y="179" text-anchor="middle" font-size="11" fill="#f8f8f8">2</text>
  <text x="150" y="179" text-anchor="middle" font-size="11" fill="#94a3b8">X2 ✗</text>
  <text x="280" y="179" text-anchor="middle" font-size="11" fill="#f472b6">非関連</text>
  <text x="400" y="179" text-anchor="middle" font-size="11" fill="#60a5fa">1/2 = 0.500</text>
  <text x="520" y="179" text-anchor="middle" font-size="11" fill="#94a3b8">0 (非関連)</text>
  <text x="680" y="179" text-anchor="middle" font-size="11" fill="#94a3b8">—</text>
  <!-- Row 3 -->
  <rect x="20" y="188" width="760" height="26" rx="0" fill="rgba(52,211,153,0.12)"/>
  <rect x="20" y="188" width="4" height="26" rx="1" fill="#34d399"/>
  <text x="50" y="205" text-anchor="middle" font-size="11" fill="#f8f8f8">3</text>
  <text x="150" y="205" text-anchor="middle" font-size="11" fill="#34d399">R3 ✓</text>
  <text x="280" y="205" text-anchor="middle" font-size="11" fill="#34d399">関連</text>
  <text x="400" y="205" text-anchor="middle" font-size="11" fill="#60a5fa">2/3 = 0.667</text>
  <text x="520" y="205" text-anchor="middle" font-size="12" font-weight="bold" fill="#34d399">0.667</text>
  <text x="680" y="205" text-anchor="middle" font-size="11" fill="#34d399">+0.667</text>
  <!-- Row 4 -->
  <rect x="20" y="214" width="760" height="26" rx="0" fill="rgba(255,255,255,0.03)"/>
  <text x="50" y="231" text-anchor="middle" font-size="11" fill="#f8f8f8">4</text>
  <text x="150" y="231" text-anchor="middle" font-size="11" fill="#94a3b8">X4 ✗</text>
  <text x="280" y="231" text-anchor="middle" font-size="11" fill="#f472b6">非関連</text>
  <text x="400" y="231" text-anchor="middle" font-size="11" fill="#60a5fa">2/4 = 0.500</text>
  <text x="520" y="231" text-anchor="middle" font-size="11" fill="#94a3b8">0 (非関連)</text>
  <text x="680" y="231" text-anchor="middle" font-size="11" fill="#94a3b8">—</text>
  <!-- Row 5 -->
  <rect x="20" y="240" width="760" height="26" rx="0" fill="rgba(52,211,153,0.12)"/>
  <rect x="20" y="240" width="4" height="26" rx="1" fill="#34d399"/>
  <text x="50" y="257" text-anchor="middle" font-size="11" fill="#f8f8f8">5</text>
  <text x="150" y="257" text-anchor="middle" font-size="11" fill="#34d399">R5 ✓</text>
  <text x="280" y="257" text-anchor="middle" font-size="11" fill="#34d399">関連</text>
  <text x="400" y="257" text-anchor="middle" font-size="11" fill="#60a5fa">3/5 = 0.600</text>
  <text x="520" y="257" text-anchor="middle" font-size="12" font-weight="bold" fill="#34d399">0.600</text>
  <text x="680" y="257" text-anchor="middle" font-size="11" fill="#34d399">+0.600</text>
  <!-- Final calculation -->
  <rect x="20" y="280" width="760" height="54" rx="10" fill="rgba(251,146,60,0.12)" stroke="#fb923c" stroke-width="1.5"/>
  <text x="400" y="302" text-anchor="middle" font-size="12" font-weight="bold" fill="#fb923c">AP = (1/3) × (1.000 + 0.667 + 0.600) = (1/3) × 2.267</text>
  <text x="400" y="324" text-anchor="middle" font-size="14" font-weight="bold" fill="#fb923c">AP = 0.756</text>
  <!-- Insight -->
  <rect x="20" y="348" width="760" height="44" rx="10" fill="rgba(255,255,255,0.04)" stroke="#475569" stroke-width="1.5"/>
  <text x="400" y="368" text-anchor="middle" font-size="11" font-weight="bold" fill="#f8f8f8">AP のポイント: 関連アイテムが上位に来るほどスコアが高い</text>
  <text x="400" y="386" text-anchor="middle" font-size="10" fill="#94a3b8">例: 同じ3件関連でも 1,2,3位に来れば AP = 1.0, 8,9,10位に来れば AP ≈ 0.12</text>
</svg>
