<svg viewBox="0 0 800 420" xmlns="http://www.w3.org/2000/svg" font-family="sans-serif" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0">
  <text x="400" y="22" text-anchor="middle" font-size="15" font-weight="bold" fill="#fb923c">ランキング・推薦指標 — まとめ</text>
  <!-- Left: formulas -->
  <rect x="20" y="34" width="370" height="316" rx="12" fill="rgba(251,146,60,0.08)" stroke="#fb923c" stroke-width="1.5"/>
  <text x="205" y="56" text-anchor="middle" font-size="13" font-weight="bold" fill="#fb923c">公式チートシート</text>
  <line x1="34" y1="64" x2="376" y2="64" stroke="#fb923c" stroke-width="1" opacity="0.4"/>
  <text x="36" y="84" font-size="11" fill="#60a5fa">P@K</text>
  <text x="120" y="84" font-size="11" fill="#f8f8f8">= |関連∩TopK| / K</text>
  <text x="36" y="106" font-size="11" fill="#60a5fa">R@K</text>
  <text x="120" y="106" font-size="11" fill="#f8f8f8">= |関連∩TopK| / |全関連|</text>
  <text x="36" y="128" font-size="11" fill="#fb923c">AP</text>
  <text x="120" y="128" font-size="11" fill="#f8f8f8">= (1/|R|) Σ P@k · rel(k)</text>
  <text x="36" y="150" font-size="11" fill="#fb923c">MAP</text>
  <text x="120" y="150" font-size="11" fill="#f8f8f8">= (1/|Q|) Σ AP(q)</text>
  <text x="36" y="172" font-size="11" fill="#34d399">DCG</text>
  <text x="120" y="172" font-size="11" fill="#f8f8f8">= Σ relᵢ / log₂(i+1)</text>
  <text x="36" y="194" font-size="11" fill="#34d399">NDCG</text>
  <text x="120" y="194" font-size="11" fill="#f8f8f8">= DCG / IDCG ∈ [0, 1]</text>
  <text x="36" y="216" font-size="11" fill="#a78bfa">MRR</text>
  <text x="120" y="216" font-size="11" fill="#f8f8f8">= (1/|Q|) Σ 1/rank_q</text>
  <text x="36" y="238" font-size="11" fill="#f472b6">Hit@K</text>
  <text x="120" y="238" font-size="11" fill="#f8f8f8">= Σ I(|関連∩TopK|≥1) / |Q|</text>
  <line x1="34" y1="250" x2="376" y2="250" stroke="#fb923c" stroke-width="1" opacity="0.4"/>
  <!-- Complexity comparison -->
  <text x="205" y="270" text-anchor="middle" font-size="12" font-weight="bold" fill="#f8f8f8">計算コスト比較</text>
  <text x="36" y="292" font-size="11" fill="#34d399">低コスト:</text>
  <text x="100" y="292" font-size="11" fill="#f8f8f8">P@K, R@K, Hit@K, MRR</text>
  <text x="36" y="312" font-size="11" fill="#fb923c">中コスト:</text>
  <text x="100" y="312" font-size="11" fill="#f8f8f8">AP, MAP</text>
  <text x="36" y="332" font-size="11" fill="#f472b6">高コスト:</text>
  <text x="100" y="332" font-size="11" fill="#f8f8f8">NDCG（IDCGの計算が必要）</text>
  <!-- Right: task guide -->
  <rect x="410" y="34" width="370" height="316" rx="12" fill="rgba(96,165,250,0.08)" stroke="#60a5fa" stroke-width="1.5"/>
  <text x="595" y="56" text-anchor="middle" font-size="13" font-weight="bold" fill="#60a5fa">タスク別 推奨指標</text>
  <line x1="424" y1="64" x2="766" y2="64" stroke="#60a5fa" stroke-width="1" opacity="0.4"/>
  <text x="430" y="86" font-size="11" fill="#fbbf24">▸ 情報検索 / Web検索</text>
  <text x="446" y="104" font-size="11" fill="#f8f8f8">MAP + NDCG@10</text>
  <text x="430" y="126" font-size="11" fill="#fbbf24">▸ 推薦システム</text>
  <text x="446" y="144" font-size="11" fill="#f8f8f8">NDCG@K + Hit@K + Coverage</text>
  <text x="430" y="166" font-size="11" fill="#fbbf24">▸ QA / 音声検索</text>
  <text x="446" y="184" font-size="11" fill="#f8f8f8">MRR + Accuracy@1</text>
  <text x="430" y="206" font-size="11" fill="#fbbf24">▸ 候補生成（2段推薦）</text>
  <text x="446" y="224" font-size="11" fill="#f8f8f8">Recall@K（K=100〜500）</text>
  <text x="430" y="246" font-size="11" fill="#fbbf24">▸ A/Bテスト</text>
  <text x="446" y="264" font-size="11" fill="#f8f8f8">NDCG（絶対値変化）+ CTR</text>
  <line x1="424" y1="278" x2="766" y2="278" stroke="#60a5fa" stroke-width="1" opacity="0.4"/>
  <text x="595" y="298" text-anchor="middle" font-size="11" font-weight="bold" fill="#f8f8f8">共通の注意点</text>
  <text x="430" y="316" font-size="10" fill="#94a3b8">オフライン指標はオンライン成果の近似</text>
  <text x="430" y="334" font-size="10" fill="#94a3b8">位置バイアスのデバイアスが必要なケースが多い</text>
  <!-- Bottom -->
  <rect x="20" y="362" width="760" height="48" rx="10" fill="rgba(255,255,255,0.05)"/>
  <text x="400" y="382" text-anchor="middle" font-size="11" font-weight="bold" fill="#34d399">実務推奨: NDCG@10（主）+ MRR or Hit@K（補助）+ A/Bテストで最終確認</text>
  <text x="400" y="400" text-anchor="middle" font-size="10" fill="#94a3b8">定性評価（人間によるランキング評価）との組み合わせで誤差ヘッジ</text>
</svg>
