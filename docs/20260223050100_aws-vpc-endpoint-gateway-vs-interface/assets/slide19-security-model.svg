<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0">
  <rect width="800" height="400" fill="#fafafa"/>
  <text x="400" y="26" font-family="Arial,sans-serif" font-size="14" fill="#7b5ea7" font-weight="bold" text-anchor="middle">セキュリティモデル比較</text>
  <!-- LEFT: Gateway Security -->
  <rect x="10" y="38" width="385" height="348" rx="8" fill="#f0f4ff" stroke="#7b5ea7" stroke-width="2"/>
  <rect x="10" y="38" width="385" height="32" rx="8" fill="#7b5ea7"/>
  <text x="202" y="59" font-family="Arial,sans-serif" font-size="12" fill="#fff" font-weight="bold" text-anchor="middle">Gateway Endpoint</text>
  <!-- Control layers -->
  <text x="25" y="86" font-family="Arial,sans-serif" font-size="11" fill="#555" font-weight="bold">アクセス制御レイヤー</text>
  <!-- Layer 1 -->
  <rect x="22" y="93" width="365" height="48" rx="4" fill="#fff" stroke="#7b5ea7" stroke-width="1"/>
  <rect x="22" y="93" width="8" height="48" rx="2" fill="#7b5ea7"/>
  <text x="40" y="112" font-family="Arial,sans-serif" font-size="10" fill="#7b5ea7" font-weight="bold">① ルートテーブル</text>
  <text x="40" y="130" font-family="Arial,sans-serif" font-size="9" fill="#555">サブネット単位で S3/DDB へのルートを制御。未エントリのサブネットは EP を通らない。</text>
  <!-- Layer 2 -->
  <rect x="22" y="149" width="365" height="48" rx="4" fill="#fff" stroke="#7b5ea7" stroke-width="1"/>
  <rect x="22" y="149" width="8" height="48" rx="2" fill="#7b5ea7"/>
  <text x="40" y="168" font-family="Arial,sans-serif" font-size="10" fill="#7b5ea7" font-weight="bold">② VPC Endpoint Policy</text>
  <text x="40" y="186" font-family="Arial,sans-serif" font-size="9" fill="#555">エンドポイントを通過するリクエストを制限。Principal / Action / Resource / Condition 指定可。</text>
  <!-- Layer 3 -->
  <rect x="22" y="205" width="365" height="48" rx="4" fill="#fff" stroke="#7b5ea7" stroke-width="1"/>
  <rect x="22" y="205" width="8" height="48" rx="2" fill="#7b5ea7"/>
  <text x="40" y="224" font-family="Arial,sans-serif" font-size="10" fill="#7b5ea7" font-weight="bold">③ S3 Bucket / DDB Table Policy</text>
  <text x="40" y="242" font-family="Arial,sans-serif" font-size="9" fill="#555">aws:sourceVpce 条件で EP 経由のみ許可。インターネット経由アクセスを完全遮断できる。</text>
  <!-- Layer 4 -->
  <rect x="22" y="261" width="365" height="40" rx="4" fill="#fff" stroke="#7b5ea7" stroke-width="1"/>
  <rect x="22" y="261" width="8" height="40" rx="2" fill="#7b5ea7"/>
  <text x="40" y="277" font-family="Arial,sans-serif" font-size="10" fill="#7b5ea7" font-weight="bold">④ IAM Policy (Principal の権限)</text>
  <text x="40" y="292" font-family="Arial,sans-serif" font-size="9" fill="#555">通常の IAM 制御。Role / User の s3:* / dynamodb:* 権限で最小権限原則を適用。</text>
  <!-- Limitation note -->
  <rect x="22" y="312" width="365" height="60" rx="4" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/>
  <text x="204" y="330" font-family="Arial,sans-serif" font-size="10" fill="#ef4444" text-anchor="middle" font-weight="bold">制限事項</text>
  <text x="30" y="348" font-family="Arial,sans-serif" font-size="9" fill="#555">・セキュリティグループ (SG) は適用不可</text>
  <text x="30" y="364" font-family="Arial,sans-serif" font-size="9" fill="#555">・オンプレからのアクセスに Bucket Policy が必要 (Endpoint Policy は効かない)</text>
  <!-- RIGHT: Interface Security -->
  <rect x="405" y="38" width="385" height="348" rx="8" fill="#f0fdf4" stroke="#10b981" stroke-width="2"/>
  <rect x="405" y="38" width="385" height="32" rx="8" fill="#10b981"/>
  <text x="597" y="59" font-family="Arial,sans-serif" font-size="12" fill="#fff" font-weight="bold" text-anchor="middle">Interface Endpoint</text>
  <!-- Control layers -->
  <text x="420" y="86" font-family="Arial,sans-serif" font-size="11" fill="#555" font-weight="bold">アクセス制御レイヤー</text>
  <!-- Layer 1 -->
  <rect x="417" y="93" width="365" height="40" rx="4" fill="#fff" stroke="#10b981" stroke-width="1"/>
  <rect x="417" y="93" width="8" height="40" rx="2" fill="#10b981"/>
  <text x="435" y="110" font-family="Arial,sans-serif" font-size="10" fill="#059669" font-weight="bold">① セキュリティグループ (ENI)</text>
  <text x="435" y="126" font-family="Arial,sans-serif" font-size="9" fill="#555">ENI へのインバウンドをポート・プロトコル・SG 参照で制御。レイヤー別の精細制御が可能。</text>
  <!-- Layer 2 -->
  <rect x="417" y="141" width="365" height="40" rx="4" fill="#fff" stroke="#10b981" stroke-width="1"/>
  <rect x="417" y="141" width="8" height="40" rx="2" fill="#10b981"/>
  <text x="435" y="158" font-family="Arial,sans-serif" font-size="10" fill="#059669" font-weight="bold">② VPC Endpoint Policy</text>
  <text x="435" y="174" font-family="Arial,sans-serif" font-size="9" fill="#555">Gateway EP と同様の JSON ポリシー。通過リクエストの Principal/Action/Resource を制限。</text>
  <!-- Layer 3 -->
  <rect x="417" y="189" width="365" height="40" rx="4" fill="#fff" stroke="#10b981" stroke-width="1"/>
  <rect x="417" y="189" width="8" height="40" rx="2" fill="#10b981"/>
  <text x="435" y="206" font-family="Arial,sans-serif" font-size="10" fill="#059669" font-weight="bold">③ サービス側 Resource Policy</text>
  <text x="435" y="222" font-family="Arial,sans-serif" font-size="9" fill="#555">aws:sourceVpce 条件で制御可能（サービスに Resource Policy がある場合）。</text>
  <!-- Layer 4 -->
  <rect x="417" y="237" width="365" height="40" rx="4" fill="#fff" stroke="#10b981" stroke-width="1"/>
  <rect x="417" y="237" width="8" height="40" rx="2" fill="#10b981"/>
  <text x="435" y="254" font-family="Arial,sans-serif" font-size="10" fill="#059669" font-weight="bold">④ IAM Policy</text>
  <text x="435" y="270" font-family="Arial,sans-serif" font-size="9" fill="#555">最小権限の IAM ロール/ポリシー。ec2:*, ssm:* 等を必要最小限に絞る。</text>
  <!-- Advantage note -->
  <rect x="417" y="285" width="365" height="88" rx="4" fill="#f0fdf4" stroke="#10b981" stroke-width="1"/>
  <text x="600" y="303" font-family="Arial,sans-serif" font-size="10" fill="#059669" text-anchor="middle" font-weight="bold">Gateway EP との差別化ポイント</text>
  <text x="425" y="323" font-family="Arial,sans-serif" font-size="9" fill="#555">・SG による送信元 IP / SG 参照フィルタ（細粒度）</text>
  <text x="425" y="341" font-family="Arial,sans-serif" font-size="9" fill="#555">・SG フローログで接続監査が容易</text>
  <text x="425" y="359" font-family="Arial,sans-serif" font-size="9" fill="#555">・アプリチームと NW チームで責任分離しやすい</text>
  <text x="425" y="365" font-family="Arial,sans-serif" font-size="9" fill="#888">　(SG=アプリ / EP Policy=NW / IAM=セキュリティ)</text>
</svg>
