<svg viewBox="0 0 900 380" style="max-height:70vh;max-width:100%;display:block;margin:0 auto;letter-spacing:0" font-family="Arial,sans-serif">
  <rect width="900" height="380" fill="#F8F9FA"/>
  <text x="450" y="28" text-anchor="middle" font-size="17" font-weight="bold" fill="#232F3E">再ランキング (Reranking) パイプライン</text>

  <!-- Step 1 -->
  <rect x="20" y="65" width="160" height="80" rx="10" fill="#232F3E"/>
  <text x="100" y="93" text-anchor="middle" font-size="12" font-weight="bold" fill="#FF9900">① クエリ</text>
  <text x="100" y="112" text-anchor="middle" font-size="11" fill="white">"S3のコスト</text>
  <text x="100" y="129" text-anchor="middle" font-size="11" fill="white">最適化方法は？"</text>

  <line x1="180" y1="105" x2="215" y2="105" stroke="#666" stroke-width="2"/>
  <polygon points="215,100 225,105 215,110" fill="#666"/>

  <!-- Step 2 -->
  <rect x="225" y="55" width="160" height="160" rx="10" fill="#1A73E8"/>
  <text x="305" y="83" text-anchor="middle" font-size="12" font-weight="bold" fill="white">② 初期検索</text>
  <text x="305" y="100" text-anchor="middle" font-size="11" fill="#BBDEFB">Top-K取得 (K=20)</text>
  <rect x="243" y="112" width="124" height="22" rx="4" fill="#1557B0"/>
  <text x="305" y="128" text-anchor="middle" font-size="10" fill="white">Doc A (score: 0.92)</text>
  <rect x="243" y="138" width="124" height="22" rx="4" fill="#1557B0"/>
  <text x="305" y="154" text-anchor="middle" font-size="10" fill="white">Doc B (score: 0.88)</text>
  <rect x="243" y="164" width="124" height="22" rx="4" fill="#1557B0"/>
  <text x="305" y="180" text-anchor="middle" font-size="10" fill="white">Doc C (score: 0.85)</text>
  <text x="305" y="205" text-anchor="middle" font-size="11" fill="#BBDEFB">...Top-20まで</text>

  <line x1="385" y1="135" x2="420" y2="135" stroke="#666" stroke-width="2"/>
  <polygon points="420,130 430,135 420,140" fill="#666"/>

  <!-- Step 3: Reranker -->
  <rect x="430" y="55" width="200" height="175" rx="10" fill="#7B1FA2" style="filter:drop-shadow(3px 3px 6px rgba(0,0,0,0.2))"/>
  <text x="530" y="83" text-anchor="middle" font-size="13" font-weight="bold" fill="white">③ Reranker Model</text>
  <text x="530" y="101" text-anchor="middle" font-size="11" fill="#E1BEE7">クロスエンコーダー</text>
  <text x="530" y="118" text-anchor="middle" font-size="11" fill="#E1BEE7">クエリ×文書ペアを評価</text>

  <rect x="448" y="130" width="164" height="26" rx="6" fill="#6A1B9A"/>
  <text x="530" y="148" text-anchor="middle" font-size="11" fill="white">Cohere Rerank</text>

  <rect x="448" y="162" width="164" height="26" rx="6" fill="#6A1B9A"/>
  <text x="530" y="180" text-anchor="middle" font-size="11" fill="white">Amazon Rerank 1.0</text>

  <rect x="448" y="194" width="164" height="28" rx="6" fill="#4A148C"/>
  <text x="530" y="214" text-anchor="middle" font-size="11" fill="#E1BEE7">深い意味的マッチング</text>

  <line x1="630" y1="135" x2="665" y2="135" stroke="#666" stroke-width="2"/>
  <polygon points="665,130 675,135 665,140" fill="#666"/>

  <!-- Step 4: Reranked Results -->
  <rect x="675" y="55" width="200" height="175" rx="10" fill="#1A9C3E"/>
  <text x="775" y="83" text-anchor="middle" font-size="12" font-weight="bold" fill="white">④ 再ランキング結果</text>
  <text x="775" y="100" text-anchor="middle" font-size="11" fill="#C8E6C9">Top-5を最終利用</text>

  <rect x="693" y="112" width="164" height="22" rx="4" fill="#137830"/>
  <text x="775" y="128" text-anchor="middle" font-size="10" fill="white">Doc C (relevance: 0.97) ↑</text>
  <rect x="693" y="138" width="164" height="22" rx="4" fill="#137830"/>
  <text x="775" y="154" text-anchor="middle" font-size="10" fill="white">Doc A (relevance: 0.94)</text>
  <rect x="693" y="164" width="164" height="22" rx="4" fill="#137830"/>
  <text x="775" y="180" text-anchor="middle" font-size="10" fill="white">Doc F (relevance: 0.91) ↑</text>
  <rect x="693" y="190" width="164" height="22" rx="4" fill="#137830"/>
  <text x="775" y="206" text-anchor="middle" font-size="10" fill="white">Doc B (relevance: 0.89) ↓</text>
  <text x="775" y="224" text-anchor="middle" font-size="10" fill="#C8E6C9">順位が大幅に変化</text>

  <!-- Benefits box -->
  <rect x="20" y="265" width="860" height="100" rx="10" fill="#232F3E"/>
  <text x="450" y="288" text-anchor="middle" font-size="13" font-weight="bold" fill="#FF9900">Rerankingのポイント</text>
  <text x="80" y="310" font-size="12" fill="#E0E0E0">✓ 検索精度 (Precision) が大幅向上</text>
  <text x="80" y="328" font-size="12" fill="#E0E0E0">✓ 初期検索のTop-Kを広く取り、Rerankerで絞る</text>
  <text x="80" y="346" font-size="12" fill="#E0E0E0">✓ Knowledge Basesに組み込み可能</text>
  <text x="480" y="310" font-size="12" fill="#E0E0E0">✗ レイテンシが増加（ペア評価のコスト）</text>
  <text x="480" y="328" font-size="12" fill="#E0E0E0">試験: Rerankingは「精度向上」「レイテンシ増加」のトレードオフ</text>
</svg>
