<svg viewBox="0 0 860 380" xmlns="http://www.w3.org/2000/svg" style="max-height:65vh;width:auto;display:block;margin:0 auto;letter-spacing:0;font-family:sans-serif">
  <rect width="860" height="380" fill="#e8eaf6" rx="10"/>
  <text x="430" y="26" text-anchor="middle" font-size="13" font-weight="bold" fill="#333">TGW ECMP — 複数 DX/VPN での帯域集約</text>

  <!-- On-premises -->
  <rect x="20" y="150" width="110" height="80" fill="#ECEFF1" stroke="#607D8B" stroke-width="2" rx="6"/>
  <text x="75" y="178" text-anchor="middle" font-size="11" font-weight="bold" fill="#37474F">オンプレ</text>
  <text x="75" y="194" text-anchor="middle" font-size="10" fill="#546E7A">BGP Router</text>
  <text x="75" y="208" text-anchor="middle" font-size="9" fill="#78909C">192.168.0.0/16</text>
  <text x="75" y="222" text-anchor="middle" font-size="9" fill="#78909C">BGP ASN: 65000</text>

  <!-- 4 connections -->
  <!-- DX1 -->
  <line x1="130" y1="165" x2="290" y2="130" stroke="#00796B" stroke-width="2.5"/>
  <polygon points="290,125 300,130 290,135" fill="#00796B"/>
  <!-- DX2 -->
  <line x1="130" y1="175" x2="290" y2="175" stroke="#00796B" stroke-width="2.5"/>
  <polygon points="290,170 300,175 290,180" fill="#00796B"/>
  <!-- DX3 -->
  <line x1="130" y1="195" x2="290" y2="215" stroke="#00796B" stroke-width="2.5"/>
  <polygon points="290,210 300,215 290,220" fill="#00796B"/>
  <!-- VPN1 -->
  <line x1="130" y1="215" x2="290" y2="265" stroke="#7B1FA2" stroke-width="2" stroke-dasharray="5,3"/>
  <polygon points="290,260 300,265 290,270" fill="#7B1FA2"/>

  <!-- Connections column -->
  <rect x="300" y="110" width="130" height="40" fill="#E0F2F1" stroke="#00796B" stroke-width="1.5" rx="4"/>
  <text x="365" y="126" text-anchor="middle" font-size="9" font-weight="bold" fill="#004D40">DX-1 Transit VIF</text>
  <text x="365" y="140" text-anchor="middle" font-size="8" fill="#26A69A">10 Gbps / VLAN 201</text>
  <rect x="300" y="158" width="130" height="40" fill="#E0F2F1" stroke="#00796B" stroke-width="1.5" rx="4"/>
  <text x="365" y="174" text-anchor="middle" font-size="9" font-weight="bold" fill="#004D40">DX-2 Transit VIF</text>
  <text x="365" y="188" text-anchor="middle" font-size="8" fill="#26A69A">10 Gbps / VLAN 202</text>
  <rect x="300" y="206" width="130" height="40" fill="#E0F2F1" stroke="#00796B" stroke-width="1.5" rx="4"/>
  <text x="365" y="222" text-anchor="middle" font-size="9" font-weight="bold" fill="#004D40">DX-3 Transit VIF</text>
  <text x="365" y="236" text-anchor="middle" font-size="8" fill="#26A69A">10 Gbps / VLAN 203</text>
  <rect x="300" y="254" width="130" height="40" fill="#F3E5F5" stroke="#7B1FA2" stroke-width="1.5" rx="4"/>
  <text x="365" y="270" text-anchor="middle" font-size="9" font-weight="bold" fill="#4A148C">VPN Tunnel</text>
  <text x="365" y="284" text-anchor="middle" font-size="8" fill="#6A1B9A">1.25 Gbps（参考値）</text>

  <!-- Arrow to DXGW -->
  <line x1="430" y1="130" x2="490" y2="175" stroke="#00796B" stroke-width="1.5"/>
  <line x1="430" y1="178" x2="490" y2="195" stroke="#00796B" stroke-width="1.5"/>
  <line x1="430" y1="226" x2="490" y2="215" stroke="#00796B" stroke-width="1.5"/>
  <line x1="430" y1="274" x2="550" y2="260" stroke="#7B1FA2" stroke-width="1.5" stroke-dasharray="5,3"/>

  <!-- DXGW -->
  <rect x="490" y="155" width="100" height="70" fill="#E0F2F1" stroke="#00796B" stroke-width="2" rx="6"/>
  <text x="540" y="176" text-anchor="middle" font-size="10" font-weight="bold" fill="#004D40">DXGW</text>
  <text x="540" y="192" text-anchor="middle" font-size="9" fill="#26A69A">3x Transit VIF</text>
  <text x="540" y="207" text-anchor="middle" font-size="9" fill="#26A69A">を終端</text>

  <!-- Arrow DXGW to TGW -->
  <line x1="590" y1="190" x2="635" y2="190" stroke="#00796B" stroke-width="2"/>
  <polygon points="635,185 645,190 635,195" fill="#00796B"/>

  <!-- TGW -->
  <rect x="645" y="145" width="160" height="150" fill="#E3F2FD" stroke="#1976D2" stroke-width="2.5" rx="8"/>
  <text x="725" y="170" text-anchor="middle" font-size="12" font-weight="bold" fill="#0D47A1">Transit</text>
  <text x="725" y="187" text-anchor="middle" font-size="12" font-weight="bold" fill="#0D47A1">Gateway</text>
  <rect x="658" y="200" width="134" height="28" fill="#BBDEFB" rx="3"/>
  <text x="725" y="214" text-anchor="middle" font-size="9" font-weight="bold" fill="#0D47A1">ECMP 有効</text>
  <text x="725" y="226" text-anchor="middle" font-size="8" fill="#1565C0">Equal-cost routing</text>
  <!-- ECMP stats -->
  <text x="725" y="252" text-anchor="middle" font-size="9" fill="#1565C0">DX 合計: 30 Gbps</text>
  <text x="725" y="267" text-anchor="middle" font-size="9" fill="#1565C0">各フロー: ハッシュ振分け</text>
  <text x="725" y="282" text-anchor="middle" font-size="8" fill="#888">src/dst IP/Port で決定</text>

  <!-- VPN to TGW direct -->
  <line x1="550" y1="260" x2="643" y2="255" stroke="#7B1FA2" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="643,250 653,255 643,260" fill="#7B1FA2"/>

  <!-- Stats box -->
  <rect x="20" y="310" width="820" height="58" fill="#fff" stroke="#ddd" stroke-width="1" rx="6"/>
  <text x="430" y="329" text-anchor="middle" font-size="10" font-weight="bold" fill="#333">ECMP の仕組みと制約</text>
  <text x="430" y="345" text-anchor="middle" font-size="9" fill="#555">同一プレフィックスを複数の Equal-cost 経路で広告 → TGW が 5-tuple ハッシュ（Src IP/Port, Dst IP/Port, Protocol）で振り分け</text>
  <text x="430" y="359" text-anchor="middle" font-size="9" fill="#E65100">注意: BGP で同じプレフィックスを広告、AS-Path / Local Pref / MED がすべて同値の場合にのみ ECMP が機能</text>
</svg>
