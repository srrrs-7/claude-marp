<svg viewBox="0 0 860 380" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0;font-family:sans-serif">
  <rect width="860" height="380" fill="#f8f9fa" rx="10"/>
  <text x="430" y="26" text-anchor="middle" font-size="13" font-weight="bold" fill="#333">BGP セッション確立フロー と 設定パラメータ</text>

  <!-- State machine flow -->
  <!-- Idle -->
  <rect x="30" y="50" width="100" height="44" fill="#ECEFF1" stroke="#78909C" stroke-width="2" rx="6"/>
  <text x="80" y="72" text-anchor="middle" font-size="12" font-weight="bold" fill="#455A64">Idle</text>
  <text x="80" y="86" text-anchor="middle" font-size="9" fill="#607D8B">初期状態</text>
  <line x1="130" y1="72" x2="155" y2="72" stroke="#555" stroke-width="1.5"/>
  <polygon points="155,67 165,72 155,77" fill="#555"/>

  <!-- Connect -->
  <rect x="165" y="50" width="100" height="44" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="6"/>
  <text x="215" y="72" text-anchor="middle" font-size="12" font-weight="bold" fill="#0D47A1">Connect</text>
  <text x="215" y="86" text-anchor="middle" font-size="9" fill="#1565C0">TCP 179 接続試行</text>
  <line x1="265" y1="72" x2="290" y2="72" stroke="#555" stroke-width="1.5"/>
  <polygon points="290,67 300,72 290,77" fill="#555"/>

  <!-- OpenSent -->
  <rect x="300" y="50" width="100" height="44" fill="#E8F5E9" stroke="#388E3C" stroke-width="2" rx="6"/>
  <text x="350" y="69" text-anchor="middle" font-size="11" font-weight="bold" fill="#1B5E20">OpenSent</text>
  <text x="350" y="83" text-anchor="middle" font-size="9" fill="#2E7D32">OPEN メッセージ送信</text>
  <text x="350" y="93" text-anchor="middle" font-size="8" fill="#888">ASN / Hold Time</text>
  <line x1="400" y1="72" x2="425" y2="72" stroke="#555" stroke-width="1.5"/>
  <polygon points="425,67 435,72 425,77" fill="#555"/>

  <!-- OpenConfirm -->
  <rect x="435" y="50" width="110" height="44" fill="#FFF3E0" stroke="#F57C00" stroke-width="2" rx="6"/>
  <text x="490" y="69" text-anchor="middle" font-size="11" font-weight="bold" fill="#E65100">OpenConfirm</text>
  <text x="490" y="83" text-anchor="middle" font-size="9" fill="#BF360C">KEEPALIVE 待ち</text>
  <text x="490" y="93" text-anchor="middle" font-size="8" fill="#888">Capability 確認</text>
  <line x1="545" y1="72" x2="570" y2="72" stroke="#555" stroke-width="1.5"/>
  <polygon points="570,67 580,72 570,77" fill="#555"/>

  <!-- Established -->
  <rect x="580" y="45" width="110" height="54" fill="#E8F5E9" stroke="#2E7D32" stroke-width="2.5" rx="6"/>
  <text x="635" y="65" text-anchor="middle" font-size="12" font-weight="bold" fill="#1B5E20">Established</text>
  <text x="635" y="80" text-anchor="middle" font-size="10" fill="#2E7D32">BGP セッション確立</text>
  <text x="635" y="93" text-anchor="middle" font-size="9" fill="#388E3C">経路広告開始</text>

  <!-- BGP Parameters section -->
  <rect x="30" y="120" width="400" height="240" fill="#fff" stroke="#ddd" stroke-width="1" rx="6"/>
  <text x="230" y="142" text-anchor="middle" font-size="12" font-weight="bold" fill="#333">BGP 設定パラメータ（AWS DX）</text>

  <text x="40" y="162" font-size="11" font-weight="bold" fill="#1565C0">必須パラメータ:</text>
  <text x="40" y="178" font-size="10" fill="#333">• ASN（Autonomous System Number）</text>
  <text x="60" y="192" font-size="9" fill="#555">- オンプレ: Public ASN（1〜64511）or Private ASN（64512〜65535）</text>
  <text x="60" y="206" font-size="9" fill="#555">- AWS 側: 7224（固定）or カスタム ASN</text>
  <text x="40" y="222" font-size="10" fill="#333">• VLAN ID（802.1Q タグ）</text>
  <text x="60" y="236" font-size="9" fill="#555">- Private VIF: 1〜4094（AWS 指定）</text>
  <text x="40" y="252" font-size="10" fill="#333">• BGP Peer IP アドレス</text>
  <text x="60" y="266" font-size="9" fill="#555">- /30 サブネットのカスタマー側・AWS 側 IP</text>
  <text x="40" y="282" font-size="10" fill="#333">• MD5 認証キー（オプション推奨）</text>

  <text x="40" y="302" font-size="11" font-weight="bold" fill="#E65100">タイマー設定:</text>
  <text x="40" y="316" font-size="10" fill="#333">• Hold Timer: 90秒（デフォルト）</text>
  <text x="40" y="330" font-size="10" fill="#333">• Keepalive: 30秒（Hold Timer の 1/3）</text>
  <text x="40" y="344" font-size="10" fill="#333">• BFD 検出: 300ms 以内（別途設定）</text>
  <text x="40" y="356" font-size="9" fill="#888">※ AWS DX: IPv4 と IPv6 デュアルスタック BGP 対応</text>

  <!-- BGP Message types -->
  <rect x="450" y="120" width="380" height="240" fill="#fff" stroke="#ddd" stroke-width="1" rx="6"/>
  <text x="640" y="142" text-anchor="middle" font-size="12" font-weight="bold" fill="#333">BGP メッセージタイプ</text>

  <rect x="460" y="153" width="360" height="36" fill="#E3F2FD" stroke="#90CAF9" stroke-width="1" rx="4"/>
  <text x="640" y="168" text-anchor="middle" font-size="10" font-weight="bold" fill="#1565C0">OPEN</text>
  <text x="640" y="182" text-anchor="middle" font-size="9" fill="#1565C0">BGP バージョン / ASN / Hold Time / Router ID / Capabilities</text>

  <rect x="460" y="198" width="360" height="36" fill="#E8F5E9" stroke="#A5D6A7" stroke-width="1" rx="4"/>
  <text x="640" y="213" text-anchor="middle" font-size="10" font-weight="bold" fill="#2E7D32">UPDATE</text>
  <text x="640" y="227" text-anchor="middle" font-size="9" fill="#2E7D32">経路情報（NLRI / 撤回）/ パスアトリビュート</text>

  <rect x="460" y="243" width="360" height="36" fill="#FFF3E0" stroke="#FFCC02" stroke-width="1" rx="4"/>
  <text x="640" y="258" text-anchor="middle" font-size="10" font-weight="bold" fill="#E65100">KEEPALIVE</text>
  <text x="640" y="272" text-anchor="middle" font-size="9" fill="#E65100">セッション維持（Hold Timer リセット）/ 19バイト</text>

  <rect x="460" y="288" width="360" height="36" fill="#FFEBEE" stroke="#EF9A9A" stroke-width="1" rx="4"/>
  <text x="640" y="303" text-anchor="middle" font-size="10" font-weight="bold" fill="#C62828">NOTIFICATION</text>
  <text x="640" y="317" text-anchor="middle" font-size="9" fill="#C62828">エラー通知（セッション切断）/ Error Code + Subcode</text>

  <rect x="460" y="333" width="360" height="36" fill="#F3E5F5" stroke="#CE93D8" stroke-width="1" rx="4"/>
  <text x="640" y="348" text-anchor="middle" font-size="10" font-weight="bold" fill="#6A1B9A">ROUTE-REFRESH</text>
  <text x="640" y="362" text-anchor="middle" font-size="9" fill="#6A1B9A">経路テーブルの再送要求（RFC 2918）</text>
</svg>
