<svg viewBox="0 0 800 500" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0" xmlns="http://www.w3.org/2000/svg">
  <rect width="800" height="500" fill="#0d1b2a"/>
  <text x="400" y="28" fill="#4CC9F0" font-size="19" font-weight="bold" text-anchor="middle" font-family="sans-serif">SageMaker Automatic Model Tuning (AMT)</text>

  <!-- Left: Tuning Job Config -->
  <rect x="15" y="50" width="220" height="300" rx="10" fill="#1e3a5f" style="filter:drop-shadow(2px 2px 6px rgba(0,0,0,0.5))"/>
  <text x="125" y="74" fill="#4CC9F0" font-size="13" font-weight="bold" text-anchor="middle" font-family="sans-serif">Tuning Job 設定</text>

  <rect x="25" y="85" width="200" height="45" rx="6" fill="#0a2545"/>
  <text x="125" y="103" fill="#06D6A0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">目的変数</text>
  <text x="125" y="120" fill="#ffffff" font-size="11" text-anchor="middle" font-family="monospace">validation:accuracy ↑</text>

  <rect x="25" y="138" width="200" height="60" rx="6" fill="#0a2545"/>
  <text x="125" y="156" fill="#06D6A0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">パラメータ範囲</text>
  <text x="30" y="174" fill="#aaaaaa" font-size="10" font-family="monospace">lr: [1e-5, 1e-1] (log)</text>
  <text x="30" y="190" fill="#aaaaaa" font-size="10" font-family="monospace">batch: [16, 128]</text>

  <rect x="25" y="207" width="200" height="45" rx="6" fill="#0a2545"/>
  <text x="125" y="225" fill="#06D6A0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">ジョブ予算</text>
  <text x="125" y="243" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">最大ジョブ数: 20</text>

  <rect x="25" y="261" width="200" height="45" rx="6" fill="#0a2545"/>
  <text x="125" y="279" fill="#06D6A0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">並列度</text>
  <text x="125" y="297" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">並列実行: 3 ジョブ</text>

  <text x="125" y="328" fill="#4CC9F0" font-size="10" text-anchor="middle" font-family="sans-serif">Warm Start: 前回結果を</text>
  <text x="125" y="342" fill="#4CC9F0" font-size="10" text-anchor="middle" font-family="sans-serif">次回チューニングで再利用</text>

  <!-- Arrow to HPO loop -->
  <line x1="235" y1="200" x2="270" y2="200" stroke="#4CC9F0" stroke-width="2"/>
  <polygon points="0,-6 -5,5 5,5" fill="#4CC9F0" transform="translate(270,200) rotate(90)"/>

  <!-- Center: HPO Controller Loop -->
  <rect x="270" y="50" width="285" height="310" rx="10" fill="#0f3460" style="filter:drop-shadow(2px 2px 6px rgba(0,0,0,0.5))"/>
  <text x="412" y="74" fill="#F77F00" font-size="13" font-weight="bold" text-anchor="middle" font-family="sans-serif">HPO コントローラー</text>

  <!-- Loop steps -->
  <rect x="285" y="88" width="255" height="48" rx="8" fill="#1a2a4a"/>
  <text x="412" y="108" fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">1. ベイズ探索でパラメータ選択</text>
  <text x="412" y="126" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">代理モデル (Gaussian Process) で予測</text>

  <!-- Downward arrow 1 -->
  <line x1="412" y1="136" x2="412" y2="155" stroke="#F77F00" stroke-width="2"/>
  <polygon points="0,-5 -4,4 4,4" fill="#F77F00" transform="translate(412,155) rotate(180)"/>

  <rect x="285" y="155" width="255" height="48" rx="8" fill="#1a2a4a"/>
  <text x="412" y="175" fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">2. 学習ジョブ実行</text>
  <text x="412" y="193" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">SageMaker Training Job → S3 アーティファクト</text>

  <!-- Downward arrow 2 -->
  <line x1="412" y1="203" x2="412" y2="222" stroke="#F77F00" stroke-width="2"/>
  <polygon points="0,-5 -4,4 4,4" fill="#F77F00" transform="translate(412,222) rotate(180)"/>

  <rect x="285" y="222" width="255" height="48" rx="8" fill="#1a2a4a"/>
  <text x="412" y="242" fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">3. メトリクス評価</text>
  <text x="412" y="260" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">validation:accuracy を CloudWatch から取得</text>

  <!-- Downward arrow 3 -->
  <line x1="412" y1="270" x2="412" y2="289" stroke="#F77F00" stroke-width="2"/>
  <polygon points="0,-5 -4,4 4,4" fill="#F77F00" transform="translate(412,289) rotate(180)"/>

  <rect x="285" y="289" width="255" height="48" rx="8" fill="#1a2a4a"/>
  <text x="412" y="309" fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">4. 次のパラメータを提案</text>
  <text x="412" y="327" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">代理モデルを更新し次の候補を計算</text>

  <!-- Loop arrow (back to top) -->
  <path d="M 540 313 Q 560 200 540 103" fill="none" stroke="#F77F00" stroke-width="2" stroke-dasharray="6,4"/>
  <polygon points="0,-5 -4,4 4,4" fill="#F77F00" transform="translate(540,103) rotate(0)"/>
  <text x="555" y="210" fill="#F77F00" font-size="11" font-family="sans-serif">繰り返し</text>

  <!-- Arrow to right output -->
  <line x1="555" y1="200" x2="590" y2="200" stroke="#06D6A0" stroke-width="2"/>
  <polygon points="0,-6 -5,5 5,5" fill="#06D6A0" transform="translate(590,200) rotate(90)"/>

  <!-- Right: 最良ジョブ → Registry -->
  <rect x="590" y="50" width="195" height="310" rx="10" fill="#0a2545" style="filter:drop-shadow(2px 2px 6px rgba(0,0,0,0.5))"/>
  <text x="687" y="74" fill="#06D6A0" font-size="13" font-weight="bold" text-anchor="middle" font-family="sans-serif">最良ジョブ</text>

  <rect x="605" y="85" width="165" height="100" rx="6" fill="#0f3460"/>
  <text x="687" y="108" fill="#06D6A0" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">Job-018 (Best)</text>
  <text x="612" y="128" fill="#4CC9F0" font-size="11" font-family="monospace">accuracy: 0.9423</text>
  <text x="612" y="146" fill="#aaaaaa" font-size="11" font-family="monospace">lr: 0.00082</text>
  <text x="612" y="162" fill="#aaaaaa" font-size="11" font-family="monospace">batch: 64</text>
  <text x="612" y="178" fill="#aaaaaa" font-size="11" font-family="monospace">layers: 4</text>

  <!-- Arrow to Registry -->
  <line x1="687" y1="185" x2="687" y2="215" stroke="#06D6A0" stroke-width="2"/>
  <polygon points="0,-6 -5,5 5,5" fill="#06D6A0" transform="translate(687,215) rotate(180)"/>

  <rect x="605" y="215" width="165" height="65" rx="6" fill="#0a2a1a"/>
  <text x="687" y="240" fill="#06D6A0" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">Model Registry</text>
  <text x="687" y="260" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">自動登録</text>
  <text x="687" y="276" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">承認待ち状態で保存</text>

  <text x="687" y="310" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">全20ジョブの結果を</text>
  <text x="687" y="326" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">Experiments で比較</text>
  <text x="687" y="344" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">可視化・共有可能</text>

  <!-- Bottom: Early Stopping + Cost savings -->
  <rect x="15" y="375" width="770" height="110" rx="10" fill="#1a1a2e"/>
  <text x="400" y="398" fill="#4CC9F0" font-size="13" font-weight="bold" text-anchor="middle" font-family="sans-serif">コスト最適化戦略</text>

  <rect x="25" y="410" width="360" height="65" rx="8" fill="#1e3a5f"/>
  <text x="205" y="432" fill="#06D6A0" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">Early Stopping</text>
  <text x="205" y="452" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">改善見込みのないトライアルを早期終了</text>
  <text x="205" y="468" fill="#4CC9F0" font-size="11" text-anchor="middle" font-family="sans-serif">トレーニングコストを大幅削減</text>

  <rect x="400" y="410" width="375" height="65" rx="8" fill="#1e3a5f"/>
  <text x="587" y="432" fill="#F77F00" font-size="12" font-weight="bold" text-anchor="middle" font-family="sans-serif">Spot Training + HPO</text>
  <text x="587" y="452" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">Managed Spot Training と組み合わせで</text>
  <text x="587" y="468" fill="#F77F00" font-size="11" text-anchor="middle" font-family="sans-serif">最大 70% コスト削減 (チェックポイント必須)</text>
</svg>
