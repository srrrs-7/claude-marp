<svg viewBox="0 0 800 500" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0" xmlns="http://www.w3.org/2000/svg">
  <rect width="800" height="500" fill="#0d1b2a"/>
  <text x="400" y="28" fill="#4CC9F0" font-size="19" font-weight="bold" text-anchor="middle" font-family="sans-serif">分散学習アーキテクチャ</text>

  <!-- LEFT: Parameter Server Architecture -->
  <rect x="15" y="45" width="365" height="280" rx="10" fill="#1e3a5f" style="filter:drop-shadow(2px 2px 6px rgba(0,0,0,0.5))"/>
  <text x="197" y="68" fill="#4CC9F0" font-size="14" font-weight="bold" text-anchor="middle" font-family="sans-serif">Parameter Server アーキテクチャ</text>

  <!-- PS node at top -->
  <rect x="130" y="82" width="135" height="40" rx="6" fill="#E63946" style="opacity:0.85"/>
  <text x="197" y="106" fill="#ffffff" font-size="13" font-weight="bold" text-anchor="middle" font-family="sans-serif">Parameter Server (PS)</text>

  <!-- Worker nodes -->
  <rect x="30" y="165" width="85" height="40" rx="6" fill="#0f3460"/>
  <text x="72" y="189" fill="#4CC9F0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">Worker 1</text>
  <rect x="130" y="165" width="85" height="40" rx="6" fill="#0f3460"/>
  <text x="172" y="189" fill="#4CC9F0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">Worker 2</text>
  <rect x="230" y="165" width="85" height="40" rx="6" fill="#0f3460"/>
  <text x="272" y="189" fill="#4CC9F0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">Worker 3</text>

  <!-- Arrows PS ↔ Workers -->
  <line x1="197" y1="122" x2="72" y2="165" stroke="#4CC9F0" stroke-width="1.5"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(72,165) rotate(150)"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(120,140) rotate(-30)"/>
  <line x1="197" y1="122" x2="172" y2="165" stroke="#4CC9F0" stroke-width="1.5"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(172,165) rotate(180)"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(172,122) rotate(0)"/>
  <line x1="197" y1="122" x2="272" y2="165" stroke="#4CC9F0" stroke-width="1.5"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(272,165) rotate(20)"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(250,145) rotate(-160)"/>

  <text x="197" y="234" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">各Workerが勾配をPSに送信</text>
  <text x="197" y="252" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">PSがパラメータを集約・更新</text>
  <text x="197" y="272" fill="#4CC9F0" font-size="10" text-anchor="middle" font-family="sans-serif">実装: SageMaker + MXNet PS</text>
  <text x="197" y="292" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">課題: PSがボトルネックになりやすい</text>
  <text x="197" y="308" fill="#aaaaaa" font-size="10" text-anchor="middle" font-family="sans-serif">適用: 非同期学習、スパースモデル</text>

  <!-- RIGHT: AllReduce Architecture -->
  <rect x="420" y="45" width="365" height="280" rx="10" fill="#0f3460" style="filter:drop-shadow(2px 2px 6px rgba(0,0,0,0.5))"/>
  <text x="602" y="68" fill="#06D6A0" font-size="14" font-weight="bold" text-anchor="middle" font-family="sans-serif">AllReduce アーキテクチャ</text>

  <!-- Ring AllReduce: circular arrangement of 6 workers -->
  <!-- Worker circles in a ring -->
  <circle cx="602" cy="155" r="14" fill="#0f3460" stroke="#06D6A0" stroke-width="2"/>
  <text x="602" y="159" fill="#06D6A0" font-size="9" font-weight="bold" text-anchor="middle" font-family="sans-serif">W1</text>
  <circle cx="660" cy="175" r="14" fill="#0f3460" stroke="#06D6A0" stroke-width="2"/>
  <text x="660" y="179" fill="#06D6A0" font-size="9" font-weight="bold" text-anchor="middle" font-family="sans-serif">W2</text>
  <circle cx="680" cy="235" r="14" fill="#0f3460" stroke="#06D6A0" stroke-width="2"/>
  <text x="680" y="239" fill="#06D6A0" font-size="9" font-weight="bold" text-anchor="middle" font-family="sans-serif">W3</text>
  <circle cx="640" cy="285" r="14" fill="#0f3460" stroke="#06D6A0" stroke-width="2"/>
  <text x="640" y="289" fill="#06D6A0" font-size="9" font-weight="bold" text-anchor="middle" font-family="sans-serif">W4</text>
  <circle cx="565" cy="285" r="14" fill="#0f3460" stroke="#06D6A0" stroke-width="2"/>
  <text x="565" y="289" fill="#06D6A0" font-size="9" font-weight="bold" text-anchor="middle" font-family="sans-serif">W5</text>
  <circle cx="525" cy="235" r="14" fill="#0f3460" stroke="#06D6A0" stroke-width="2"/>
  <text x="525" y="239" fill="#06D6A0" font-size="9" font-weight="bold" text-anchor="middle" font-family="sans-serif">W6</text>
  <circle cx="545" cy="175" r="14" fill="#0f3460" stroke="#06D6A0" stroke-width="2"/>
  <text x="545" y="179" fill="#06D6A0" font-size="9" font-weight="bold" text-anchor="middle" font-family="sans-serif">W7</text>

  <!-- Ring arrows between workers -->
  <line x1="615" y1="163" x2="649" y2="170" stroke="#06D6A0" stroke-width="1.5"/>
  <line x1="669" y1="188" x2="677" y2="222" stroke="#06D6A0" stroke-width="1.5"/>
  <line x1="675" y1="249" x2="652" y2="274" stroke="#06D6A0" stroke-width="1.5"/>
  <line x1="627" y1="289" x2="579" y2="291" stroke="#06D6A0" stroke-width="1.5"/>
  <line x1="552" y1="279" x2="531" y2="252" stroke="#06D6A0" stroke-width="1.5"/>
  <line x1="522" y1="222" x2="534" y2="188" stroke="#06D6A0" stroke-width="1.5"/>
  <line x1="556" y1="168" x2="589" y2="155" stroke="#06D6A0" stroke-width="1.5"/>

  <text x="602" y="314" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">各Workerが隣接Workerへ勾配送受信</text>
  <text x="602" y="330" fill="#06D6A0" font-size="10" text-anchor="middle" font-family="sans-serif">実装: NCCL / Horovod / SageMaker Distributed</text>

  <!-- Bottom comparison table -->
  <rect x="15" y="340" width="770" height="145" rx="10" fill="#0f1e35"/>
  <text x="400" y="363" fill="#4CC9F0" font-size="13" font-weight="bold" text-anchor="middle" font-family="sans-serif">比較</text>

  <!-- Table header -->
  <text x="140" y="383" fill="#aaaaaa" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">項目</text>
  <text x="355" y="383" fill="#4CC9F0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">Parameter Server</text>
  <text x="580" y="383" fill="#06D6A0" font-size="11" font-weight="bold" text-anchor="middle" font-family="sans-serif">AllReduce (Ring)</text>

  <line x1="25" y1="390" x2="775" y2="390" stroke="#333333" stroke-width="1"/>

  <text x="140" y="410" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">通信パターン</text>
  <text x="355" y="410" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">Worker → PS (非対称)</text>
  <text x="580" y="410" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">Ring (対称・均等)</text>

  <text x="140" y="430" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">適用ケース</text>
  <text x="355" y="430" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">スパースモデル・非同期</text>
  <text x="580" y="430" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">密なモデル・同期学習</text>

  <text x="140" y="450" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">AWS実装</text>
  <text x="355" y="450" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">SM + Horovod MPI</text>
  <text x="580" y="450" fill="#ffffff" font-size="11" text-anchor="middle" font-family="sans-serif">NCCL / SMDP / Horovod</text>

  <text x="140" y="470" fill="#aaaaaa" font-size="11" text-anchor="middle" font-family="sans-serif">スケーラビリティ</text>
  <text x="355" y="470" fill="#F77F00" font-size="11" text-anchor="middle" font-family="sans-serif">PSがボトルネック</text>
  <text x="580" y="470" fill="#06D6A0" font-size="11" text-anchor="middle" font-family="sans-serif">線形スケール (推奨)</text>
</svg>
