<svg viewBox="0 0 800 500" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="500" fill="#0d1b2a"/>
  <text x="400" y="35" font-family="Arial,sans-serif" font-size="20" font-weight="bold" fill="#ffffff" text-anchor="middle">カナリアデプロイ — 段階的トラフィック移行</text>

  <!-- 5-step timeline -->
  <!-- Step labels at top -->
  <text x="75" y="65" font-family="Arial,sans-serif" font-size="11" fill="#aaaaaa" text-anchor="middle">Step 1</text>
  <text x="220" y="65" font-family="Arial,sans-serif" font-size="11" fill="#aaaaaa" text-anchor="middle">Step 2</text>
  <text x="370" y="65" font-family="Arial,sans-serif" font-size="11" fill="#aaaaaa" text-anchor="middle">Step 3</text>
  <text x="520" y="65" font-family="Arial,sans-serif" font-size="11" fill="#aaaaaa" text-anchor="middle">Step 4</text>
  <text x="700" y="65" font-family="Arial,sans-serif" font-size="11" fill="#06D6A0" text-anchor="middle">Step 5 完了</text>

  <!-- Step 1: 100% A -->
  <rect x="20" y="80" width="110" height="200" rx="6" fill="#1e3a5f" stroke="#4CC9F0" stroke-width="1"/>
  <rect x="20" y="80" width="110" height="200" rx="6" fill="#4CC9F0" opacity="0.7"/>
  <text x="75" y="190" font-family="Arial,sans-serif" font-size="13" font-weight="bold" fill="#0d1b2a" text-anchor="middle">Model A</text>
  <text x="75" y="210" font-family="Arial,sans-serif" font-size="13" font-weight="bold" fill="#0d1b2a" text-anchor="middle">100%</text>
  <text x="75" y="295" font-family="Arial,sans-serif" font-size="11" fill="#4CC9F0" text-anchor="middle">A: 100%</text>
  <text x="75" y="311" font-family="Arial,sans-serif" font-size="11" fill="#aaaaaa" text-anchor="middle">B: 0%</text>

  <!-- Arrow 1→2 -->
  <line x1="132" y1="180" x2="163" y2="180" stroke="#4CC9F0" stroke-width="2"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(166,180) rotate(90)"/>

  <!-- Step 2: 90% A + 10% B -->
  <rect x="168" y="80" width="110" height="200" rx="6" fill="#1e3a5f"/>
  <!-- A portion (90%) -->
  <rect x="168" y="80" width="110" height="180" rx="0" fill="#4CC9F0" opacity="0.7"/>
  <rect x="168" y="80" width="110" height="180" rx="6" fill="#4CC9F0" opacity="0"/>
  <rect x="168" y="80" width="110" height="8" rx="6" fill="#4CC9F0" opacity="0.7"/>
  <!-- B portion (10%) -->
  <rect x="168" y="260" width="110" height="20" rx="0" fill="#06D6A0" opacity="0.9"/>
  <rect x="168" y="272" width="110" height="8" rx="6" fill="#06D6A0" opacity="0.9"/>
  <text x="223" y="180" font-family="Arial,sans-serif" font-size="11" font-weight="bold" fill="#0d1b2a" text-anchor="middle">A: 90%</text>
  <text x="223" y="270" font-family="Arial,sans-serif" font-size="10" font-weight="bold" fill="#0d1b2a" text-anchor="middle">B:10%</text>
  <text x="223" y="295" font-family="Arial,sans-serif" font-size="11" fill="#4CC9F0" text-anchor="middle">A: 90%</text>
  <text x="223" y="311" font-family="Arial,sans-serif" font-size="11" fill="#06D6A0" text-anchor="middle">B: 10%</text>

  <!-- Arrow 2→3 -->
  <line x1="280" y1="180" x2="310" y2="180" stroke="#4CC9F0" stroke-width="2"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(313,180) rotate(90)"/>

  <!-- Step 3: 70% A + 30% B -->
  <rect x="315" y="80" width="110" height="200" rx="6" fill="#1e3a5f"/>
  <rect x="315" y="80" width="110" height="140" rx="0" fill="#4CC9F0" opacity="0.7"/>
  <rect x="315" y="80" width="110" height="8" rx="6" fill="#4CC9F0" opacity="0.7"/>
  <rect x="315" y="220" width="110" height="60" rx="0" fill="#06D6A0" opacity="0.9"/>
  <rect x="315" y="272" width="110" height="8" rx="6" fill="#06D6A0" opacity="0.9"/>
  <text x="370" y="155" font-family="Arial,sans-serif" font-size="11" font-weight="bold" fill="#0d1b2a" text-anchor="middle">A: 70%</text>
  <text x="370" y="255" font-family="Arial,sans-serif" font-size="11" font-weight="bold" fill="#0d1b2a" text-anchor="middle">B: 30%</text>
  <text x="370" y="295" font-family="Arial,sans-serif" font-size="11" fill="#4CC9F0" text-anchor="middle">A: 70%</text>
  <text x="370" y="311" font-family="Arial,sans-serif" font-size="11" fill="#06D6A0" text-anchor="middle">B: 30%</text>

  <!-- Arrow 3→4 -->
  <line x1="427" y1="180" x2="457" y2="180" stroke="#4CC9F0" stroke-width="2"/>
  <polygon points="0,-5 -4,4 4,4" fill="#4CC9F0" transform="translate(460,180) rotate(90)"/>

  <!-- Step 4: 50% A + 50% B -->
  <rect x="463" y="80" width="110" height="200" rx="6" fill="#1e3a5f"/>
  <rect x="463" y="80" width="110" height="100" rx="0" fill="#4CC9F0" opacity="0.7"/>
  <rect x="463" y="80" width="110" height="8" rx="6" fill="#4CC9F0" opacity="0.7"/>
  <rect x="463" y="180" width="110" height="100" rx="0" fill="#06D6A0" opacity="0.9"/>
  <rect x="463" y="272" width="110" height="8" rx="6" fill="#06D6A0" opacity="0.9"/>
  <text x="518" y="133" font-family="Arial,sans-serif" font-size="11" font-weight="bold" fill="#0d1b2a" text-anchor="middle">A: 50%</text>
  <text x="518" y="234" font-family="Arial,sans-serif" font-size="11" font-weight="bold" fill="#0d1b2a" text-anchor="middle">B: 50%</text>
  <text x="518" y="295" font-family="Arial,sans-serif" font-size="11" fill="#4CC9F0" text-anchor="middle">A: 50%</text>
  <text x="518" y="311" font-family="Arial,sans-serif" font-size="11" fill="#06D6A0" text-anchor="middle">B: 50%</text>

  <!-- Arrow 4→5 -->
  <line x1="575" y1="180" x2="610" y2="180" stroke="#06D6A0" stroke-width="2"/>
  <polygon points="0,-5 -4,4 4,4" fill="#06D6A0" transform="translate(613,180) rotate(90)"/>

  <!-- Step 5: 100% B -->
  <rect x="615" y="80" width="165" height="200" rx="6" fill="#0a1f0a" stroke="#06D6A0" stroke-width="2"/>
  <rect x="615" y="80" width="165" height="200" rx="6" fill="#06D6A0" opacity="0.8"/>
  <text x="697" y="175" font-family="Arial,sans-serif" font-size="14" font-weight="bold" fill="#0d1b2a" text-anchor="middle">Model B</text>
  <text x="697" y="197" font-family="Arial,sans-serif" font-size="14" font-weight="bold" fill="#0d1b2a" text-anchor="middle">100%</text>
  <text x="697" y="295" font-family="Arial,sans-serif" font-size="11" fill="#aaaaaa" text-anchor="middle">A: 0%</text>
  <text x="697" y="311" font-family="Arial,sans-serif" font-size="11" fill="#06D6A0" text-anchor="middle">B: 100%</text>

  <!-- Rollback note -->
  <rect x="168" y="330" width="440" height="45" rx="6" fill="#1a0a0a" stroke="#E63946" stroke-width="1"/>
  <text x="388" y="350" font-family="Arial,sans-serif" font-size="12" font-weight="bold" fill="#E63946" text-anchor="middle">メトリクス悪化を検出 → 即時ロールバック</text>
  <text x="388" y="368" font-family="Arial,sans-serif" font-size="10" fill="#aaaaaa" text-anchor="middle">CloudWatch Alarm + SNS → Rollback を自動実行</text>

  <!-- SageMaker code -->
  <rect x="20" y="390" width="760" height="95" rx="6" fill="#111e2d"/>
  <text x="400" y="411" font-family="Arial,sans-serif" font-size="12" font-weight="bold" fill="#4CC9F0" text-anchor="middle">SageMaker カナリア設定例</text>
  <text x="35" y="430" font-family="monospace" font-size="10" fill="#06D6A0">"CanarySize": {"Type": "CAPACITY_PERCENT", "Value": 10},</text>
  <text x="35" y="447" font-family="monospace" font-size="10" fill="#06D6A0">"WaitIntervalInSeconds": 300,  # 5分ごとに評価</text>
  <text x="35" y="464" font-family="monospace" font-size="10" fill="#aaaaaa">"LinearStepSize": {"Type": "CAPACITY_PERCENT", "Value": 10}  # 10%ずつ増加</text>
  <text x="400" y="480" font-family="Arial,sans-serif" font-size="10" fill="#aaaaaa" text-anchor="middle">★ WaitIntervalInSeconds で各ステップ間の評価時間を設定</text>
</svg>
