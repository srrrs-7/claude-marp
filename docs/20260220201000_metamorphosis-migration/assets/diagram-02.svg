<svg viewBox="0 0 900 500" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0">
  <rect width="900" height="500" fill="#0f0e17" rx="12"/>
  <text x="450" y="35" text-anchor="middle" fill="#fffffe" font-size="18" font-family="sans-serif" font-weight="bold">Imaginal Discs パターン：新旧システムの共存</text>

  <!-- Old system (Larva body) -->
  <rect x="50" y="60" width="800" height="180" fill="#92400e" rx="10" opacity="0.6" style="filter: drop-shadow(2px 2px 5px rgba(0,0,0,0.4))"/>
  <text x="450" y="85" text-anchor="middle" fill="#fde68a" font-size="14" font-family="sans-serif" font-weight="bold">旧システム（幼虫の体 = レガシーコードベース）</text>

  <!-- Legacy modules -->
  <rect x="70" y="100" width="140" height="55" fill="#78350f" rx="6"/>
  <text x="140" y="125" text-anchor="middle" fill="#fde68a" font-size="10" font-family="sans-serif">Auth Module</text>
  <text x="140" y="142" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">(PHP 5.x, 2008)</text>

  <rect x="230" y="100" width="140" height="55" fill="#78350f" rx="6"/>
  <text x="300" y="125" text-anchor="middle" fill="#fde68a" font-size="10" font-family="sans-serif">Payment Module</text>
  <text x="300" y="142" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">(Java EE, 2010)</text>

  <rect x="390" y="100" width="140" height="55" fill="#78350f" rx="6"/>
  <text x="460" y="125" text-anchor="middle" fill="#fde68a" font-size="10" font-family="sans-serif">Order Module</text>
  <text x="460" y="142" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">(Struts, 2009)</text>

  <rect x="550" y="100" width="140" height="55" fill="#78350f" rx="6"/>
  <text x="620" y="125" text-anchor="middle" fill="#fde68a" font-size="10" font-family="sans-serif">Report Module</text>
  <text x="620" y="142" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">(Crystal Reports)</text>

  <rect x="710" y="100" width="120" height="55" fill="#78350f" rx="6"/>
  <text x="770" y="125" text-anchor="middle" fill="#fde68a" font-size="10" font-family="sans-serif">Shared DB</text>
  <text x="770" y="142" text-anchor="middle" fill="#a7a9be" font-size="9" font-family="sans-serif">(Oracle 11g)</text>

  <!-- Imaginal discs (hidden inside) -->
  <circle cx="140" cy="200" r="22" fill="#2563eb" opacity="0.9" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.4))"/>
  <text x="140" y="196" text-anchor="middle" fill="#fffffe" font-size="8" font-family="sans-serif" font-weight="bold">New Auth</text>
  <text x="140" y="208" text-anchor="middle" fill="#93c5fd" font-size="7" font-family="sans-serif">OIDC/JWT</text>

  <circle cx="300" cy="200" r="22" fill="#2563eb" opacity="0.9" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.4))"/>
  <text x="300" y="196" text-anchor="middle" fill="#fffffe" font-size="8" font-family="sans-serif" font-weight="bold">New Pay</text>
  <text x="300" y="208" text-anchor="middle" fill="#93c5fd" font-size="7" font-family="sans-serif">Stripe API</text>

  <circle cx="460" cy="200" r="22" fill="#2563eb" opacity="0.9" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.4))"/>
  <text x="460" y="196" text-anchor="middle" fill="#fffffe" font-size="8" font-family="sans-serif" font-weight="bold">New Order</text>
  <text x="460" y="208" text-anchor="middle" fill="#93c5fd" font-size="7" font-family="sans-serif">Event Driven</text>

  <text x="450" y="233" text-anchor="middle" fill="#7ecaff" font-size="11" font-family="sans-serif" font-weight="bold">Imaginal Discs = 新サービスのプロトタイプが旧システム内に潜む</text>

  <!-- Arrow down: metamorphosis -->
  <line x1="450" y1="250" x2="450" y2="290" stroke="#e6b422" stroke-width="3"/>
  <polygon points="443,288 450,302 457,288" fill="#e6b422"/>
  <text x="520" y="275" fill="#e6b422" font-size="12" font-family="sans-serif" font-weight="bold">変態（Migration）</text>

  <!-- New system (Adult body) -->
  <rect x="50" y="305" width="800" height="180" fill="#2563eb" rx="10" opacity="0.3" style="filter: drop-shadow(2px 2px 5px rgba(0,0,0,0.4))"/>
  <text x="450" y="330" text-anchor="middle" fill="#7ecaff" font-size="14" font-family="sans-serif" font-weight="bold">新システム（成虫の体 = マイクロサービス）</text>

  <!-- New services (grown from imaginal discs) -->
  <rect x="60" y="345" width="150" height="60" fill="#2563eb" rx="8" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="135" y="370" text-anchor="middle" fill="#fffffe" font-size="11" font-family="sans-serif" font-weight="bold">Auth Service</text>
  <text x="135" y="390" text-anchor="middle" fill="#93c5fd" font-size="9" font-family="sans-serif">OIDC + JWT + MFA</text>

  <rect x="230" y="345" width="150" height="60" fill="#2563eb" rx="8" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="305" y="370" text-anchor="middle" fill="#fffffe" font-size="11" font-family="sans-serif" font-weight="bold">Payment Service</text>
  <text x="305" y="390" text-anchor="middle" fill="#93c5fd" font-size="9" font-family="sans-serif">Stripe + PCI DSS</text>

  <rect x="400" y="345" width="150" height="60" fill="#2563eb" rx="8" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="475" y="370" text-anchor="middle" fill="#fffffe" font-size="11" font-family="sans-serif" font-weight="bold">Order Service</text>
  <text x="475" y="390" text-anchor="middle" fill="#93c5fd" font-size="9" font-family="sans-serif">Event Sourcing</text>

  <rect x="570" y="345" width="130" height="60" fill="#2563eb" rx="8" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="635" y="370" text-anchor="middle" fill="#fffffe" font-size="11" font-family="sans-serif" font-weight="bold">Analytics</text>
  <text x="635" y="390" text-anchor="middle" fill="#93c5fd" font-size="9" font-family="sans-serif">ClickHouse</text>

  <rect x="720" y="345" width="120" height="60" fill="#2d6a4f" rx="8" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3))"/>
  <text x="780" y="370" text-anchor="middle" fill="#fffffe" font-size="11" font-family="sans-serif" font-weight="bold">New DB</text>
  <text x="780" y="390" text-anchor="middle" fill="#52b788" font-size="9" font-family="sans-serif">PostgreSQL</text>

  <!-- Connection lines from discs to services -->
  <path d="M140,222 L135,345" stroke="#e6b422" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.6"/>
  <path d="M300,222 L305,345" stroke="#e6b422" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.6"/>
  <path d="M460,222 L475,345" stroke="#e6b422" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.6"/>

  <!-- Bottom text -->
  <text x="450" y="430" text-anchor="middle" fill="#a7a9be" font-size="11" font-family="sans-serif">幼虫の体内にある成虫原基（Imaginal Discs）が変態後に新しい器官となる</text>
  <text x="450" y="450" text-anchor="middle" fill="#e6b422" font-size="11" font-family="sans-serif">= 旧システム内のプロトタイプ/POCが、マイグレーション後の新サービスの核となる</text>

  <!-- Legend -->
  <rect x="50" y="465" width="800" height="25" fill="#0f0e17" rx="4"/>
  <circle cx="100" cy="477" r="8" fill="#2563eb"/>
  <text x="115" y="482" fill="#a7a9be" font-size="10" font-family="sans-serif">Imaginal Disc (新サービスの原基)</text>
  <rect x="310" y="470" width="30" height="15" fill="#78350f" rx="2"/>
  <text x="348" y="482" fill="#a7a9be" font-size="10" font-family="sans-serif">Legacy Module</text>
  <rect x="530" y="470" width="30" height="15" fill="#2563eb" rx="2"/>
  <text x="568" y="482" fill="#a7a9be" font-size="10" font-family="sans-serif">New Service</text>
</svg>
