<svg viewBox="0 0 900 500" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0">
  <rect width="900" height="500" fill="#0f172a"/>

  <!-- Title -->
  <text x="450" y="28" text-anchor="middle" fill="#f1f5f9" font-size="16" font-weight="bold" font-family="sans-serif">Async Inference キューイングアーキテクチャ</text>

  <!-- Client -->
  <rect x="20" y="60" width="100" height="55" rx="8" fill="#1e293b" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"/>
  <text x="70" y="85" text-anchor="middle" fill="#f1f5f9" font-size="12" font-family="sans-serif">Client</text>
  <text x="70" y="103" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">アプリ</text>

  <!-- Arrow Client → SageMaker Async -->
  <line x1="120" y1="87" x2="178" y2="87" stroke="#3b82f6" stroke-width="2"/>
  <polygon points="178,82 188,87 178,92" fill="#3b82f6"/>
  <text x="154" y="78" text-anchor="middle" fill="#3b82f6" font-size="9" font-family="sans-serif">InvokeEndpointAsync</text>

  <!-- SageMaker Async API -->
  <rect x="188" y="60" width="140" height="55" rx="8" fill="#3b82f6" opacity="0.8"/>
  <text x="258" y="85" text-anchor="middle" fill="#fff" font-size="11" font-family="sans-serif">SageMaker</text>
  <text x="258" y="101" text-anchor="middle" fill="#fff" font-size="10" font-family="sans-serif">Async Endpoint</text>

  <!-- Arrow to Queue -->
  <line x1="328" y1="87" x2="386" y2="87" stroke="#f97316" stroke-width="2"/>
  <polygon points="386,82 396,87 386,92" fill="#f97316"/>
  <text x="357" y="78" text-anchor="middle" fill="#f97316" font-size="9" font-family="sans-serif">エンキュー</text>

  <!-- Internal Queue -->
  <rect x="396" y="50" width="150" height="75" rx="8" fill="#1e293b" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"/>
  <text x="471" y="72" text-anchor="middle" fill="#f97316" font-size="12" font-weight="bold" font-family="sans-serif">Internal Queue</text>
  <text x="471" y="90" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">(SQS-like)</text>
  <!-- Queue items -->
  <rect x="406" y="97" width="30" height="18" rx="2" fill="#f97316" opacity="0.7"/>
  <rect x="442" y="97" width="30" height="18" rx="2" fill="#f97316" opacity="0.5"/>
  <rect x="478" y="97" width="30" height="18" rx="2" fill="#f97316" opacity="0.3"/>
  <text x="471" y="120" text-anchor="middle" fill="#64748b" font-size="9" font-family="sans-serif">Req1 Req2 Req3...</text>

  <!-- Arrow Queue → Inference -->
  <line x1="546" y1="87" x2="594" y2="87" stroke="#22c55e" stroke-width="2"/>
  <polygon points="594,82 604,87 594,92" fill="#22c55e"/>
  <text x="570" y="78" text-anchor="middle" fill="#22c55e" font-size="9" font-family="sans-serif">デキュー</text>

  <!-- Inference Container -->
  <rect x="604" y="45" width="160" height="90" rx="8" fill="#1e293b" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"/>
  <text x="684" y="68" text-anchor="middle" fill="#22c55e" font-size="11" font-weight="bold" font-family="sans-serif">Inference Container</text>
  <rect x="618" y="77" width="55" height="25" rx="4" fill="#0f172a"/>
  <text x="645" y="89" text-anchor="middle" fill="#94a3b8" font-size="9" font-family="sans-serif">GPU</text>
  <text x="645" y="101" text-anchor="middle" fill="#64748b" font-size="8" font-family="sans-serif">g4dn.xl</text>
  <rect x="680" y="77" width="55" height="25" rx="4" fill="#0f172a"/>
  <text x="707" y="89" text-anchor="middle" fill="#94a3b8" font-size="9" font-family="sans-serif">GPU</text>
  <text x="707" y="101" text-anchor="middle" fill="#64748b" font-size="8" font-family="sans-serif">g4dn.xl</text>
  <text x="684" y="128" text-anchor="middle" fill="#94a3b8" font-size="9" font-family="sans-serif">MaxConcurrentInvocations設定</text>

  <!-- Scale-to-zero note -->
  <rect x="604" y="145" width="160" height="35" rx="6" fill="#22c55e" opacity="0.15"/>
  <text x="684" y="161" text-anchor="middle" fill="#22c55e" font-size="10" font-weight="bold" font-family="sans-serif">Scale-to-zero</text>
  <text x="684" y="175" text-anchor="middle" fill="#94a3b8" font-size="9" font-family="sans-serif">キュー空=0インスタンス</text>

  <!-- Output: S3 -->
  <line x1="764" y1="87" x2="812" y2="87" stroke="#3b82f6" stroke-width="2"/>
  <polygon points="812,82 822,87 812,92" fill="#3b82f6"/>

  <rect x="822" y="55" width="68" height="55" rx="8" fill="#1e293b" style="filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5))"/>
  <text x="856" y="79" text-anchor="middle" fill="#3b82f6" font-size="11" font-weight="bold" font-family="sans-serif">S3</text>
  <text x="856" y="95" text-anchor="middle" fill="#94a3b8" font-size="9" font-family="sans-serif">結果出力</text>
  <text x="856" y="107" text-anchor="middle" fill="#64748b" font-size="8" font-family="sans-serif">output</text>

  <!-- SNS notification -->
  <line x1="856" y1="110" x2="856" y2="155" stroke="#a855f7" stroke-width="2"/>
  <polygon points="851,155 856,165 861,155" fill="#a855f7"/>

  <rect x="810" y="165" width="80" height="45" rx="8" fill="#a855f7" opacity="0.8"/>
  <text x="850" y="187" text-anchor="middle" fill="#fff" font-size="11" font-weight="bold" font-family="sans-serif">SNS</text>
  <text x="850" y="202" text-anchor="middle" fill="#e9d5ff" font-size="9" font-family="sans-serif">完了通知</text>

  <!-- Client polling / callback -->
  <line x1="810" y1="188" x2="70" y2="188" stroke="#a855f7" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="70,183 60,188 70,193" fill="#a855f7"/>
  <text x="440" y="178" text-anchor="middle" fill="#a855f7" font-size="10" font-family="sans-serif">SNS 通知 / Client ポーリング</text>

  <!-- Separator -->
  <line x1="20" y1="220" x2="880" y2="220" stroke="#334155" stroke-width="1"/>

  <!-- Config panel -->
  <text x="450" y="245" text-anchor="middle" fill="#f1f5f9" font-size="13" font-weight="bold" font-family="sans-serif">設定・制限</text>

  <rect x="20" y="258" width="200" height="90" rx="8" fill="#1e293b"/>
  <text x="120" y="278" text-anchor="middle" fill="#3b82f6" font-size="11" font-weight="bold" font-family="sans-serif">リクエスト設定</text>
  <text x="120" y="296" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">タイムアウト: 最大 3600秒</text>
  <text x="120" y="314" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">ペイロード: 最大 1 GB</text>
  <text x="120" y="332" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">出力: S3 バケット指定</text>

  <rect x="235" y="258" width="200" height="90" rx="8" fill="#1e293b"/>
  <text x="335" y="278" text-anchor="middle" fill="#22c55e" font-size="11" font-weight="bold" font-family="sans-serif">コスト最適化</text>
  <text x="335" y="296" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">Scale-to-zero 対応</text>
  <text x="335" y="314" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">キュー空=0インスタンス</text>
  <text x="335" y="332" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">GPU 使用時間のみ課金</text>

  <rect x="450" y="258" width="200" height="90" rx="8" fill="#1e293b"/>
  <text x="550" y="278" text-anchor="middle" fill="#f97316" font-size="11" font-weight="bold" font-family="sans-serif">通知・エラー</text>
  <text x="550" y="296" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">成功: SNS 通知</text>
  <text x="550" y="314" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">失敗: failure_path (S3)</text>
  <text x="550" y="332" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">エラー詳細をS3に保存</text>

  <rect x="665" y="258" width="215" height="90" rx="8" fill="#1e293b"/>
  <text x="772" y="278" text-anchor="middle" fill="#a855f7" font-size="11" font-weight="bold" font-family="sans-serif">ユースケース</text>
  <text x="772" y="296" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">大容量ペイロード (動画/音声)</text>
  <text x="772" y="314" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">長時間推論処理</text>
  <text x="772" y="332" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">バッチ的な非同期処理</text>

  <!-- vs Real-time comparison -->
  <rect x="20" y="365" width="860" height="110" rx="8" fill="#1e293b"/>
  <text x="450" y="387" text-anchor="middle" fill="#f1f5f9" font-size="12" font-weight="bold" font-family="sans-serif">Async vs Real-time 比較</text>

  <rect x="30" y="397" width="400" height="68" rx="6" fill="#0f172a"/>
  <text x="230" y="415" text-anchor="middle" fill="#3b82f6" font-size="11" font-weight="bold" font-family="sans-serif">Real-time Endpoint</text>
  <text x="230" y="433" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">同期レスポンス / ペイロード 6MB / タイムアウト 60秒</text>
  <text x="230" y="451" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">常時インスタンス稼働 / 低レイテンシ必須</text>

  <rect x="450" y="397" width="420" height="68" rx="6" fill="#0f172a"/>
  <text x="660" y="415" text-anchor="middle" fill="#f97316" font-size="11" font-weight="bold" font-family="sans-serif">Async Inference</text>
  <text x="660" y="433" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">非同期処理 / ペイロード 1GB / タイムアウト 3600秒</text>
  <text x="660" y="451" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">Scale-to-zero / 大容量・長時間処理向け</text>
</svg>
