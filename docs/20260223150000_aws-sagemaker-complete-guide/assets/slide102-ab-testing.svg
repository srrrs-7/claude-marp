<svg viewBox="0 0 900 500" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0" xmlns="http://www.w3.org/2000/svg">
  <rect width="900" height="500" fill="#0f172a"/>
  <text x="450" y="26" text-anchor="middle" fill="#f1f5f9" font-size="16" font-weight="bold" font-family="sans-serif">A/B テスト・実験フレームワーク</text>

  <!-- Traffic Router / Endpoint -->
  <rect x="320" y="45" width="260" height="70" rx="10" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
  <text x="450" y="68" text-anchor="middle" fill="#f1f5f9" font-size="12" font-weight="bold" font-family="sans-serif">SageMaker Endpoint</text>
  <text x="450" y="85" text-anchor="middle" fill="#3b82f6" font-size="11" font-family="sans-serif">Traffic Router (Production Variants)</text>
  <text x="450" y="103" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">VariantWeight でトラフィック割合制御</text>

  <!-- Incoming traffic arrow -->
  <rect x="355" y="10" width="190" height="32" rx="6" fill="#1e293b" stroke="#475569" stroke-width="1"/>
  <text x="450" y="30" text-anchor="middle" fill="#94a3b8" font-size="11" font-family="sans-serif">受信トラフィック (ユーザーリクエスト)</text>
  <line x1="450" y1="42" x2="450" y2="45" stroke="#94a3b8" stroke-width="2"/>
  <polygon points="446,45 450,50 454,45" fill="#94a3b8"/>

  <!-- Variant A -->
  <line x1="370" y1="115" x2="200" y2="155" stroke="#3b82f6" stroke-width="2"/>
  <polygon points="193,151 200,155 195,162" fill="#3b82f6"/>

  <rect x="60" y="155" width="270" height="90" rx="10" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
  <text x="195" y="177" text-anchor="middle" fill="#3b82f6" font-size="12" font-weight="bold" font-family="sans-serif">Variant A — Baseline</text>
  <text x="195" y="195" text-anchor="middle" fill="#94a3b8" font-size="11" font-family="sans-serif">現行モデル (Base Model)</text>
  <rect x="90" y="205" width="210" height="30" rx="6" fill="#0f172a"/>
  <text x="195" y="224" text-anchor="middle" fill="#fbbf24" font-size="12" font-weight="bold" font-family="sans-serif">50% トラフィック</text>

  <!-- Variant B -->
  <line x1="530" y1="115" x2="700" y2="155" stroke="#22c55e" stroke-width="2"/>
  <polygon points="700,151 707,155 700,162" fill="#22c55e"/>

  <rect x="570" y="155" width="270" height="90" rx="10" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
  <text x="705" y="177" text-anchor="middle" fill="#22c55e" font-size="12" font-weight="bold" font-family="sans-serif">Variant B — Challenger</text>
  <text x="705" y="195" text-anchor="middle" fill="#94a3b8" font-size="11" font-family="sans-serif">新モデル (Fine-tuned/New)</text>
  <rect x="600" y="205" width="210" height="30" rx="6" fill="#0f172a"/>
  <text x="705" y="224" text-anchor="middle" fill="#fbbf24" font-size="12" font-weight="bold" font-family="sans-serif">50% トラフィック</text>

  <!-- Metrics Collection -->
  <rect x="15" y="265" width="870" height="100" rx="8" fill="#1e293b"/>
  <text x="450" y="285" text-anchor="middle" fill="#f97316" font-size="13" font-weight="bold" font-family="sans-serif">メトリクス収集パイプライン</text>

  <rect x="25" y="295" width="195" height="60" rx="6" fill="#0f172a"/>
  <text x="122" y="314" text-anchor="middle" fill="#3b82f6" font-size="10" font-weight="bold" font-family="sans-serif">Data Capture → S3</text>
  <text x="35" y="331" fill="#94a3b8" font-size="9" font-family="sans-serif">リクエスト/レスポンス記録</text>
  <text x="35" y="345" fill="#94a3b8" font-size="9" font-family="sans-serif">各Variant別のログ</text>

  <rect x="232" y="295" width="195" height="60" rx="6" fill="#0f172a"/>
  <text x="329" y="314" text-anchor="middle" fill="#a855f7" font-size="10" font-weight="bold" font-family="sans-serif">Athena クエリ</text>
  <text x="242" y="331" fill="#94a3b8" font-size="9" font-family="sans-serif">S3ログのSQL分析</text>
  <text x="242" y="345" fill="#94a3b8" font-size="9" font-family="sans-serif">統計的有意差検定</text>

  <rect x="440" y="295" width="195" height="60" rx="6" fill="#0f172a"/>
  <text x="537" y="314" text-anchor="middle" fill="#22c55e" font-size="10" font-weight="bold" font-family="sans-serif">CloudWatch Dashboard</text>
  <text x="450" y="331" fill="#94a3b8" font-size="9" font-family="sans-serif">ビジネスKPI: CTR, CVR</text>
  <text x="450" y="345" fill="#94a3b8" font-size="9" font-family="sans-serif">ML指標: Latency, Error</text>

  <rect x="648" y="295" width="227" height="60" rx="6" fill="#0f172a"/>
  <text x="761" y="314" text-anchor="middle" fill="#f97316" font-size="10" font-weight="bold" font-family="sans-serif">Winner 決定 → Rollout</text>
  <text x="658" y="331" fill="#94a3b8" font-size="9" font-family="sans-serif">p値 &lt; 0.05 → 統計的有意</text>
  <text x="658" y="345" fill="#94a3b8" font-size="9" font-family="sans-serif">段階的に100%移行</text>

  <!-- Multi-armed bandit -->
  <rect x="15" y="378" width="870" height="110" rx="8" fill="#1e293b"/>
  <text x="450" y="398" text-anchor="middle" fill="#14b8a6" font-size="13" font-weight="bold" font-family="sans-serif">Multi-Armed Bandit (MAB) — 動的トラフィック割当</text>

  <!-- MAB visualization -->
  <rect x="25" y="408" width="250" height="70" rx="6" fill="#0f172a"/>
  <text x="150" y="426" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">従来 A/B テスト</text>
  <!-- Static bars -->
  <rect x="40" y="435" width="90" height="20" rx="3" fill="#3b82f6" opacity="0.7"/>
  <text x="85" y="450" text-anchor="middle" fill="#f1f5f9" font-size="9" font-family="sans-serif">50%</text>
  <rect x="145" y="435" width="90" height="20" rx="3" fill="#22c55e" opacity="0.7"/>
  <text x="190" y="450" text-anchor="middle" fill="#f1f5f9" font-size="9" font-family="sans-serif">50%</text>
  <text x="150" y="472" text-anchor="middle" fill="#94a3b8" font-size="9" font-family="sans-serif">固定割合 / 試験期間完了まで待機</text>

  <text x="295" y="445" text-anchor="middle" fill="#475569" font-size="20" font-family="sans-serif">vs</text>

  <rect x="330" y="408" width="250" height="70" rx="6" fill="#0f172a"/>
  <text x="455" y="426" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">MAB — Epsilon-Greedy</text>
  <!-- Dynamic bars A smaller, B larger (B winning) -->
  <rect x="345" y="435" width="55" height="20" rx="3" fill="#3b82f6" opacity="0.7"/>
  <text x="372" y="450" text-anchor="middle" fill="#f1f5f9" font-size="9" font-family="sans-serif">20%</text>
  <rect x="410" y="435" width="125" height="20" rx="3" fill="#22c55e" opacity="0.7"/>
  <text x="472" y="450" text-anchor="middle" fill="#f1f5f9" font-size="9" font-family="sans-serif">80%</text>
  <text x="455" y="472" text-anchor="middle" fill="#22c55e" font-size="9" font-family="sans-serif">リアルタイム性能に応じて自動調整</text>

  <rect x="598" y="408" width="282" height="70" rx="6" fill="#0f172a"/>
  <text x="739" y="426" text-anchor="middle" fill="#fbbf24" font-size="11" font-weight="bold" font-family="sans-serif">MAB のメリット</text>
  <text x="608" y="444" fill="#94a3b8" font-size="10" font-family="sans-serif">探索(exploration)と活用(exploitation)のバランス</text>
  <text x="608" y="459" fill="#94a3b8" font-size="10" font-family="sans-serif">劣位バリアントへの露出を自動削減</text>
  <text x="608" y="474" fill="#22c55e" font-size="10" font-weight="bold" font-family="sans-serif">累積損失の最小化 → 継続的最適化</text>
</svg>
