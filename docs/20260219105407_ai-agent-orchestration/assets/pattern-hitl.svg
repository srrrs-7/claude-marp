<svg viewBox="0 0 1000 320" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0;background:#0f172a;border-radius:12px">
  <text x="500" y="28" text-anchor="middle" fill="#f1f5f9" font-size="16" font-weight="bold" font-family="sans-serif">Human-in-the-Loop — 承認フローの設計</text>
  <!-- Step 1: User Request -->
  <rect x="20" y="50" width="130" height="50" rx="8" fill="#1e293b" stroke="#64748b" stroke-width="1.5"/>
  <text x="85" y="72" text-anchor="middle" fill="#94a3b8" font-size="12" font-family="sans-serif">User Request</text>
  <text x="85" y="88" text-anchor="middle" fill="#64748b" font-size="10" font-family="sans-serif">高リスク操作の依頼</text>
  <!-- Arrow 1 -->
  <line x1="150" y1="75" x2="174" y2="75" stroke="#64748b" stroke-width="2"/>
  <polygon points="174,69 184,75 174,81" fill="#64748b"/>
  <!-- Step 2: Agent Processing -->
  <rect x="184" y="50" width="150" height="50" rx="8" fill="#1e3a5f" stroke="#38bdf8" stroke-width="2"/>
  <text x="259" y="72" text-anchor="middle" fill="#38bdf8" font-size="13" font-weight="bold" font-family="sans-serif">Agent</text>
  <text x="259" y="88" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">処理・計画立案</text>
  <!-- Arrow 2 -->
  <line x1="334" y1="75" x2="358" y2="75" stroke="#64748b" stroke-width="2"/>
  <polygon points="358,69 368,75 358,81" fill="#64748b"/>
  <!-- Step 3: Interrupt Point -->
  <rect x="368" y="44" width="160" height="62" rx="8" fill="#2d1f00" stroke="#fbbf24" stroke-width="2.5"/>
  <text x="448" y="65" text-anchor="middle" fill="#fbbf24" font-size="13" font-weight="bold" font-family="sans-serif">INTERRUPT</text>
  <text x="448" y="82" text-anchor="middle" fill="#fcd34d" font-size="11" font-family="sans-serif">承認待ち状態</text>
  <text x="448" y="97" text-anchor="middle" fill="#92400e" font-size="10" font-family="sans-serif">timeout: 30min</text>
  <!-- Human approval branch -->
  <line x1="448" y1="106" x2="448" y2="130" stroke="#fbbf24" stroke-width="2"/>
  <!-- Human decision box -->
  <rect x="348" y="130" width="200" height="60" rx="8" fill="#1e293b" stroke="#94a3b8" stroke-width="2"/>
  <text x="448" y="152" text-anchor="middle" fill="#e2e8f0" font-size="14" font-weight="bold" font-family="sans-serif">Human Operator</text>
  <text x="448" y="170" text-anchor="middle" fill="#94a3b8" font-size="11" font-family="sans-serif">内容確認・判断</text>
  <text x="448" y="183" text-anchor="middle" fill="#64748b" font-size="10" font-family="sans-serif">Slack / Email / Web UI</text>
  <!-- Approve branch -->
  <line x1="548" y1="160" x2="620" y2="160" stroke="#34d399" stroke-width="2"/>
  <polygon points="620,154 630,160 620,166" fill="#34d399"/>
  <text x="584" y="148" text-anchor="middle" fill="#34d399" font-size="12" font-weight="bold" font-family="sans-serif">承認</text>
  <rect x="630" y="135" width="150" height="50" rx="8" fill="#14532d" stroke="#34d399" stroke-width="2"/>
  <text x="705" y="157" text-anchor="middle" fill="#34d399" font-size="13" font-weight="bold" font-family="sans-serif">継続処理</text>
  <text x="705" y="173" text-anchor="middle" fill="#86efac" font-size="11" font-family="sans-serif">Agent再開・実行</text>
  <!-- Output after approve -->
  <line x1="780" y1="160" x2="804" y2="160" stroke="#34d399" stroke-width="2"/>
  <polygon points="804,154 814,160 804,166" fill="#34d399"/>
  <rect x="814" y="135" width="160" height="50" rx="8" fill="#0f172a" stroke="#34d399" stroke-width="1.5"/>
  <text x="894" y="157" text-anchor="middle" fill="#86efac" font-size="12" font-family="sans-serif">操作実行</text>
  <text x="894" y="173" text-anchor="middle" fill="#64748b" font-size="10" font-family="sans-serif">DB更新・外部API・送信</text>
  <!-- Reject branch -->
  <line x1="348" y1="175" x2="200" y2="220" stroke="#f87171" stroke-width="2"/>
  <polygon points="193,215 200,227 207,215" fill="#f87171"/>
  <text x="256" y="200" text-anchor="middle" fill="#f87171" font-size="12" font-weight="bold" font-family="sans-serif">却下・修正指示</text>
  <rect x="70" y="228" width="260" height="50" rx="8" fill="#2d1515" stroke="#f87171" stroke-width="1.5"/>
  <text x="200" y="250" text-anchor="middle" fill="#f87171" font-size="13" font-weight="bold" font-family="sans-serif">Agent 修正・再計画</text>
  <text x="200" y="268" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="sans-serif">フィードバックを元に再処理</text>
  <!-- Loop back arrow -->
  <line x1="200" y1="228" x2="200" y2="75" stroke="#f87171" stroke-width="1.5" stroke-dasharray="5,4"/>
  <polygon points="193,80 200,68 207,80" fill="#f87171"/>
  <!-- Timeout branch -->
  <line x1="528" y1="160" x2="548" y2="235" stroke="#fbbf24" stroke-width="1.5" stroke-dasharray="4,3"/>
  <rect x="460" y="235" width="180" height="42" rx="6" fill="#1e293b" stroke="#fbbf24" stroke-width="1"/>
  <text x="550" y="253" text-anchor="middle" fill="#fbbf24" font-size="11" font-family="sans-serif">タイムアウト処理</text>
  <text x="550" y="269" text-anchor="middle" fill="#64748b" font-size="10" font-family="sans-serif">エスカレーション / キャンセル</text>
  <!-- Key use cases -->
  <text x="500" y="300" text-anchor="middle" fill="#94a3b8" font-size="12" font-family="sans-serif">適用場面: 金融取引・医療判断・法務文書・大規模削除操作・メール送信</text>
</svg>
