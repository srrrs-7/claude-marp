<svg viewBox="0 0 900 600" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;max-width:100%;display:block;margin:0 auto;">
  <!-- Background -->
  <rect width="900" height="600" fill="#f8f9fa"/>

  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-family="Arial" font-size="18" font-weight="bold" fill="#333">AssumeRole フロー詳細</text>

  <!-- Participants -->
  <g id="participants">
    <rect x="50" y="60" width="140" height="60" rx="8" fill="#667EEA" stroke="#5A67D8" stroke-width="2"/>
    <text x="120" y="85" text-anchor="middle" font-family="Arial" font-size="13" font-weight="bold" fill="white">IAMユーザー/</text>
    <text x="120" y="103" text-anchor="middle" font-family="Arial" font-size="13" font-weight="bold" fill="white">ロール</text>

    <rect x="260" y="60" width="140" height="60" rx="8" fill="#F6AD55" stroke="#DD6B20" stroke-width="2"/>
    <text x="330" y="95" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="white">AWS STS</text>

    <rect x="470" y="60" width="140" height="60" rx="8" fill="#9F7AEA" stroke="#6B46C1" stroke-width="2"/>
    <text x="540" y="85" text-anchor="middle" font-family="Arial" font-size="13" font-weight="bold" fill="white">ターゲット</text>
    <text x="540" y="103" text-anchor="middle" font-family="Arial" font-size="13" font-weight="bold" fill="white">ロール</text>

    <rect x="680" y="60" width="140" height="60" rx="8" fill="#48BB78" stroke="#38A169" stroke-width="2"/>
    <text x="750" y="85" text-anchor="middle" font-family="Arial" font-size="13" font-weight="bold" fill="white">AWS</text>
    <text x="750" y="103" text-anchor="middle" font-family="Arial" font-size="13" font-weight="bold" fill="white">サービス</text>
  </g>

  <!-- Lifelines -->
  <line x1="120" y1="120" x2="120" y2="560" stroke="#999" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="330" y1="120" x2="330" y2="560" stroke="#999" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="540" y1="120" x2="540" y2="560" stroke="#999" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="750" y1="120" x2="750" y2="560" stroke="#999" stroke-width="2" stroke-dasharray="5,5"/>

  <!-- Arrows -->
  <defs>
    <marker id="arrowSeq" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333"/>
    </marker>
    <marker id="arrowReturn" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M9,0 L9,6 L0,3 z" fill="#48BB78"/>
    </marker>
  </defs>

  <!-- Step 1: AssumeRole request -->
  <line x1="120" y1="160" x2="330" y2="160" stroke="#333" stroke-width="2.5" marker-end="url(#arrowSeq)"/>
  <text x="200" y="150" font-family="Arial" font-size="12" fill="#333">① AssumeRole</text>
  <text x="200" y="168" font-family="Arial" font-size="11" fill="#666">(RoleArn)</text>

  <!-- Step 2: Trust policy check -->
  <line x1="330" y1="220" x2="540" y2="220" stroke="#333" stroke-width="2.5" marker-end="url(#arrowSeq)"/>
  <text x="410" y="210" font-family="Arial" font-size="12" fill="#333">② トラストポリシー</text>
  <text x="410" y="228" font-family="Arial" font-size="11" fill="#666">確認</text>

  <!-- Evaluation box -->
  <rect x="545" y="240" width="140" height="70" rx="8" fill="#FEF5E7" stroke="#F39C12" stroke-width="2"/>
  <text x="615" y="265" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#D68910">評価:</text>
  <text x="615" y="283" text-anchor="middle" font-family="Arial" font-size="10" fill="#D68910">Principal一致?</text>
  <text x="615" y="298" text-anchor="middle" font-family="Arial" font-size="10" fill="#D68910">Condition満たす?</text>

  <!-- Step 3: Approval -->
  <line x1="540" y1="340" x2="330" y2="340" stroke="#48BB78" stroke-width="2.5" stroke-dasharray="5,5" marker-end="url(#arrowReturn)"/>
  <text x="410" y="330" font-family="Arial" font-size="12" fill="#38A169" font-weight="bold">③ 許可</text>

  <!-- Step 4: Temporary credentials -->
  <line x1="330" y1="400" x2="120" y2="400" stroke="#48BB78" stroke-width="2.5" stroke-dasharray="5,5" marker-end="url(#arrowReturn)"/>
  <rect x="135" y="415" width="180" height="70" rx="5" fill="#E6FFFA" stroke="#319795" stroke-width="1"/>
  <text x="225" y="435" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#234E52">④ 一時認証情報:</text>
  <text x="225" y="453" text-anchor="middle" font-family="Arial" font-size="10" fill="#234E52">• AccessKeyId (ASIA...)</text>
  <text x="225" y="468" text-anchor="middle" font-family="Arial" font-size="10" fill="#234E52">• SecretAccessKey</text>
  <text x="225" y="483" text-anchor="middle" font-family="Arial" font-size="10" fill="#234E52">• SessionToken</text>

  <!-- Step 5: API call with temp credentials -->
  <line x1="120" y1="520" x2="750" y2="520" stroke="#333" stroke-width="2.5" marker-end="url(#arrowSeq)"/>
  <text x="410" y="510" font-family="Arial" font-size="12" fill="#333">⑤ API呼び出し (一時認証情報)</text>

  <!-- Step 6: Response -->
  <line x1="750" y1="550" x2="120" y2="550" stroke="#48BB78" stroke-width="2.5" stroke-dasharray="5,5" marker-end="url(#arrowReturn)"/>
  <text x="410" y="565" font-family="Arial" font-size="12" fill="#38A169" font-weight="bold">⑥ レスポンス</text>

  <!-- Legend -->
  <rect x="20" y="20" width="180" height="30" rx="5" fill="white" stroke="#ddd" stroke-width="1"/>
  <line x1="30" y1="35" x2="60" y2="35" stroke="#333" stroke-width="2"/>
  <text x="65" y="39" font-family="Arial" font-size="10" fill="#333">リクエスト</text>
  <line x1="115" y1="35" x2="145" y2="35" stroke="#48BB78" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="150" y="39" font-family="Arial" font-size="10" fill="#333">レスポンス</text>
</svg>
