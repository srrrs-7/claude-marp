{
	"slides": [
		{
			"title": "マクスウェルの悪魔とキャッシュ無効化",
			"layout": "center",
			"content": [
				"**CSで最も難しい問題：キャッシュ無効化**",
				"",
				"> \"There are only two hard things in Computer Science:",
				"> cache invalidation and naming things.\"",
				"> — Phil Karlton",
				"",
				"なぜキャッシュ無効化は難しいのか？",
				"1867年の物理学に答えがある"
			],
			"speakerNotes": "キャッシュ無効化の困難さを物理学の視点から解説するプレゼンテーション"
		},
		{
			"title": "マクスウェルの悪魔とは",
			"layout": "section",
			"content": [
				"1867年 ジェームズ・クラーク・マクスウェルの思考実験",
				"熱力学第二法則への挑戦"
			]
		},
		{
			"title": "1867年の思考実験：熱力学第二法則を破れるか？",
			"content": [
				"<svg viewBox='0 0 700 320' style='max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- 左の部屋（熱い分子） -->",
				"  <rect x='30' y='40' width='270' height='240' rx='8' fill='#1a3a5c' stroke='#4a9eff' stroke-width='2'/>",
				"  <text x='165' y='30' text-anchor='middle' fill='#4a9eff' font-size='14' font-family='sans-serif'>室 A（熱い）</text>",
				"  <!-- 熱い分子（赤い円） -->",
				"  <circle cx='80' cy='120' r='12' fill='#ff6b6b' style='filter:drop-shadow(0 0 4px rgba(255,100,100,0.8))'/>",
				"  <circle cx='150' cy='90' r='12' fill='#ff6b6b' style='filter:drop-shadow(0 0 4px rgba(255,100,100,0.8))'/>",
				"  <circle cx='220' cy='140' r='12' fill='#ff6b6b' style='filter:drop-shadow(0 0 4px rgba(255,100,100,0.8))'/>",
				"  <circle cx='100' cy='200' r='12' fill='#ff6b6b' style='filter:drop-shadow(0 0 4px rgba(255,100,100,0.8))'/>",
				"  <circle cx='240' cy='220' r='12' fill='#ff6b6b' style='filter:drop-shadow(0 0 4px rgba(255,100,100,0.8))'/>",
				"  <text x='165' y='270' text-anchor='middle' fill='#ff6b6b' font-size='12' font-family='sans-serif'>高速分子（高温）</text>",
				"  <!-- 壁と扉 -->",
				"  <rect x='298' y='40' width='4' height='95' fill='#888'/>",
				"  <rect x='298' y='185' width='4' height='95' fill='#888'/>",
				"  <rect x='294' y='135' width='12' height='50' rx='3' fill='#ffd700' style='filter:drop-shadow(0 0 6px rgba(255,215,0,0.8))'/>",
				"  <!-- 悪魔 -->",
				"  <circle cx='300' cy='160' r='20' fill='#9b59b6' style='filter:drop-shadow(0 0 8px rgba(155,89,182,0.8))'/>",
				"  <text x='300' y='165' text-anchor='middle' fill='white' font-size='16' font-family='sans-serif'>👁</text>",
				"  <text x='300' y='220' text-anchor='middle' fill='#9b59b6' font-size='11' font-family='sans-serif'>悪魔</text>",
				"  <!-- 右の部屋（冷たい分子） -->",
				"  <rect x='400' y='40' width='270' height='240' rx='8' fill='#1a2a3a' stroke='#64b5f6' stroke-width='2'/>",
				"  <text x='535' y='30' text-anchor='middle' fill='#64b5f6' font-size='14' font-family='sans-serif'>室 B（冷たい）</text>",
				"  <!-- 冷たい分子（青い円） -->",
				"  <circle cx='450' cy='110' r='10' fill='#64b5f6'/>",
				"  <circle cx='520' cy='150' r='10' fill='#64b5f6'/>",
				"  <circle cx='600' cy='100' r='10' fill='#64b5f6'/>",
				"  <circle cx='480' cy='210' r='10' fill='#64b5f6'/>",
				"  <circle cx='620' cy='190' r='10' fill='#64b5f6'/>",
				"  <text x='535' y='270' text-anchor='middle' fill='#64b5f6' font-size='12' font-family='sans-serif'>低速分子（低温）</text>",
				"  <!-- 説明テキスト -->",
				"  <text x='350' y='305' text-anchor='middle' fill='#aaa' font-size='11' font-family='sans-serif'>悪魔は速い分子だけを左→右に通す。エネルギーなしで温度差を作れる？</text>",
				"</svg>"
			],
			"speakerNotes": "マクスウェルの悪魔は1867年に提唱された思考実験。悪魔が分子を選別することで熱力学第二法則（エントロピー増大則）を破れるように見える"
		},
		{
			"title": "悪魔のジレンマ：情報を覚えることにコストがかかる",
			"content": [
				"**シラードの解決（1929年）**",
				"",
				"<svg viewBox='0 0 700 280' style='max-height:65vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- ステップ1 -->",
				"  <rect x='20' y='30' width='180' height='120' rx='8' fill='#1a3a1a' stroke='#4caf50' stroke-width='2'/>",
				"  <text x='110' y='55' text-anchor='middle' fill='#4caf50' font-size='13' font-family='sans-serif' font-weight='bold'>① 観測</text>",
				"  <text x='110' y='80' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>分子の速度を測定</text>",
				"  <text x='110' y='100' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>情報をメモリに記録</text>",
				"  <text x='110' y='120' text-anchor='middle' fill='#ffd700' font-size='11' font-family='sans-serif'>→ エントロピー減少</text>",
				"  <text x='110' y='140' text-anchor='middle' fill='#ff9800' font-size='11' font-family='sans-serif'>（一時的に秩序増大）</text>",
				"  <!-- 矢印1 -->",
				"  <line x1='200' y1='90' x2='240' y2='90' stroke='#aaa' stroke-width='2'/>",
				"  <polygon points='240,85 252,90 240,95' fill='#aaa'/>",
				"  <!-- ステップ2 -->",
				"  <rect x='252' y='30' width='180' height='120' rx='8' fill='#3a2a1a' stroke='#ff9800' stroke-width='2'/>",
				"  <text x='342' y='55' text-anchor='middle' fill='#ff9800' font-size='13' font-family='sans-serif' font-weight='bold'>② 扉の制御</text>",
				"  <text x='342' y='80' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>記録した情報を使い</text>",
				"  <text x='342' y='100' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>扉を開閉する</text>",
				"  <text x='342' y='120' text-anchor='middle' fill='#ffd700' font-size='11' font-family='sans-serif'>→ 仕事を取り出す</text>",
				"  <text x='342' y='140' text-anchor='middle' fill='#ff9800' font-size='11' font-family='sans-serif'>（見かけ上無償）</text>",
				"  <!-- 矢印2 -->",
				"  <line x1='432' y1='90' x2='472' y2='90' stroke='#aaa' stroke-width='2'/>",
				"  <polygon points='472,85 484,90 472,95' fill='#aaa'/>",
				"  <!-- ステップ3 -->",
				"  <rect x='484' y='30' width='196' height='120' rx='8' fill='#3a1a1a' stroke='#f44336' stroke-width='2'/>",
				"  <text x='582' y='55' text-anchor='middle' fill='#f44336' font-size='13' font-family='sans-serif' font-weight='bold'>③ メモリ消去</text>",
				"  <text x='582' y='80' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>記録を消すときに</text>",
				"  <text x='582' y='100' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>熱を放出（必須！）</text>",
				"  <text x='582' y='120' text-anchor='middle' fill='#ffd700' font-size='11' font-family='sans-serif'>→ エントロピー増大</text>",
				"  <text x='582' y='140' text-anchor='middle' fill='#f44336' font-size='11' font-family='sans-serif'>（法則は守られる）</text>",
				"  <!-- 結論 -->",
				"  <rect x='100' y='185' width='500' height='70' rx='8' fill='#1a1a3a' stroke='#7986cb' stroke-width='2'/>",
				"  <text x='350' y='210' text-anchor='middle' fill='#7986cb' font-size='14' font-family='sans-serif' font-weight='bold'>シラードの結論</text>",
				"  <text x='350' y='235' text-anchor='middle' fill='#ccc' font-size='12' font-family='sans-serif'>「情報を消去するときに必ずエネルギーコストが発生する」</text>",
				"  <text x='350' y='250' text-anchor='middle' fill='#aaa' font-size='11' font-family='sans-serif'>観測（情報取得）ではなく、忘却（情報消去）がエントロピー増大の源</text>",
				"</svg>"
			],
			"speakerNotes": "1929年、レオ・シラードが悪魔のパラドックスを解決。観測自体ではなく、メモリを消去する際に熱が放出され熱力学第二法則が保たれる"
		},
		{
			"title": "情報は物理量だ：ランダウアー原理",
			"content": [
				"<svg viewBox='0 0 700 320' style='max-height:68vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- タイトルバー -->",
				"  <rect x='0' y='0' width='700' height='40' rx='4' fill='#1a1a3a'/>",
				"  <text x='350' y='26' text-anchor='middle' fill='#7986cb' font-size='15' font-family='sans-serif' font-weight='bold'>ランダウアー原理（1961年）</text>",
				"  <!-- 数式ボックス -->",
				"  <rect x='180' y='55' width='340' height='60' rx='8' fill='#0d1117' stroke='#ffd700' stroke-width='2'/>",
				"  <text x='350' y='80' text-anchor='middle' fill='#ffd700' font-size='18' font-family='sans-serif' font-weight='bold'>E ≥ k_B × T × ln(2)</text>",
				"  <text x='350' y='103' text-anchor='middle' fill='#aaa' font-size='11' font-family='sans-serif'>1ビット消去あたりの最小エネルギーコスト</text>",
				"  <!-- 凡例 -->",
				"  <text x='50' y='145' fill='#4caf50' font-size='12' font-family='sans-serif'>k_B = ボルツマン定数 (1.38×10⁻²³ J/K)</text>",
				"  <text x='50' y='165' fill='#64b5f6' font-size='12' font-family='sans-serif'>T   = 温度（ケルビン）</text>",
				"  <text x='50' y='185' fill='#ff9800' font-size='12' font-family='sans-serif'>ln2 ≈ 0.693</text>",
				"  <!-- 現代への影響 -->",
				"  <rect x='30' y='205' width='300' height='100' rx='8' fill='#1a3a1a' stroke='#4caf50' stroke-width='1.5'/>",
				"  <text x='180' y='228' text-anchor='middle' fill='#4caf50' font-size='13' font-family='sans-serif' font-weight='bold'>物理的意味</text>",
				"  <text x='180' y='250' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>室温(300K)で約3×10⁻²¹ J/bit</text>",
				"  <text x='180' y='270' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>現代CPUはこの限界の</text>",
				"  <text x='180' y='290' text-anchor='middle' fill='#ffd700' font-size='12' font-family='sans-serif'>約1000倍のエネルギーを消費</text>",
				"  <rect x='370' y='205' width='300' height='100' rx='8' fill='#1a1a3a' stroke='#7986cb' stroke-width='1.5'/>",
				"  <text x='520' y='228' text-anchor='middle' fill='#7986cb' font-size='13' font-family='sans-serif' font-weight='bold'>情報理論との融合</text>",
				"  <text x='520' y='250' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>情報は「実体」を持つ</text>",
				"  <text x='520' y='270' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>キャッシュの「忘却」も</text>",
				"  <text x='520' y='290' text-anchor='middle' fill='#ffd700' font-size='12' font-family='sans-serif'>物理的コストを払う</text>",
				"</svg>",
				"**キーメッセージ:** ビット情報の消去 = エントロピー生産 = 物理的コスト"
			],
			"speakerNotes": "ランダウアーが1961年に証明。情報消去には物理的エネルギーコストが必ず伴う。これはコンピューティングの根本的限界を示す"
		},
		{
			"title": "キャッシュの本質的困難",
			"layout": "section",
			"content": [
				"なぜキャッシュ無効化は「2大難問」なのか",
				"物理学と情報理論から読み解く"
			]
		},
		{
			"title": "「CSで最も難しい2つの問題」の起源",
			"content": [
				"**Phil Karlton (Netscape) の名言**",
				"",
				"> \"There are only two hard things in Computer Science:",
				"> cache invalidation and naming things.\"",
				"",
				"**なぜキャッシュ無効化が難しいか：3つの根本的理由**",
				"- **時間の非対称性** — データは変わるが、コピーの存在を忘れる",
				"- **分散の不確実性** — どこに何のコピーがあるか把握不能",
				"- **完全性の不可能** — 全コピーを即時更新するコストは無限大",
				"",
				"これはまさに**マクスウェルの悪魔の問題**と同型：",
				"「情報（キャッシュ）を持つことの代償は、その整合性維持コスト」"
			],
			"speakerNotes": "Phil Karltonの名言はその後Tim Petersが拡張した。実際にはキャッシュ無効化は分散システム理論の中核問題"
		},
		{
			"title": "キャッシュ整合性の状態遷移",
			"content": [
				"<svg viewBox='0 0 700 330' style='max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- Fresh状態 -->",
				"  <circle cx='350' cy='80' r='50' fill='#1a3a1a' stroke='#4caf50' stroke-width='3'/>",
				"  <text x='350' y='75' text-anchor='middle' fill='#4caf50' font-size='14' font-family='sans-serif' font-weight='bold'>Fresh</text>",
				"  <text x='350' y='93' text-anchor='middle' fill='#ccc' font-size='10' font-family='sans-serif'>有効な状態</text>",
				"  <!-- Stale状態 -->",
				"  <circle cx='140' cy='230' r='50' fill='#3a3a1a' stroke='#ffd700' stroke-width='3'/>",
				"  <text x='140' y='225' text-anchor='middle' fill='#ffd700' font-size='14' font-family='sans-serif' font-weight='bold'>Stale</text>",
				"  <text x='140' y='243' text-anchor='middle' fill='#ccc' font-size='10' font-family='sans-serif'>期限切れ</text>",
				"  <!-- Updating状態 -->",
				"  <circle cx='560' cy='230' r='50' fill='#1a2a3a' stroke='#64b5f6' stroke-width='3'/>",
				"  <text x='560' y='225' text-anchor='middle' fill='#64b5f6' font-size='14' font-family='sans-serif' font-weight='bold'>Updating</text>",
				"  <text x='560' y='243' text-anchor='middle' fill='#ccc' font-size='10' font-family='sans-serif'>更新中</text>",
				"  <!-- Invalid状態 -->",
				"  <circle cx='350' cy='290' r='40' fill='#3a1a1a' stroke='#f44336' stroke-width='3'/>",
				"  <text x='350' y='286' text-anchor='middle' fill='#f44336' font-size='13' font-family='sans-serif' font-weight='bold'>Invalid</text>",
				"  <text x='350' y='303' text-anchor='middle' fill='#ccc' font-size='10' font-family='sans-serif'>無効</text>",
				"  <!-- 矢印: Fresh → Stale (TTL期限) -->",
				"  <line x1='305' y1='115' x2='180' y2='188' stroke='#ffd700' stroke-width='2'/>",
				"  <polygon points='178,190 170,178 182,180' fill='#ffd700'/>",
				"  <text x='220' y='145' fill='#ffd700' font-size='10' font-family='sans-serif'>TTL期限</text>",
				"  <!-- 矢印: Fresh → Updating (変更検知) -->",
				"  <line x1='395' y1='115' x2='518' y2='188' stroke='#64b5f6' stroke-width='2'/>",
				"  <polygon points='520,190 516,177 524,180' fill='#64b5f6'/>",
				"  <text x='468' y='145' fill='#64b5f6' font-size='10' font-family='sans-serif'>変更検知</text>",
				"  <!-- 矢印: Stale → Invalid (強制無効化) -->",
				"  <line x1='175' y1='265' x2='308' y2='290' stroke='#f44336' stroke-width='2'/>",
				"  <polygon points='310,292 300,284 302,294' fill='#f44336'/>",
				"  <text x='210' y='290' fill='#f44336' font-size='10' font-family='sans-serif'>強制無効化</text>",
				"  <!-- 矢印: Updating → Fresh (更新完了) -->",
				"  <line x1='535' y1='182' x2='395' y2='118' stroke='#4caf50' stroke-width='2'/>",
				"  <polygon points='393,116 400,128 390,126' fill='#4caf50'/>",
				"  <text x='478' y='163' fill='#4caf50' font-size='10' font-family='sans-serif'>更新完了</text>",
				"  <!-- 矢印: Updating → Invalid (更新失敗) -->",
				"  <line x1='525' y1='265' x2='388' y2='290' stroke='#f44336' stroke-width='2'/>",
				"  <polygon points='386,292 393,281 394,292' fill='#f44336'/>",
				"  <text x='450' y='295' fill='#f44336' font-size='10' font-family='sans-serif'>更新失敗</text>",
				"  <!-- 矢印: Invalid → Fresh (再取得) -->",
				"  <line x1='350' y1='250' x2='350' y2='132' stroke='#4caf50' stroke-width='2' stroke-dasharray='6,3'/>",
				"  <polygon points='345,130 350,118 355,130' fill='#4caf50'/>",
				"  <text x='358' y='200' fill='#4caf50' font-size='10' font-family='sans-serif'>再取得</text>",
				"</svg>"
			],
			"speakerNotes": "キャッシュには4つの主要状態がある。状態遷移の複雑さが分散環境での整合性問題の核心"
		},
		{
			"title": "分散キャッシュの矛盾：CAPとの衝突",
			"content": [
				"<svg viewBox='0 0 700 320' style='max-height:68vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- 三角形の頂点 -->",
				"  <!-- C: 一貫性 (上) -->",
				"  <polygon points='350,30 300,120 400,120' fill='#1a1a3a' stroke='#7986cb' stroke-width='2'/>",
				"  <circle cx='350' cy='40' r='45' fill='#1a1a3a' stroke='#7986cb' stroke-width='3'/>",
				"  <text x='350' y='35' text-anchor='middle' fill='#7986cb' font-size='14' font-family='sans-serif' font-weight='bold'>C</text>",
				"  <text x='350' y='53' text-anchor='middle' fill='#7986cb' font-size='11' font-family='sans-serif'>一貫性</text>",
				"  <text x='350' y='68' text-anchor='middle' fill='#aaa' font-size='9' font-family='sans-serif'>Consistency</text>",
				"  <!-- A: 可用性 (左下) -->",
				"  <circle cx='150' cy='250' r='45' fill='#1a3a1a' stroke='#4caf50' stroke-width='3'/>",
				"  <text x='150' y='245' text-anchor='middle' fill='#4caf50' font-size='14' font-family='sans-serif' font-weight='bold'>A</text>",
				"  <text x='150' y='263' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif'>可用性</text>",
				"  <text x='150' y='278' text-anchor='middle' fill='#aaa' font-size='9' font-family='sans-serif'>Availability</text>",
				"  <!-- P: 分断耐性 (右下) -->",
				"  <circle cx='550' cy='250' r='45' fill='#3a1a1a' stroke='#f44336' stroke-width='3'/>",
				"  <text x='550' y='245' text-anchor='middle' fill='#f44336' font-size='14' font-family='sans-serif' font-weight='bold'>P</text>",
				"  <text x='550' y='263' text-anchor='middle' fill='#f44336' font-size='11' font-family='sans-serif'>分断耐性</text>",
				"  <text x='550' y='278' text-anchor='middle' fill='#aaa' font-size='9' font-family='sans-serif'>Partition Tolerance</text>",
				"  <!-- 三角形の辺 -->",
				"  <line x1='350' y1='85' x2='195' y2='210' stroke='#555' stroke-width='2'/>",
				"  <line x1='350' y1='85' x2='505' y2='210' stroke='#555' stroke-width='2'/>",
				"  <line x1='195' y1='250' x2='505' y2='250' stroke='#555' stroke-width='2'/>",
				"  <!-- キャッシュの位置マーカー -->",
				"  <circle cx='350' cy='185' r='15' fill='#ffd700' style='filter:drop-shadow(0 0 8px rgba(255,215,0,0.8))'/>",
				"  <text x='350' y='190' text-anchor='middle' fill='#000' font-size='10' font-family='sans-serif' font-weight='bold'>$</text>",
				"  <!-- 説明 -->",
				"  <text x='350' y='308' text-anchor='middle' fill='#ffd700' font-size='12' font-family='sans-serif'>キャッシュは常に「C vs A」のトレードオフの中心にいる</text>",
				"  <!-- ラベル -->",
				"  <text x='220' y='160' fill='#aaa' font-size='10' font-family='sans-serif' transform='rotate(-45,220,160)'>C+A: 強整合性</text>",
				"  <text x='480' y='160' fill='#aaa' font-size='10' font-family='sans-serif' transform='rotate(45,480,160)'>C+P: 強一貫性</text>",
				"  <text x='350' y='270' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>A+P: 最終的整合性</text>",
				"</svg>"
			],
			"speakerNotes": "CAPの定理はキャッシュ設計に直接影響する。一貫性と可用性はトレードオフであり、キャッシュはその狭間に存在する"
		},
		{
			"title": "悪魔とキャッシュの対応関係",
			"content": [
				"<svg viewBox='0 0 700 310' style='max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- ヘッダー -->",
				"  <rect x='0' y='0' width='340' height='35' rx='4' fill='#3a1a5a'/>",
				"  <text x='170' y='23' text-anchor='middle' fill='#ce93d8' font-size='14' font-family='sans-serif' font-weight='bold'>マクスウェルの悪魔</text>",
				"  <rect x='360' y='0' width='340' height='35' rx='4' fill='#1a3a5a'/>",
				"  <text x='530' y='23' text-anchor='middle' fill='#64b5f6' font-size='14' font-family='sans-serif' font-weight='bold'>キャッシュシステム</text>",
				"  <!-- 行1 -->",
				"  <rect x='0' y='45' width='340' height='50' rx='4' fill='#1a1a2a' stroke='#444' stroke-width='1'/>",
				"  <text x='170' y='65' text-anchor='middle' fill='#ce93d8' font-size='12' font-family='sans-serif'>分子の状態（速い/遅い）を観測</text>",
				"  <text x='170' y='84' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>観測 = 情報の取得</text>",
				"  <rect x='360' y='45' width='340' height='50' rx='4' fill='#1a1a2a' stroke='#444' stroke-width='1'/>",
				"  <text x='530' y='65' text-anchor='middle' fill='#64b5f6' font-size='12' font-family='sans-serif'>オリジンからデータを取得</text>",
				"  <text x='530' y='84' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>Cache-Miss = 最新情報の取得</text>",
				"  <text x='350' y='73' text-anchor='middle' fill='#ffd700' font-size='18' font-family='sans-serif'>≡</text>",
				"  <!-- 行2 -->",
				"  <rect x='0' y='105' width='340' height='50' rx='4' fill='#1a1a2a' stroke='#444' stroke-width='1'/>",
				"  <text x='170' y='125' text-anchor='middle' fill='#ce93d8' font-size='12' font-family='sans-serif'>悪魔のメモリに状態を記録</text>",
				"  <text x='170' y='144' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>情報を保持 = エントロピー減少</text>",
				"  <rect x='360' y='105' width='340' height='50' rx='4' fill='#1a1a2a' stroke='#444' stroke-width='1'/>",
				"  <text x='530' y='125' text-anchor='middle' fill='#64b5f6' font-size='12' font-family='sans-serif'>キャッシュにデータを保存</text>",
				"  <text x='530' y='144' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>Cache-Hit = 高速応答の恩恵</text>",
				"  <text x='350' y='133' text-anchor='middle' fill='#ffd700' font-size='18' font-family='sans-serif'>≡</text>",
				"  <!-- 行3 -->",
				"  <rect x='0' y='165' width='340' height='50' rx='4' fill='#1a1a2a' stroke='#444' stroke-width='1'/>",
				"  <text x='170' y='185' text-anchor='middle' fill='#ce93d8' font-size='12' font-family='sans-serif'>メモリの消去 = 熱の放出</text>",
				"  <text x='170' y='204' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>忘却のコスト（ランダウアー原理）</text>",
				"  <rect x='360' y='165' width='340' height='50' rx='4' fill='#1a1a2a' stroke='#444' stroke-width='1'/>",
				"  <text x='530' y='185' text-anchor='middle' fill='#64b5f6' font-size='12' font-family='sans-serif'>キャッシュの無効化</text>",
				"  <text x='530' y='204' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>Eviction = 計算・通信コスト</text>",
				"  <text x='350' y='193' text-anchor='middle' fill='#ffd700' font-size='18' font-family='sans-serif'>≡</text>",
				"  <!-- 行4: 根本的矛盾 -->",
				"  <rect x='0' y='225' width='700' height='70' rx='8' fill='#2a1a0a' stroke='#ff9800' stroke-width='2'/>",
				"  <text x='350' y='250' text-anchor='middle' fill='#ff9800' font-size='14' font-family='sans-serif' font-weight='bold'>根本的矛盾（どちらも同じ問題）</text>",
				"  <text x='350' y='272' text-anchor='middle' fill='#ccc' font-size='12' font-family='sans-serif'>「情報を保持するコスト」と「情報の鮮度を保つコスト」は両立しない</text>",
				"  <text x='350' y='288' text-anchor='middle' fill='#aaa' font-size='11' font-family='sans-serif'>これは物理法則ではなく情報理論の根本問題 → 完全な解決策は存在しない</text>",
				"</svg>"
			],
			"speakerNotes": "マクスウェルの悪魔とキャッシュシステムの対応関係を見ると、両者が同じ情報理論的問題を共有していることがわかる"
		},
		{
			"title": "現代のキャッシュ戦略",
			"layout": "section",
			"content": [
				"悪魔を飼い慣らす実践的アプローチ",
				"HTTP キャッシュ / CDN / エッジキャッシュ"
			]
		},
		{
			"title": "Cache-Control ヘッダー徹底解説",
			"content": [
				"**HTTPキャッシュの制御メカニズム**",
				"- `max-age=N` — N秒間は再検証不要（鮮度の明示）",
				"- `stale-while-revalidate=N` — 古くても使い、バックグラウンドで更新",
				"- `immutable` — ハッシュURLは永遠に変わらない宣言"
			],
			"code": "# 静的アセット（コンテントハッシュ付き）\nCache-Control: public, max-age=31536000, immutable\n# → 1年間キャッシュ、変更時はURL自体を変える\n\n# APIレスポンス（動的コンテンツ）\nCache-Control: private, max-age=0, must-revalidate\n# → ブラウザキャッシュのみ、毎回検証\n\n# CDNフレンドリー（stale-while-revalidate）\nCache-Control: public, max-age=60, stale-while-revalidate=3600\n# → 60秒Fresh、以降はStaleで応答しつつ更新\n\n# CDN専用（s-maxage）\nCache-Control: public, s-maxage=86400, max-age=300\n# → CDN: 24時間, ブラウザ: 5分",
			"codeLanguage": "http",
			"speakerNotes": "Cache-Controlはキャッシュの振る舞いを細かく制御できる。stale-while-revalidateはマクスウェルの悪魔の「古い情報を使いながら更新」戦略に対応"
		},
		{
			"title": "ETagsと条件付きリクエスト：賢い検証メカニズム",
			"content": [
				"<svg viewBox='0 0 700 310' style='max-height:68vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- クライアント -->",
				"  <rect x='20' y='20' width='120' height='40' rx='6' fill='#1a3a1a' stroke='#4caf50' stroke-width='2'/>",
				"  <text x='80' y='43' text-anchor='middle' fill='#4caf50' font-size='12' font-family='sans-serif' font-weight='bold'>クライアント</text>",
				"  <!-- サーバー -->",
				"  <rect x='560' y='20' width='120' height='40' rx='6' fill='#1a1a3a' stroke='#7986cb' stroke-width='2'/>",
				"  <text x='620' y='43' text-anchor='middle' fill='#7986cb' font-size='12' font-family='sans-serif' font-weight='bold'>サーバー</text>",
				"  <!-- ライフライン -->",
				"  <line x1='80' y1='60' x2='80' y2='300' stroke='#4caf50' stroke-width='1' stroke-dasharray='4,4'/>",
				"  <line x1='620' y1='60' x2='620' y2='300' stroke='#7986cb' stroke-width='1' stroke-dasharray='4,4'/>",
				"  <!-- ステップ1: 初回リクエスト -->",
				"  <line x1='80' y1='90' x2='600' y2='90' stroke='#ccc' stroke-width='2'/>",
				"  <polygon points='600,85 615,90 600,95' fill='#ccc'/>",
				"  <text x='340' y='83' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>① GET /api/data</text>",
				"  <!-- ステップ2: レスポンス+ETag -->",
				"  <line x1='620' y1='120' x2='100' y2='120' stroke='#7986cb' stroke-width='2'/>",
				"  <polygon points='100,115 85,120 100,125' fill='#7986cb'/>",
				"  <text x='340' y='113' text-anchor='middle' fill='#7986cb' font-size='11' font-family='sans-serif'>② 200 OK + ETag: \"abc123\" + データ本体</text>",
				"  <!-- キャッシュ保存 -->",
				"  <rect x='20' y='135' width='120' height='30' rx='4' fill='#0d2a0d' stroke='#4caf50' stroke-width='1'/>",
				"  <text x='80' y='154' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>ETag保存 + キャッシュ</text>",
				"  <!-- ステップ3: 条件付きリクエスト -->",
				"  <line x1='80' y1='185' x2='600' y2='185' stroke='#ffd700' stroke-width='2'/>",
				"  <polygon points='600,180 615,185 600,190' fill='#ffd700'/>",
				"  <text x='340' y='178' text-anchor='middle' fill='#ffd700' font-size='11' font-family='sans-serif'>③ GET /api/data  If-None-Match: \"abc123\"</text>",
				"  <!-- ステップ4a: 未変更の場合 -->",
				"  <line x1='620' y1='215' x2='100' y2='215' stroke='#4caf50' stroke-width='2'/>",
				"  <polygon points='100,210 85,215 100,220' fill='#4caf50'/>",
				"  <text x='340' y='208' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif'>④a 304 Not Modified（ボディなし、転送量ゼロ）</text>",
				"  <!-- ステップ4b: 変更あり -->",
				"  <line x1='620' y1='248' x2='100' y2='248' stroke='#f44336' stroke-width='2' stroke-dasharray='6,3'/>",
				"  <polygon points='100,243 85,248 100,253' fill='#f44336'/>",
				"  <text x='340' y='241' text-anchor='middle' fill='#f44336' font-size='11' font-family='sans-serif'>④b 200 OK + ETag: \"xyz789\" + 新データ本体</text>",
				"  <!-- 凡例 -->",
				"  <rect x='0' y='265' width='700' height='35' rx='4' fill='#1a1a1a'/>",
				"  <text x='350' y='287' text-anchor='middle' fill='#aaa' font-size='11' font-family='sans-serif'>ETagは「情報の同一性証明」= 悪魔の観測メカニズムをHTTPで実装</text>",
				"</svg>"
			],
			"speakerNotes": "ETagは条件付きリクエストを実現する。変更がなければ304で帯域を節約し、変更があれば新しいデータを取得する。これはマクスウェルの悪魔が「変化した分子だけ」を通す仕組みと対応"
		},
		{
			"title": "CDNとエッジキャッシュ：地理的分散の挑戦",
			"content": [
				"<svg viewBox='0 0 700 300' style='max-height:68vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- オリジンサーバー（中央） -->",
				"  <circle cx='350' cy='150' r='40' fill='#1a1a3a' stroke='#7986cb' stroke-width='3'/>",
				"  <text x='350' y='145' text-anchor='middle' fill='#7986cb' font-size='12' font-family='sans-serif' font-weight='bold'>Origin</text>",
				"  <text x='350' y='162' text-anchor='middle' fill='#7986cb' font-size='10' font-family='sans-serif'>Server</text>",
				"  <!-- エッジノード（東京） -->",
				"  <circle cx='100' cy='80' r='32' fill='#1a3a1a' stroke='#4caf50' stroke-width='2'/>",
				"  <text x='100' y='76' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif' font-weight='bold'>Edge</text>",
				"  <text x='100' y='92' text-anchor='middle' fill='#4caf50' font-size='9' font-family='sans-serif'>Tokyo</text>",
				"  <!-- エッジノード（NY） -->",
				"  <circle cx='600' cy='80' r='32' fill='#1a3a1a' stroke='#4caf50' stroke-width='2'/>",
				"  <text x='600' y='76' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif' font-weight='bold'>Edge</text>",
				"  <text x='600' y='92' text-anchor='middle' fill='#4caf50' font-size='9' font-family='sans-serif'>New York</text>",
				"  <!-- エッジノード（ロンドン） -->",
				"  <circle cx='100' cy='230' r='32' fill='#1a3a1a' stroke='#4caf50' stroke-width='2'/>",
				"  <text x='100' y='226' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif' font-weight='bold'>Edge</text>",
				"  <text x='100' y='242' text-anchor='middle' fill='#4caf50' font-size='9' font-family='sans-serif'>London</text>",
				"  <!-- エッジノード（シドニー） -->",
				"  <circle cx='600' cy='230' r='32' fill='#1a3a1a' stroke='#4caf50' stroke-width='2'/>",
				"  <text x='600' y='226' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif' font-weight='bold'>Edge</text>",
				"  <text x='600' y='242' text-anchor='middle' fill='#4caf50' font-size='9' font-family='sans-serif'>Sydney</text>",
				"  <!-- 接続線 -->",
				"  <line x1='310' y1='130' x2='132' y2='98' stroke='#555' stroke-width='2'/>",
				"  <line x1='390' y1='130' x2='568' y2='98' stroke='#555' stroke-width='2'/>",
				"  <line x1='310' y1='168' x2='132' y2='212' stroke='#555' stroke-width='2'/>",
				"  <line x1='390' y1='168' x2='568' y2='212' stroke='#555' stroke-width='2'/>",
				"  <!-- パージ問題の表示 -->",
				"  <rect x='220' y='200' width='260' height='50' rx='6' fill='#2a1a0a' stroke='#ff9800' stroke-width='2'/>",
				"  <text x='350' y='220' text-anchor='middle' fill='#ff9800' font-size='12' font-family='sans-serif' font-weight='bold'>Cache Purge の課題</text>",
				"  <text x='350' y='240' text-anchor='middle' fill='#ccc' font-size='10' font-family='sans-serif'>全エッジに伝播するまでタイムラグあり</text>",
				"  <!-- ユーザー（ミニ） -->",
				"  <circle cx='30' cy='60' r='12' fill='#555' stroke='#aaa' stroke-width='1'/>",
				"  <text x='30' y='64' text-anchor='middle' fill='#aaa' font-size='9' font-family='sans-serif'>U</text>",
				"  <line x1='42' y1='65' x2='68' y2='77' stroke='#aaa' stroke-width='1' stroke-dasharray='3,2'/>",
				"  <circle cx='668' cy='60' r='12' fill='#555' stroke='#aaa' stroke-width='1'/>",
				"  <text x='668' y='64' text-anchor='middle' fill='#aaa' font-size='9' font-family='sans-serif'>U</text>",
				"  <line x1='656' y1='65' x2='632' y2='77' stroke='#aaa' stroke-width='1' stroke-dasharray='3,2'/>",
				"</svg>",
				"- **Cache Purge** — オリジン変更を全エッジに即時伝播（コストが高い）",
				"- **Surrogate-Key** — タグベースで関連キャッシュを一括無効化"
			],
			"speakerNotes": "CDNはキャッシュの地理的分散。エッジが多いほど無効化の伝播が困難になる。これはマクスウェルの悪魔の問題がスケールする版"
		},
		{
			"title": "キャッシュバスティング戦略：コンテントハッシュ",
			"content": [
				"<svg viewBox='0 0 700 280' style='max-height:65vh;width:auto;display:block;margin:0 auto;letter-spacing:0' xmlns='http://www.w3.org/2000/svg'>",
				"  <!-- 従来の問題 -->",
				"  <rect x='10' y='10' width='320' height='120' rx='8' fill='#3a1a1a' stroke='#f44336' stroke-width='2'/>",
				"  <text x='170' y='35' text-anchor='middle' fill='#f44336' font-size='13' font-family='sans-serif' font-weight='bold'>従来の方法（問題あり）</text>",
				"  <text x='170' y='58' text-anchor='middle' fill='#ccc' font-size='11' font-family='sans-serif'>/static/app.js</text>",
				"  <text x='170' y='78' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>→ ブラウザがキャッシュ。更新しても</text>",
				"  <text x='170' y='94' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>古いファイルが使われ続ける</text>",
				"  <text x='170' y='113' text-anchor='middle' fill='#f44336' font-size='11' font-family='sans-serif'>手動で「Ctrl+F5」を要求…</text>",
				"  <!-- 解決策 -->",
				"  <rect x='370' y='10' width='320' height='120' rx='8' fill='#1a3a1a' stroke='#4caf50' stroke-width='2'/>",
				"  <text x='530' y='35' text-anchor='middle' fill='#4caf50' font-size='13' font-family='sans-serif' font-weight='bold'>コンテントハッシュ（解決策）</text>",
				"  <text x='530' y='58' text-anchor='middle' fill='#ffd700' font-size='11' font-family='sans-serif'>/static/app.a3f2c1d9.js</text>",
				"  <text x='530' y='78' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>→ URLが変わる = 新しいリソース</text>",
				"  <text x='530' y='94' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>旧URLは永遠にキャッシュ可能</text>",
				"  <text x='530' y='113' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif'>Cache-Control: immutable  OK</text>",
				"  <!-- ビルドパイプライン -->",
				"  <rect x='10' y='150' width='680' height='110' rx='8' fill='#1a1a2a' stroke='#7986cb' stroke-width='2'/>",
				"  <text x='350' y='172' text-anchor='middle' fill='#7986cb' font-size='13' font-family='sans-serif' font-weight='bold'>ビルドパイプラインによる自動化</text>",
				"  <!-- フロー -->",
				"  <rect x='30' y='185' width='110' height='60' rx='4' fill='#1a2a3a' stroke='#64b5f6' stroke-width='1'/>",
				"  <text x='85' y='210' text-anchor='middle' fill='#64b5f6' font-size='11' font-family='sans-serif'>ソース</text>",
				"  <text x='85' y='228' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>app.js</text>",
				"  <line x1='140' y1='215' x2='168' y2='215' stroke='#aaa' stroke-width='2'/>",
				"  <polygon points='168,210 180,215 168,220' fill='#aaa'/>",
				"  <rect x='180' y='185' width='110' height='60' rx='4' fill='#1a2a3a' stroke='#64b5f6' stroke-width='1'/>",
				"  <text x='235' y='210' text-anchor='middle' fill='#64b5f6' font-size='11' font-family='sans-serif'>ハッシュ計算</text>",
				"  <text x='235' y='228' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>SHA256(content)</text>",
				"  <line x1='290' y1='215' x2='318' y2='215' stroke='#aaa' stroke-width='2'/>",
				"  <polygon points='318,210 330,215 318,220' fill='#aaa'/>",
				"  <rect x='330' y='185' width='130' height='60' rx='4' fill='#1a2a3a' stroke='#64b5f6' stroke-width='1'/>",
				"  <text x='395' y='210' text-anchor='middle' fill='#64b5f6' font-size='11' font-family='sans-serif'>リネーム</text>",
				"  <text x='395' y='228' text-anchor='middle' fill='#ffd700' font-size='10' font-family='sans-serif'>app.a3f2c1d9.js</text>",
				"  <line x1='460' y1='215' x2='488' y2='215' stroke='#aaa' stroke-width='2'/>",
				"  <polygon points='488,210 500,215 488,220' fill='#aaa'/>",
				"  <rect x='500' y='185' width='160' height='60' rx='4' fill='#1a3a1a' stroke='#4caf50' stroke-width='1'/>",
				"  <text x='580' y='210' text-anchor='middle' fill='#4caf50' font-size='11' font-family='sans-serif'>マニフェスト更新</text>",
				"  <text x='580' y='228' text-anchor='middle' fill='#aaa' font-size='10' font-family='sans-serif'>asset-manifest.json</text>",
				"</svg>"
			],
			"speakerNotes": "コンテントハッシュはキャッシュ無効化の根本的解決策の一つ。URLが変わることで新旧を明確に区別できる"
		},
		{
			"title": "まとめ：悪魔を飼い慣らす設計哲学",
			"layout": "center",
			"content": [
				"**情報理論が教える4つの設計原則**",
				"",
				"1. **明示的な有効期限** — TTLで「忘却のスケジュール」を決める",
				"2. **不変性の活用** — コンテントハッシュで「変化を排除」する",
				"3. **検証の最小化** — ETagで「変化したものだけ」を更新する",
				"4. **トレードオフの受容** — 一貫性か可用性か、意図的に選ぶ",
				"",
				"> キャッシュの無効化が難しいのは実装の問題ではなく、",
				"> **情報の物理的性質**に由来する根本的困難である",
				"",
				"マクスウェルの悪魔は155年前から答えを知っていた：",
				"**「忘却にはコストがかかる」**"
			],
			"speakerNotes": "キャッシュ無効化の困難さは情報理論の根本に由来する。完全な解決はないが、設計原則によりトレードオフを管理できる"
		},
		{
			"title": "参考文献",
			"content": [
				"**物理学・情報理論:**",
				"- [Maxwell's Demon (1867) - Wikipedia](https://en.wikipedia.org/wiki/Maxwell%27s_demon)",
				"- [Landauer's Principle - IBM Research (1961)](https://en.wikipedia.org/wiki/Landauer%27s_principle)",
				"- [Szilard Engine - Physical Review (1929)](https://en.wikipedia.org/wiki/Szil%C3%A1rd_engine)",
				"",
				"**キャッシュ理論・実装:**",
				"- [HTTP Caching - MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching)",
				"- [CAP Theorem - Brewer (2000)](https://en.wikipedia.org/wiki/CAP_theorem)",
				"- [Cache-Control - RFC 7234](https://www.rfc-editor.org/rfc/rfc7234)",
				"",
				"**設計パターン:**",
				"- [Surrogate Keys in CDN Caching - Fastly](https://www.fastly.com/blog/surrogate-keys-part-1)",
				"- [stale-while-revalidate - RFC 5861](https://www.rfc-editor.org/rfc/rfc5861)"
			],
			"speakerNotes": "参考文献一覧"
		}
	]
}
