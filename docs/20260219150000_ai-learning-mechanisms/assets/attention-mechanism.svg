<svg viewBox="0 0 840 360" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0;font-family:sans-serif">
  <!-- Title -->
  <text x="420" y="22" text-anchor="middle" font-size="15" font-weight="bold" fill="#333">Scaled Dot-Product Attention</text>
  <text x="420" y="40" text-anchor="middle" font-size="12" fill="#666">Attention(Q,K,V) = softmax(QKᵀ / √d_k) · V</text>

  <!-- Input embeddings X -->
  <rect x="30" y="80" width="80" height="200" rx="8" fill="#e8eaf6" stroke="#3949ab" stroke-width="2"/>
  <text x="70" y="175" text-anchor="middle" font-size="14" font-weight="bold" fill="#283593">X</text>
  <text x="70" y="195" text-anchor="middle" font-size="11" fill="#555">入力</text>
  <text x="70" y="210" text-anchor="middle" font-size="11" fill="#555">埋め込み</text>

  <!-- W_Q, W_K, W_V projection arrows -->
  <line x1="110" y1="135" x2="175" y2="115" stroke="#1976d2" stroke-width="2"/>
  <polygon points="172,108 183,115 173,122" fill="#1976d2"/>
  <text x="140" y="118" font-size="11" fill="#1976d2">W_Q</text>
  <line x1="110" y1="180" x2="175" y2="180" stroke="#7b1fa2" stroke-width="2"/>
  <polygon points="172,174 183,180 172,186" fill="#7b1fa2"/>
  <text x="135" y="175" font-size="11" fill="#7b1fa2">W_K</text>
  <line x1="110" y1="225" x2="175" y2="250" stroke="#388e3c" stroke-width="2"/>
  <polygon points="172,243 183,250 173,257" fill="#388e3c"/>
  <text x="140" y="255" font-size="11" fill="#388e3c">W_V</text>

  <!-- Q matrix -->
  <rect x="180" y="90" width="70" height="60" rx="8" fill="#bbdefb" stroke="#1976d2" stroke-width="2"/>
  <text x="215" y="124" text-anchor="middle" font-size="18" font-weight="bold" fill="#1565c0">Q</text>
  <!-- K matrix -->
  <rect x="180" y="155" width="70" height="60" rx="8" fill="#e1bee7" stroke="#7b1fa2" stroke-width="2"/>
  <text x="215" y="189" text-anchor="middle" font-size="18" font-weight="bold" fill="#4a148c">K</text>
  <!-- V matrix -->
  <rect x="180" y="225" width="70" height="60" rx="8" fill="#c8e6c9" stroke="#388e3c" stroke-width="2"/>
  <text x="215" y="259" text-anchor="middle" font-size="18" font-weight="bold" fill="#1b5e20">V</text>

  <!-- QK^T dot product -->
  <line x1="250" y1="120" x2="330" y2="165" stroke="#1976d2" stroke-width="2"/>
  <polygon points="326,159 337,165 327,172" fill="#1976d2"/>
  <line x1="250" y1="185" x2="330" y2="175" stroke="#7b1fa2" stroke-width="2"/>
  <polygon points="327,168 338,175 327,181" fill="#7b1fa2"/>

  <!-- MatMul QK node -->
  <rect x="335" y="150" width="90" height="45" rx="8" fill="#fff3e0" stroke="#f57c00" stroke-width="2"/>
  <text x="380" y="170" text-anchor="middle" font-size="12" fill="#e65100">MatMul</text>
  <text x="380" y="185" text-anchor="middle" font-size="11" fill="#e65100">QKᵀ</text>

  <!-- Scale -->
  <line x1="425" y1="172" x2="490" y2="172" stroke="#f57c00" stroke-width="2"/>
  <polygon points="487,166 498,172 487,178" fill="#f57c00"/>
  <rect x="495" y="150" width="90" height="45" rx="8" fill="#fff9c4" stroke="#f9a825" stroke-width="2"/>
  <text x="540" y="170" text-anchor="middle" font-size="12" fill="#e65100">Scale</text>
  <text x="540" y="185" text-anchor="middle" font-size="11" fill="#e65100">÷ √d_k</text>

  <!-- Softmax -->
  <line x1="585" y1="172" x2="645" y2="172" stroke="#f57c00" stroke-width="2"/>
  <polygon points="642,166 653,172 642,178" fill="#f57c00"/>
  <rect x="650" y="150" width="90" height="45" rx="8" fill="#fce4ec" stroke="#e91e63" stroke-width="2"/>
  <text x="695" y="170" text-anchor="middle" font-size="12" fill="#880e4f">Softmax</text>
  <text x="695" y="185" text-anchor="middle" font-size="11" fill="#880e4f">確率重み</text>

  <!-- Softmax down + V multiply -->
  <line x1="695" y1="195" x2="695" y2="255" stroke="#e91e63" stroke-width="2"/>
  <polygon points="689,252 695,262 701,252" fill="#e91e63"/>
  <!-- V comes in -->
  <line x1="250" y1="255" x2="670" y2="270" stroke="#388e3c" stroke-width="2"/>
  <polygon points="667,264 678,270 668,277" fill="#388e3c"/>

  <!-- MatMul with V -->
  <rect x="665" y="260" width="90" height="45" rx="8" fill="#e8f5e9" stroke="#388e3c" stroke-width="2"/>
  <text x="710" y="280" text-anchor="middle" font-size="12" fill="#1b5e20">MatMul</text>
  <text x="710" y="295" text-anchor="middle" font-size="11" fill="#1b5e20">× V</text>

  <!-- Output arrow -->
  <line x1="755" y1="282" x2="815" y2="282" stroke="#388e3c" stroke-width="2"/>
  <polygon points="812,276 822,282 812,288" fill="#388e3c"/>
  <text x="820" y="286" font-size="13" font-weight="bold" fill="#1b5e20">出力</text>

  <!-- Annotation -->
  <text x="380" y="320" text-anchor="middle" font-size="11" fill="#555">Attention score: 各トークンが他のトークンに注目する重み</text>
  <text x="680" y="320" text-anchor="middle" font-size="11" fill="#555">重み付き加重和 → 文脈表現</text>
</svg>
