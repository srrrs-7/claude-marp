<svg viewBox="0 0 820 360" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0;font-family:sans-serif">
  <!-- Title -->
  <text x="410" y="22" text-anchor="middle" font-size="15" font-weight="bold" fill="#333">誤差逆伝播法 — 計算グラフ</text>

  <!-- Forward pass arrows (blue) -->
  <!-- x → mul node -->
  <line x1="80" y1="105" x2="200" y2="145" stroke="#1976d2" stroke-width="2"/>
  <polygon points="196,138 207,145 198,152" fill="#1976d2"/>
  <!-- w → mul node -->
  <line x1="80" y1="185" x2="200" y2="155" stroke="#1976d2" stroke-width="2"/>
  <polygon points="196,148 207,155 199,162" fill="#1976d2"/>
  <!-- mul → add node -->
  <line x1="255" y1="150" x2="355" y2="150" stroke="#1976d2" stroke-width="2"/>
  <polygon points="352,144 363,150 352,156" fill="#1976d2"/>
  <!-- b → add node -->
  <line x1="320" y1="230" x2="365" y2="165" stroke="#1976d2" stroke-width="2"/>
  <polygon points="360,160 369,168 361,174" fill="#1976d2"/>
  <!-- add → sigma node -->
  <line x1="415" y1="150" x2="500" y2="150" stroke="#1976d2" stroke-width="2"/>
  <polygon points="497,144 508,150 497,156" fill="#1976d2"/>
  <!-- sigma → loss node -->
  <line x1="555" y1="150" x2="640" y2="150" stroke="#1976d2" stroke-width="2"/>
  <polygon points="637,144 648,150 637,156" fill="#1976d2"/>

  <!-- Backward pass arrows (red dashed, go below the forward arrows) -->
  <!-- loss → sigma (backward) -->
  <line x1="640" y1="195" x2="555" y2="195" stroke="#c62828" stroke-width="2" stroke-dasharray="6,3"/>
  <polygon points="558,189 547,195 558,201" fill="#c62828"/>
  <!-- sigma → add (backward) -->
  <line x1="500" y1="195" x2="415" y2="195" stroke="#c62828" stroke-width="2" stroke-dasharray="6,3"/>
  <polygon points="418,189 407,195 418,201" fill="#c62828"/>
  <!-- add → mul (backward) -->
  <line x1="355" y1="195" x2="255" y2="195" stroke="#c62828" stroke-width="2" stroke-dasharray="6,3"/>
  <polygon points="258,189 247,195 258,201" fill="#c62828"/>
  <!-- mul → x (backward ∂L/∂x = w) -->
  <line x1="205" y1="195" x2="95" y2="230" stroke="#c62828" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="98,224 87,230 97,237" fill="#c62828"/>
  <!-- mul → w (backward ∂L/∂w = x) -->
  <line x1="205" y1="195" x2="95" y2="248" stroke="#c62828" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="98,242 87,248 98,254" fill="#c62828"/>

  <!-- Nodes -->
  <!-- x input -->
  <rect x="30" y="85" width="50" height="40" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="55" y="110" text-anchor="middle" font-size="14" fill="#1976d2">x</text>
  <!-- w input -->
  <rect x="30" y="165" width="50" height="40" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="55" y="190" text-anchor="middle" font-size="14" fill="#1976d2">w</text>
  <!-- b input -->
  <rect x="295" y="215" width="50" height="30" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="320" y="235" text-anchor="middle" font-size="14" fill="#1976d2">b</text>
  <!-- mul node -->
  <circle cx="228" cy="150" r="27" fill="#fff3e0" stroke="#f57c00" stroke-width="2"/>
  <text x="228" y="155" text-anchor="middle" font-size="18" fill="#e65100">×</text>
  <text x="228" y="120" text-anchor="middle" font-size="11" fill="#e65100">wx</text>
  <!-- add node -->
  <circle cx="388" cy="150" r="27" fill="#fff3e0" stroke="#f57c00" stroke-width="2"/>
  <text x="388" y="155" text-anchor="middle" font-size="18" fill="#e65100">+</text>
  <text x="388" y="120" text-anchor="middle" font-size="11" fill="#e65100">z=wx+b</text>
  <!-- sigma node -->
  <circle cx="528" cy="150" r="27" fill="#e8eaf6" stroke="#3f51b5" stroke-width="2"/>
  <text x="528" y="155" text-anchor="middle" font-size="15" fill="#283593">σ(z)</text>
  <text x="528" y="120" text-anchor="middle" font-size="11" fill="#283593">a=σ(z)</text>
  <!-- loss node -->
  <rect x="640" y="125" width="80" height="50" rx="10" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="680" y="150" text-anchor="middle" font-size="13" fill="#c62828" font-weight="bold">Loss L</text>
  <text x="680" y="165" text-anchor="middle" font-size="11" fill="#c62828">= −y log(a)</text>

  <!-- Gradient labels on backward pass -->
  <text x="600" y="215" text-anchor="middle" font-size="11" fill="#c62828">∂L/∂a</text>
  <text x="460" y="215" text-anchor="middle" font-size="11" fill="#c62828">∂L/∂z</text>
  <text x="305" y="215" text-anchor="middle" font-size="11" fill="#c62828">∂L/∂(wx)</text>
  <text x="70" y="240" font-size="11" fill="#c62828">∂L/∂x=w</text>
  <text x="70" y="258" font-size="11" fill="#c62828">∂L/∂w=x</text>

  <!-- Legend -->
  <line x1="420" y1="300" x2="460" y2="300" stroke="#1976d2" stroke-width="2"/>
  <text x="468" y="305" font-size="12" fill="#1976d2">順伝播 (Forward pass)</text>
  <line x1="420" y1="325" x2="460" y2="325" stroke="#c62828" stroke-width="2" stroke-dasharray="6,3"/>
  <text x="468" y="330" font-size="12" fill="#c62828">逆伝播 (Backward pass)</text>
</svg>
