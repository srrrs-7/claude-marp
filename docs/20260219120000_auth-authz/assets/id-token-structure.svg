<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;max-width:100%;display:block;margin:0 auto;letter-spacing:0">
  <rect width="800" height="400" fill="#f8f9fa" rx="8"/>
  <text x="400" y="28" text-anchor="middle" font-size="15" font-weight="bold" fill="#2c3e50" font-family="sans-serif">OIDC IDトークン — クレームと検証</text>

  <!-- Token visual -->
  <rect x="20" y="45" width="760" height="30" rx="5" fill="#2c3e50"/>
  <text x="400" y="65" text-anchor="middle" font-size="11" fill="#ecf0f1" font-family="monospace">eyJhbGci... . eyJzdWIiOiJ1c2VyMTIzIiwiaXNzIjoiaHR0cHM6Ly9pZHAuZXhhbXBsZS5jb20iLC4uLn0 . [署名]</text>

  <!-- Claims table -->
  <rect x="20" y="90" width="760" height="200" rx="8" fill="white" style="filter:drop-shadow(1px 1px 3px rgba(0,0,0,0.1))"/>

  <!-- Header row -->
  <rect x="20" y="90" width="760" height="32" rx="8" fill="#3498db"/>
  <text x="130" y="111" text-anchor="middle" font-size="11" font-weight="bold" fill="white" font-family="sans-serif">クレーム</text>
  <text x="310" y="111" text-anchor="middle" font-size="11" font-weight="bold" fill="white" font-family="sans-serif">例</text>
  <text x="560" y="111" text-anchor="middle" font-size="11" font-weight="bold" fill="white" font-family="sans-serif">説明・検証要否</text>

  <!-- Divider lines -->
  <line x1="220" y1="90" x2="220" y2="290" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="420" y1="90" x2="420" y2="290" stroke="#bdc3c7" stroke-width="1"/>

  <!-- Row 1: iss -->
  <rect x="20" y="122" width="760" height="28" fill="#eaf4fb"/>
  <text x="130" y="140" text-anchor="middle" font-size="11" font-weight="bold" fill="#e74c3c" font-family="monospace">iss (必須)</text>
  <text x="310" y="140" text-anchor="middle" font-size="10" fill="#2c3e50" font-family="monospace">https://cognito-idp.ap-northeast-1...</text>
  <text x="560" y="140" text-anchor="middle" font-size="10" fill="#27ae60" font-family="sans-serif">発行者 — 自分のIdPと一致するか検証 ✅</text>

  <!-- Row 2: sub -->
  <text x="130" y="167" text-anchor="middle" font-size="11" font-weight="bold" fill="#e74c3c" font-family="monospace">sub (必須)</text>
  <text x="310" y="167" text-anchor="middle" font-size="10" fill="#2c3e50" font-family="monospace">a1b2c3d4-e5f6-7890...</text>
  <text x="560" y="167" text-anchor="middle" font-size="10" fill="#27ae60" font-family="sans-serif">主体の一意ID — 変わらない値として使用 ✅</text>
  <line x1="20" y1="152" x2="780" y2="152" stroke="#ecf0f1" stroke-width="1"/>

  <!-- Row 3: aud -->
  <rect x="20" y="176" width="760" height="28" fill="#eaf4fb"/>
  <text x="130" y="194" text-anchor="middle" font-size="11" font-weight="bold" fill="#e74c3c" font-family="monospace">aud (必須)</text>
  <text x="310" y="194" text-anchor="middle" font-size="10" fill="#2c3e50" font-family="monospace">my-client-id</text>
  <text x="560" y="194" text-anchor="middle" font-size="10" fill="#27ae60" font-family="sans-serif">対象クライアント — 自分のclient_idか検証 ✅</text>

  <!-- Row 4: exp -->
  <line x1="20" y1="206" x2="780" y2="206" stroke="#ecf0f1" stroke-width="1"/>
  <text x="130" y="220" text-anchor="middle" font-size="11" font-weight="bold" fill="#e74c3c" font-family="monospace">exp (必須)</text>
  <text x="310" y="220" text-anchor="middle" font-size="10" fill="#2c3e50" font-family="monospace">1740000000 (unix timestamp)</text>
  <text x="560" y="220" text-anchor="middle" font-size="10" fill="#27ae60" font-family="sans-serif">有効期限 — 現在時刻と比較 ✅</text>

  <!-- Row 5: email -->
  <rect x="20" y="228" width="760" height="28" fill="#eaf4fb"/>
  <text x="130" y="246" text-anchor="middle" font-size="11" fill="#7f8c8d" font-family="monospace">email (任意)</text>
  <text x="310" y="246" text-anchor="middle" font-size="10" fill="#2c3e50" font-family="monospace">user@example.com</text>
  <text x="560" y="246" text-anchor="middle" font-size="10" fill="#7f8c8d" font-family="sans-serif">メールアドレス (scopeで要求)</text>

  <!-- Row 6: custom -->
  <text x="130" y="273" text-anchor="middle" font-size="11" fill="#7f8c8d" font-family="monospace">custom:role</text>
  <text x="310" y="273" text-anchor="middle" font-size="10" fill="#2c3e50" font-family="monospace">admin</text>
  <text x="560" y="273" text-anchor="middle" font-size="10" fill="#7f8c8d" font-family="sans-serif">カスタムクレーム (Cognitoで追加可)</text>

  <!-- Verification steps -->
  <rect x="20" y="305" width="760" height="78" rx="8" fill="#2c3e50"/>
  <text x="400" y="323" text-anchor="middle" font-size="11" font-weight="bold" fill="#f1c40f" font-family="sans-serif">IDトークン検証の必須ステップ</text>

  <!-- Step boxes -->
  <rect x="30" y="332" width="165" height="40" rx="4" fill="#e74c3c"/>
  <text x="112" y="347" text-anchor="middle" font-size="10" font-weight="bold" fill="white" font-family="sans-serif">① 署名検証</text>
  <text x="112" y="362" text-anchor="middle" font-size="9" fill="#fdecea" font-family="sans-serif">JWKS公開鍵 + RS256</text>

  <polygon points="200,352 195,347 195,357" fill="#f1c40f"/>
  <line x1="197" y1="352" x2="218" y2="352" stroke="#f1c40f" stroke-width="1.5"/>

  <rect x="220" y="332" width="165" height="40" rx="4" fill="#e67e22"/>
  <text x="302" y="347" text-anchor="middle" font-size="10" font-weight="bold" fill="white" font-family="sans-serif">② iss 検証</text>
  <text x="302" y="362" text-anchor="middle" font-size="9" fill="#fef5e7" font-family="sans-serif">信頼するIdPか確認</text>

  <polygon points="390,352 385,347 385,357" fill="#f1c40f"/>
  <line x1="387" y1="352" x2="408" y2="352" stroke="#f1c40f" stroke-width="1.5"/>

  <rect x="410" y="332" width="165" height="40" rx="4" fill="#27ae60"/>
  <text x="492" y="347" text-anchor="middle" font-size="10" font-weight="bold" fill="white" font-family="sans-serif">③ aud 検証</text>
  <text x="492" y="362" text-anchor="middle" font-size="9" fill="#d5f5e3" font-family="sans-serif">自分向けトークンか確認</text>

  <polygon points="580,352 575,347 575,357" fill="#f1c40f"/>
  <line x1="577" y1="352" x2="598" y2="352" stroke="#f1c40f" stroke-width="1.5"/>

  <rect x="600" y="332" width="165" height="40" rx="4" fill="#3498db"/>
  <text x="682" y="347" text-anchor="middle" font-size="10" font-weight="bold" fill="white" font-family="sans-serif">④ exp 検証</text>
  <text x="682" y="362" text-anchor="middle" font-size="9" fill="#d6eaf8" font-family="sans-serif">有効期限内か確認</text>
</svg>
