<svg viewBox="0 0 800 420" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;max-width:100%;display:block;margin:0 auto;letter-spacing:0">
  <rect width="800" height="420" fill="#f8f9fa" rx="8"/>
  <text x="400" y="28" text-anchor="middle" font-size="15" font-weight="bold" fill="#2c3e50" font-family="sans-serif">JWT 構造 (JSON Web Token)</text>

  <!-- Encoded token -->
  <rect x="20" y="45" width="760" height="40" rx="6" fill="#2c3e50"/>
  <text x="30" y="60" font-size="10" fill="#e74c3c" font-family="monospace">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImtleS0xIn0</text>
  <text x="340" y="60" font-size="10" fill="#9b59b6" font-family="monospace">.</text>
  <text x="352" y="60" font-size="10" fill="#27ae60" font-family="monospace">eyJzdWIiOiJ1c2VyMTIzIiwiZW1haWwiOiJ1c2VyQGV4LmNvbSJ9</text>
  <text x="630" y="60" font-size="10" fill="#9b59b6" font-family="monospace">.</text>
  <text x="643" y="60" font-size="10" fill="#3498db" font-family="monospace">SflKxwRJSMeKK...</text>
  <text x="30" y="77" font-size="9" fill="#bdc3c7" font-family="sans-serif">← Base64URL エンコード: Header.Payload.Signature（ピリオド区切り）</text>

  <!-- Three sections -->
  <!-- Header -->
  <rect x="20" y="100" width="235" height="180" rx="8" fill="#fde8e8" style="filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.1))"/>
  <rect x="20" y="100" width="235" height="36" rx="8" fill="#e74c3c"/>
  <text x="137" y="123" text-anchor="middle" font-size="13" font-weight="bold" fill="white" font-family="sans-serif">Header</text>
  <text x="30" y="155" font-size="11" fill="#c0392b" font-family="monospace">{</text>
  <text x="40" y="172" font-size="11" fill="#2c3e50" font-family="monospace">  "alg": "RS256",</text>
  <text x="40" y="189" font-size="11" fill="#2c3e50" font-family="monospace">  "typ": "JWT",</text>
  <text x="40" y="206" font-size="11" fill="#2c3e50" font-family="monospace">  "kid": "key-id-1"</text>
  <text x="30" y="223" font-size="11" fill="#c0392b" font-family="monospace">}</text>
  <text x="30" y="252" font-size="9" fill="#7f8c8d" font-family="sans-serif">署名アルゴリズム + 鍵ID</text>
  <text x="30" y="265" font-size="9" fill="#7f8c8d" font-family="sans-serif">kid でキーローテーション対応</text>

  <!-- Payload -->
  <rect x="283" y="100" width="234" height="210" rx="8" fill="#e8f8e8" style="filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.1))"/>
  <rect x="283" y="100" width="234" height="36" rx="8" fill="#27ae60"/>
  <text x="400" y="123" text-anchor="middle" font-size="13" font-weight="bold" fill="white" font-family="sans-serif">Payload (Claims)</text>
  <text x="293" y="155" font-size="11" fill="#1a7a3c" font-family="monospace">{</text>
  <text x="303" y="172" font-size="10" fill="#2c3e50" font-family="monospace">  "iss": "https://idp.co",</text>
  <text x="303" y="189" font-size="10" fill="#2c3e50" font-family="monospace">  "sub": "user-123",</text>
  <text x="303" y="206" font-size="10" fill="#2c3e50" font-family="monospace">  "aud": "my-app",</text>
  <text x="303" y="223" font-size="10" fill="#2c3e50" font-family="monospace">  "exp": 1740000000,</text>
  <text x="303" y="240" font-size="10" fill="#2c3e50" font-family="monospace">  "iat": 1739996400,</text>
  <text x="303" y="257" font-size="10" fill="#2c3e50" font-family="monospace">  "email": "u@ex.com"</text>
  <text x="293" y="274" font-size="11" fill="#1a7a3c" font-family="monospace">}</text>
  <text x="293" y="298" font-size="9" fill="#e74c3c" font-family="sans-serif">⚠ 平文！機密情報は入れない</text>

  <!-- Signature -->
  <rect x="545" y="100" width="235" height="180" rx="8" fill="#e8f0fe" style="filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.1))"/>
  <rect x="545" y="100" width="235" height="36" rx="8" fill="#3498db"/>
  <text x="662" y="123" text-anchor="middle" font-size="13" font-weight="bold" fill="white" font-family="sans-serif">Signature</text>
  <text x="555" y="155" font-size="10" fill="#1a5276" font-family="monospace">RSASHA256(</text>
  <text x="565" y="170" font-size="10" fill="#1a5276" font-family="monospace">  base64url(header)</text>
  <text x="565" y="185" font-size="10" fill="#1a5276" font-family="monospace">  + "."</text>
  <text x="565" y="200" font-size="10" fill="#1a5276" font-family="monospace">  + base64url(payload),</text>
  <text x="565" y="215" font-size="10" fill="#e74c3c" font-family="monospace">  privateKey</text>
  <text x="555" y="230" font-size="10" fill="#1a5276" font-family="monospace">)</text>
  <text x="555" y="258" font-size="9" fill="#7f8c8d" font-family="sans-serif">秘密鍵で署名 → 公開鍵で検証</text>
  <text x="555" y="271" font-size="9" fill="#7f8c8d" font-family="sans-serif">改ざんを検知できる</text>

  <!-- Verification flow -->
  <rect x="20" y="325" width="760" height="75" rx="6" fill="#2c3e50"/>
  <text x="400" y="344" text-anchor="middle" font-size="11" font-weight="bold" fill="#f1c40f" font-family="sans-serif">検証フロー</text>
  <text x="80" y="365" text-anchor="middle" font-size="10" fill="white" font-family="sans-serif">① JWKS 取得</text>
  <polygon points="145,365 135,360 135,370" fill="#f1c40f"/>
  <line x1="120" y1="365" x2="143" y2="365" stroke="#f1c40f" stroke-width="1.5"/>
  <text x="210" y="365" text-anchor="middle" font-size="10" fill="white" font-family="sans-serif">② kid で鍵特定</text>
  <polygon points="285,365 275,360 275,370" fill="#f1c40f"/>
  <line x1="260" y1="365" x2="283" y2="365" stroke="#f1c40f" stroke-width="1.5"/>
  <text x="360" y="365" text-anchor="middle" font-size="10" fill="white" font-family="sans-serif">③ 署名検証 (RS256)</text>
  <polygon points="440,365 430,360 430,370" fill="#f1c40f"/>
  <line x1="415" y1="365" x2="438" y2="365" stroke="#f1c40f" stroke-width="1.5"/>
  <text x="530" y="365" text-anchor="middle" font-size="10" fill="white" font-family="sans-serif">④ iss / aud / exp 確認</text>
  <polygon points="620,365 610,360 610,370" fill="#f1c40f"/>
  <line x1="595" y1="365" x2="618" y2="365" stroke="#f1c40f" stroke-width="1.5"/>
  <text x="700" y="365" text-anchor="middle" font-size="10" fill="#2ecc71" font-family="sans-serif">✅ 認証成功</text>
  <text x="400" y="387" text-anchor="middle" font-size="9" fill="#95a5a6" font-family="sans-serif">JWKSはキャッシュ推奨 (TTL: 5〜10分) / kidが変わったら再取得</text>
</svg>
