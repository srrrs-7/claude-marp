<svg viewBox="0 0 960 500" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;width:auto;display:block;margin:0 auto;letter-spacing:0;font-family:'Helvetica Neue',Arial,sans-serif">
  <rect width="960" height="500" fill="#f8fafc" rx="12"/>
  <text x="480" y="34" text-anchor="middle" font-size="18" font-weight="bold" fill="#1e293b">EKS ネットワークセキュリティアーキテクチャ</text>

  <!-- VPC boundary -->
  <rect x="20" y="55" width="920" height="430" rx="12" fill="none" stroke="#64748b" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="50" y="76" font-size="12" font-weight="bold" fill="#64748b">VPC (10.0.0.0/16)</text>

  <!-- Internet / User -->
  <rect x="40" y="90" width="100" height="60" rx="8" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
  <text x="90" y="118" text-anchor="middle" font-size="12" fill="#334155">Internet</text>
  <text x="90" y="136" text-anchor="middle" font-size="11" fill="#475569">User / Client</text>

  <!-- WAF + ALB -->
  <line x1="140" y1="120" x2="175" y2="120" stroke="#64748b" stroke-width="2"/>
  <polygon points="179,120 171,115 171,125" fill="#64748b"/>
  <rect x="178" y="90" width="120" height="60" rx="8" fill="#fee2e2" stroke="#dc2626" stroke-width="2"/>
  <text x="238" y="114" text-anchor="middle" font-size="11" font-weight="bold" fill="#991b1b">WAF + ALB</text>
  <text x="238" y="130" text-anchor="middle" font-size="10" fill="#991b1b">L7フィルタリング</text>
  <text x="238" y="146" text-anchor="middle" font-size="10" fill="#991b1b">TLS終端</text>

  <!-- Ingress Controller -->
  <line x1="298" y1="120" x2="333" y2="120" stroke="#64748b" stroke-width="2"/>
  <polygon points="337,120 329,115 329,125" fill="#64748b"/>
  <rect x="336" y="90" width="140" height="60" rx="8" fill="#ede9fe" stroke="#7c3aed" stroke-width="2"/>
  <text x="406" y="114" text-anchor="middle" font-size="11" font-weight="bold" fill="#5b21b6">Ingress Controller</text>
  <text x="406" y="130" text-anchor="middle" font-size="10" fill="#5b21b6">ALB Controller</text>
  <text x="406" y="146" text-anchor="middle" font-size="10" fill="#5b21b6">（Public Subnet）</text>

  <!-- Namespace: frontend -->
  <rect x="520" y="70" width="200" height="160" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="620" y="92" text-anchor="middle" font-size="12" font-weight="bold" fill="#1e40af">NS: frontend</text>

  <rect x="540" y="104" width="160" height="54" rx="8" fill="white" stroke="#3b82f6" stroke-width="1.5"/>
  <text x="620" y="127" text-anchor="middle" font-size="12" fill="#1e40af">frontend Pod</text>
  <text x="620" y="145" text-anchor="middle" font-size="10" fill="#64748b">App: web</text>

  <line x1="476" y1="120" x2="540" y2="130" stroke="#64748b" stroke-width="2"/>
  <polygon points="543,131 534,126 536,136" fill="#64748b"/>

  <!-- Network Policy: frontend → backend -->
  <rect x="540" y="168" width="160" height="52" rx="8" fill="#fef3c7" stroke="#d97706" stroke-width="1.5"/>
  <text x="620" y="190" text-anchor="middle" font-size="11" font-weight="bold" fill="#92400e">NetworkPolicy</text>
  <text x="620" y="206" text-anchor="middle" font-size="10" fill="#92400e">Egress: backend:8080</text>

  <!-- Namespace: backend -->
  <rect x="740" y="70" width="180" height="160" rx="10" fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
  <text x="830" y="92" text-anchor="middle" font-size="12" font-weight="bold" fill="#166534">NS: backend</text>

  <rect x="756" y="104" width="148" height="54" rx="8" fill="white" stroke="#16a34a" stroke-width="1.5"/>
  <text x="830" y="127" text-anchor="middle" font-size="12" fill="#166534">backend Pod</text>
  <text x="830" y="145" text-anchor="middle" font-size="10" fill="#64748b">App: api</text>

  <line x1="700" y1="130" x2="756" y2="127" stroke="#16a34a" stroke-width="2"/>
  <polygon points="759,127 750,122 751,132" fill="#16a34a"/>

  <rect x="756" y="168" width="148" height="52" rx="8" fill="#fef3c7" stroke="#d97706" stroke-width="1.5"/>
  <text x="830" y="190" text-anchor="middle" font-size="11" font-weight="bold" fill="#92400e">NetworkPolicy</text>
  <text x="830" y="206" text-anchor="middle" font-size="10" fill="#92400e">Ingress: frontend のみ</text>

  <!-- Security Groups for Pods label -->
  <rect x="40" y="270" width="420" height="100" rx="10" fill="#f1f5f9" stroke="#64748b" stroke-width="1.5"/>
  <text x="250" y="293" text-anchor="middle" font-size="13" font-weight="bold" fill="#1e293b">Security Groups for Pods (SGP)</text>
  <text x="60" y="316" font-size="11" fill="#334155">• Pod毎に専用のSecurity Groupを付与</text>
  <text x="60" y="334" font-size="11" fill="#334155">• EC2ノードのSGとは独立（VPCレベルで制御）</text>
  <text x="60" y="352" font-size="11" fill="#334155">• RDS・ElastiCacheへの直接SGアクセス制御が可能</text>

  <!-- Private Endpoint -->
  <rect x="520" y="270" width="400" height="100" rx="10" fill="#f1f5f9" stroke="#64748b" stroke-width="1.5"/>
  <text x="720" y="293" text-anchor="middle" font-size="13" font-weight="bold" fill="#1e293b">プライベートエンドポイント設定</text>
  <text x="540" y="316" font-size="11" fill="#334155">• EKS API Serverをプライベートのみにする（推奨）</text>
  <text x="540" y="334" font-size="11" fill="#334155">• publicAccess: false / privateAccess: true</text>
  <text x="540" y="352" font-size="11" fill="#334155">• Bastion/VPN経由でのkubectl接続</text>

  <!-- Bottom: comparison -->
  <rect x="40" y="388" width="880" height="82" rx="8" fill="#1e293b"/>
  <text x="480" y="410" text-anchor="middle" font-size="13" font-weight="bold" fill="#FF9900">Network Policy vs SGP — 使い分け</text>
  <text x="60" y="432" font-size="11" fill="#e2e8f0">Network Policy: Kubernetes L4制御（Namespace/Pod間通信）→ Calico/VPC CNI必要</text>
  <text x="60" y="450" font-size="11" fill="#e2e8f0">SGP: VPCレベルのL4制御（RDS・外部リソースへの接続制御）→ ENI Trunk必要</text>
  <text x="60" y="467" font-size="11" fill="#94a3b8">試験TIP: 「RDSへの直接アクセス制御」→ SGP。「Namespace間通信制御」→ Network Policy</text>
</svg>
