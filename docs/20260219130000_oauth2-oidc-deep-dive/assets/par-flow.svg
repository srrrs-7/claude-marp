<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg" style="max-height:70vh;max-width:100%;display:block;margin:0 auto;letter-spacing:0">
  <rect width="800" height="400" fill="#f8f9fa" rx="8"/>
  <text x="400" y="24" text-anchor="middle" font-size="13" font-weight="bold" fill="#2c3e50" font-family="sans-serif">PAR â€” Pushed Authorization Requests (RFC 9126)</text>

  <!-- Actors -->
  <rect x="15" y="36" width="130" height="52" rx="8" fill="#3498db" style="filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.15))"/>
  <text x="80" y="59" text-anchor="middle" font-size="11" font-weight="bold" fill="white" font-family="sans-serif">Client</text>
  <text x="80" y="75" text-anchor="middle" font-size="9" fill="#d6eaf8" font-family="sans-serif">Backend / Mobile</text>

  <rect x="300" y="36" width="200" height="52" rx="8" fill="#e67e22" style="filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.15))"/>
  <text x="400" y="59" text-anchor="middle" font-size="11" font-weight="bold" fill="white" font-family="sans-serif">Authorization Server</text>
  <text x="400" y="75" text-anchor="middle" font-size="9" fill="#fdebd0" font-family="sans-serif">/par, /authorize, /token</text>

  <rect x="640" y="36" width="145" height="52" rx="8" fill="#3498db" style="filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.15))"/>
  <text x="713" y="55" text-anchor="middle" font-size="11" font-weight="bold" fill="white" font-family="sans-serif">User</text>
  <text x="713" y="70" text-anchor="middle" font-size="9" fill="#d6eaf8" font-family="sans-serif">Browser / App</text>

  <!-- Lifelines -->
  <line x1="80" y1="88" x2="80" y2="348" stroke="#3498db" stroke-width="1" stroke-dasharray="4,3"/>
  <line x1="400" y1="88" x2="400" y2="348" stroke="#e67e22" stroke-width="1" stroke-dasharray="4,3"/>
  <line x1="713" y1="88" x2="713" y2="348" stroke="#3498db" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- Step 1: PAR Request (server-to-server) -->
  <rect x="0" y="102" width="14" height="14" rx="7" fill="#9b59b6"/>
  <text x="7" y="113" text-anchor="middle" font-size="8" fill="white" font-family="sans-serif">1</text>
  <line x1="80" y1="109" x2="398" y2="109" stroke="#9b59b6" stroke-width="2"/>
  <polygon points="398,109 388,104 388,114" fill="#9b59b6"/>
  <text x="240" y="103" text-anchor="middle" font-size="9" font-weight="bold" fill="#9b59b6" font-family="sans-serif">POST /pushed_authorization_requests  (Direct TLS)</text>
  <text x="240" y="123" text-anchor="middle" font-size="8" fill="#7f8c8d" font-family="sans-serif">client_id + client_auth + response_type + redirect_uri + scope + state + code_challenge + authorization_details</text>

  <!-- PAR Request advantage note -->
  <rect x="22" y="136" width="180" height="30" rx="5" fill="#e8d5f5"/>
  <text x="112" y="150" text-anchor="middle" font-size="8" font-weight="bold" fill="#6c3483" font-family="sans-serif">å…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒ TLS ã§ä¿è­·</text>
  <text x="112" y="162" text-anchor="middle" font-size="8" fill="#6c3483" font-family="sans-serif">ãƒ–ãƒ©ã‚¦ã‚¶ URL ã«éœ²å‡ºã—ãªã„</text>

  <!-- Step 2: PAR Response -->
  <rect x="786" y="172" width="14" height="14" rx="7" fill="#e67e22"/>
  <text x="793" y="183" text-anchor="middle" font-size="8" fill="white" font-family="sans-serif">2</text>
  <line x1="398" y1="179" x2="82" y2="179" stroke="#e67e22" stroke-width="1.5"/>
  <polygon points="82,179 92,174 92,184" fill="#e67e22"/>
  <text x="240" y="173" text-anchor="middle" font-size="9" fill="#d35400" font-family="sans-serif">201 Created</text>
  <text x="240" y="193" text-anchor="middle" font-size="8" fill="#7f8c8d" font-family="sans-serif">{"request_uri": "urn:ietf:params:oauth:request_uri:6esc...", "expires_in": 90}</text>

  <!-- Step 3: Short Authorization Request -->
  <rect x="0" y="214" width="14" height="14" rx="7" fill="#3498db"/>
  <text x="7" y="225" text-anchor="middle" font-size="8" fill="white" font-family="sans-serif">3</text>
  <line x1="80" y1="221" x2="711" y2="221" stroke="#3498db" stroke-width="1.5"/>
  <polygon points="711,221 701,216 701,226" fill="#3498db"/>
  <text x="390" y="215" text-anchor="middle" font-size="9" fill="#2980b9" font-family="sans-serif">Browser redirect: GET /authorize</text>
  <text x="390" y="234" text-anchor="middle" font-size="8" fill="#7f8c8d" font-family="sans-serif">?client_id=xxx&amp;request_uri=urn:ietf:params:oauth:request_uri:6esc...  â† çŸ­ã„ URL ã®ã¿</text>

  <!-- Step 4: AS looks up request params -->
  <rect x="305" y="248" width="190" height="22" rx="5" fill="#fdebd0"/>
  <text x="400" y="263" text-anchor="middle" font-size="9" fill="#d35400" font-family="sans-serif">AS ãŒ request_uri ã‹ã‚‰å…ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¾©å…ƒ</text>

  <!-- Step 5: Normal auth flow -->
  <rect x="786" y="278" width="14" height="14" rx="7" fill="#27ae60"/>
  <text x="793" y="289" text-anchor="middle" font-size="8" fill="white" font-family="sans-serif">4</text>
  <line x1="711" y1="285" x2="402" y2="285" stroke="#27ae60" stroke-width="1.5"/>
  <polygon points="402,285 412,280 412,290" fill="#27ae60"/>
  <text x="557" y="279" text-anchor="middle" font-size="9" fill="#27ae60" font-family="sans-serif">ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ &amp; åŒæ„ â†’ Authorization Code</text>

  <!-- Step 6: Token exchange (normal) -->
  <line x1="80" y1="304" x2="398" y2="304" stroke="#555" stroke-width="1.5"/>
  <polygon points="398,304 388,299 388,309" fill="#555"/>
  <text x="240" y="298" text-anchor="middle" font-size="9" fill="#555" font-family="sans-serif">POST /token (é€šå¸¸ã® Code Exchange)</text>

  <!-- Footer -->
  <rect x="12" y="326" width="776" height="64" rx="8" fill="#2c3e50"/>
  <text x="400" y="344" text-anchor="middle" font-size="10" font-weight="bold" fill="#f1c40f" font-family="sans-serif">PAR ã®ãƒ¡ãƒªãƒƒãƒˆ</text>
  <text x="22" y="362" font-size="9" fill="#ecf0f1" font-family="sans-serif">ğŸ”’ å…¨èªè¨¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒ TLS ã§ä¿è­·ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ URLãƒ»Refererãƒ»History ã«æ®‹ã‚‰ãªã„ï¼‰</text>
  <text x="22" y="378" font-size="9" fill="#ecf0f1" font-family="sans-serif">ğŸ“Œ FAPI 2.0 / é«˜ä¾¡å€¤ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆé‡‘è APIï¼‰ã§å¿…é ˆã€‚RARï¼ˆRich Authï¼‰ã¨çµ„ã¿åˆã‚ã›å¯</text>
  <text x="22" y="394" font-size="9" fill="#aed6f1" font-family="sans-serif">request_uri ã®æœ‰åŠ¹æœŸé–“: é€šå¸¸ 90ç§’ã€‚ä½¿ã„æ¨ã¦ï¼ˆ1å›ã®ã¿ä½¿ç”¨å¯ï¼‰</text>
</svg>
