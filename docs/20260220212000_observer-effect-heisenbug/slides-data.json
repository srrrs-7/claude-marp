{
	"slides": [
		{
			"title": "観察者効果とHeisenbug\n— プロファイラを起動した途端に消えるバグ",
			"content": [
				"量子力学の「観察者効果」がソフトウェアデバッグにも現れる",
				"Heisenbug：デバッグツールで観察すると消えるバグ",
				"なぜ測定行為が測定対象を変えるのか"
			],
			"layout": "center"
		},
		{
			"title": "アジェンダ",
			"content": [
				"1. Heisenbugsとは何か",
				"2. 量子力学の観察者効果との類比",
				"3. Heisenbugsが発生するメカニズム",
				"4. 不確定性原理とデバッグの限界",
				"5. 実践的な対策"
			]
		},
		{
			"title": "Heisenbugsとは",
			"content": [],
			"layout": "section"
		},
		{
			"title": "観察すると消えるバグ",
			"content": [
				"**Heisenbug（ハイゼンバグ）の定義：**",
				"デバッガやプロファイラで調査しようとすると再現しなくなるバグ",
				"名前の由来：Werner Heisenbergの不確定性原理",
				"---",
				"**典型的なシナリオ：**",
				"本番環境でクラッシュ → デバッグビルドで再現しない",
				"プロファイラ起動中は正常動作 → 停止すると再発",
				"printfデバッグ追加 → バグが消える",
				"---",
				"**他の「バグ分類学」：**",
				"- **Bohrbug**：確実に再現する（Bohr原子モデルのように決定論的）",
				"- **Mandelbug**：原因が複雑で予測不可能",
				"- **Schrödingerbug**：コードレビューで存在が確定する"
			]
		},
		{
			"title": "量子力学との類比",
			"content": [
				"**ハイゼンベルクの不確定性原理（1927年）：**",
				"位置と運動量を同時に正確に測定することは不可能",
				"測定行為が粒子の状態を変化させる",
				"---",
				"**ソフトウェアの「観察者効果」：**",
				"デバッガ：プログラムの実行タイミングを変える",
				"プロファイラ：CPUキャッシュとメモリアクセスパターンを変える",
				"ロギング：I/Oレイテンシを追加しスレッドスケジューリングを変える",
				"---",
				"**共通の本質：**",
				"「観察ツールが観察対象と相互作用する」",
				"測定は常にシステムに介入している"
			]
		},
		{
			"title": "Heisenbugsのメカニズム",
			"content": [
				"**レースコンディション型：**",
				"スレッドA とスレッドB の実行順が問題",
				"デバッガのブレークポイント → スレッドが停止 → タイミングが変わる",
				"→ バグが発生しない条件に変化",
				"---",
				"**タイミング依存型：**",
				"リアルタイム処理でマイクロ秒オーダーの問題",
				"デバッグビルド（最適化なし）→ 実行速度が低下 → タイミングずれ解消",
				"---",
				"**メモリアライメント型：**",
				"デバッグモードでは変数の配置が変わる",
				"→ アライメント違反が偶然マスクされる",
				"---",
				"**キャッシュ効果型：**",
				"プロファイラがCPUキャッシュを汚染",
				"→ 本番とは異なるメモリアクセスパターンになる"
			]
		},
		{
			"title": "不確定性とデバッグの限界",
			"content": ["**![w:900 center](assets/uncertainty-principle.svg)**"]
		},
		{
			"title": "実践的な対策",
			"content": [
				"**1. 観察を最小限にする：**",
				"本番と同じ条件でのテスト（リリースビルド）",
				"非侵襲的なデバッグ：core dumpやクラッシュレポート分析",
				"---",
				"**2. ロギングの工夫：**",
				"リングバッファへの非同期ロギング（I/Oレイテンシを排除）",
				"クラッシュ後にダンプする「ブラックボックス」方式",
				"---",
				"**3. 静的解析と動的解析の活用：**",
				"ThreadSanitizer / AddressSanitizer（コンパイラ支援）",
				"確率的テスト（ランダムな遅延挿入でレースを再現）",
				"---",
				"**4. 設計で防ぐ：**",
				"イミュータブルなデータ構造でレースコンディションを排除",
				"「観察可能性（Observability）」をシステムに組み込む"
			]
		},
		{
			"title": "まとめ：測定は介入である",
			"content": [
				"✅ **Heisenbug：デバッグツールが問題のタイミング・状態を変化させる**",
				"✅ **量子力学の観察者効果と同じ本質：測定は常に介入**",
				"✅ **レースコンディション・タイミング・キャッシュ効果が主要原因**",
				"✅ **対策：非侵襲的観察・コンパイラ支援・設計で防ぐ**",
				"",
				"「バグを見ると消える。見ないと再現する。それが量子コンピュータの夢だ」"
			]
		}
	]
}
