---
marp: true
theme: gaia
class: invert
size: 16:9
paginate: true
header: "相関と因果"
footer: "© 2026"
style: |
  section pre code { font-size: 0.58em; line-height: 1.4; }
  
---

<!-- _class: lead -->
# 相関と因果の混同
— 「チョコレートを食べると賢くなる」は本当か

- 相関係数が高い ≠ 因果関係がある
- 科学論文・メディア・AIが犯しがちな根本的誤り
- 因果推論という新しい統計学の誕生


---

# アジェンダ

- 1. 相関と因果の違い
- 2. 疑似相関の実例
- 3. 交絡因子という罠
- 4. 因果推論の方法論
- 5. AIと機械学習への応用


---

<!-- _class: lead -->
# 相関と因果の違い


---

# チョコレート消費量とノーベル賞受賞者数

- **Franz Messerli（2012年 NEJM）：**
- 国別のチョコレート消費量とノーベル賞受賞者数の相関
- r = 0.791（非常に高い相関）
- →「チョコレートは認知機能を向上させる？」
- ---
- **実際の理由：交絡因子「豊かさ」**
- 豊かな国 → チョコレートも食べる + 研究投資も多い
- チョコレートとノーベル賞に直接の因果関係はない
- ---
- **アイスクリーム売上と溺死者数：**
- 夏に両方増える → 原因は「夏（気温）」という交絡因子
- ---
- 相関は「何かが関係しているかもしれない」というヒント
- 因果は「Aを変えるとBが変わる」という主張


---

<!-- _class: lead -->
# 疑似相関と交絡因子


---

# 疑似相関の代表例

- **Tyler Vigen（Spurious Correlations）の事例：**
- - ニコラス・ケイジの映画出演数 × プールでの溺死者数（r=0.67）
- - 米国のチーズ消費量 × シーツへの絡まり死亡者数（r=0.95）
- - オーガニック食品売上 × 自閉症診断数（r=0.99）
- ---
- **なぜ疑似相関が生まれるか：**
- 1. 共通の交絡因子（時間トレンド・経済成長など）
- 2. 大量のデータから偶然の相関を探す（多重比較問題）
- 3. 期待する結果を確認するバイアス
- ---
- **ポイント：**
- データが増えるほど偶然の高い相関を見つけやすくなる


---

# 因果推論の方法論

- **「Gold Standard」：ランダム化比較試験（RCT）**
- - 参加者をランダムに介入群と対照群に分ける
- - 薬の臨床試験・政策評価で標準的
- - ただし倫理上・コスト上できない場合が多い
- ---
- **観察データからの因果推論（Judea Pearl）：**
- - 操作変数法（IV）：外生的な変動を利用
- - 差分の差分法（DiD）：政策前後の比較
- - 回帰不連続デザイン（RD）：閾値を利用
- ---
- **Pearl の「因果推論の梯子」：**
- Level 1：相関（見る）
- Level 2：介入（する）
- Level 3：反事実（もしAをしなければ？）


---

# 機械学習と因果推論

- **ML の課題：相関に過学習する**
- 画像認識モデルが「空の色」でコケを分類した事例
- 医療AIが「医療機器の存在」を患者の重症度と誤学習
- ---
- **分布シフト問題：**
- 訓練データと本番データの相関構造が変わると失敗する
- 因果関係に基づくモデルはより頑健
- ---
- **因果ML（Causal ML）の台頭：**
- - DoWhy（Microsoft）
- - CausalML（Uber）
- - 「なぜ」を学習するAIへの転換


---

# まとめ：相関はヒント、因果は証明

- ✅ **相関係数が高くても因果関係があるとは言えない**
- ✅ **交絡因子を探すことが因果推論の第一歩**
- ✅ **RCT が最強だが、観察データでも因果推論は可能**
- ✅ **AIも相関に騙される — 因果を学ぶAIが次の課題**
- 
- 「相関は証拠。因果は論証。この違いが科学を科学たらしめる」

